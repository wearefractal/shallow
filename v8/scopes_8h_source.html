<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>V8 API Reference Guide: /home/codex/apps/v8/src/scopes.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.jpg"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">V8 API Reference Guide
   
   </div>
   <div id="projectbrief">If this is out of date tweet @Contra</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('scopes_8h.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/home/codex/apps/v8/src/scopes.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="scopes_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright 2012 the V8 project authors. All rights reserved.</span>
<a name="l00002"></a>00002 <span class="comment">// Redistribution and use in source and binary forms, with or without</span>
<a name="l00003"></a>00003 <span class="comment">// modification, are permitted provided that the following conditions are</span>
<a name="l00004"></a>00004 <span class="comment">// met:</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//     * Redistributions of source code must retain the above copyright</span>
<a name="l00007"></a>00007 <span class="comment">//       notice, this list of conditions and the following disclaimer.</span>
<a name="l00008"></a>00008 <span class="comment">//     * Redistributions in binary form must reproduce the above</span>
<a name="l00009"></a>00009 <span class="comment">//       copyright notice, this list of conditions and the following</span>
<a name="l00010"></a>00010 <span class="comment">//       disclaimer in the documentation and/or other materials provided</span>
<a name="l00011"></a>00011 <span class="comment">//       with the distribution.</span>
<a name="l00012"></a>00012 <span class="comment">//     * Neither the name of Google Inc. nor the names of its</span>
<a name="l00013"></a>00013 <span class="comment">//       contributors may be used to endorse or promote products derived</span>
<a name="l00014"></a>00014 <span class="comment">//       from this software without specific prior written permission.</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00017"></a>00017 <span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00018"></a>00018 <span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00019"></a>00019 <span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00020"></a>00020 <span class="comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00021"></a>00021 <span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00022"></a>00022 <span class="comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00023"></a>00023 <span class="comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00024"></a>00024 <span class="comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00025"></a>00025 <span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00026"></a>00026 <span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#ifndef V8_SCOPES_H_</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#define V8_SCOPES_H_</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="ast_8h.html">ast.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="zone_8h.html">zone.h</a>&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">namespace </span>v8 {
<a name="l00035"></a>00035 <span class="keyword">namespace </span>internal {
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="keyword">class </span>CompilationInfo;
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">// A hash map to support fast variable declaration and lookup.</span>
<a name="l00041"></a><a class="code" href="classv8_1_1internal_1_1_variable_map.html">00041</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_variable_map.html">VariableMap</a>: <span class="keyword">public</span> <a class="code" href="classv8_1_1internal_1_1_template_hash_map_impl.html">ZoneHashMap</a> {
<a name="l00042"></a>00042  <span class="keyword">public</span>:
<a name="l00043"></a>00043   <a class="code" href="classv8_1_1internal_1_1_variable_map.html#a87b96fee2ca382a17a5d671b90fa2c36">VariableMap</a>();
<a name="l00044"></a>00044 
<a name="l00045"></a>00045   <span class="keyword">virtual</span> <a class="code" href="classv8_1_1internal_1_1_variable_map.html#a630e6de83cdb05f840059500b858dbd0">~VariableMap</a>();
<a name="l00046"></a>00046 
<a name="l00047"></a>00047   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_variable_map.html#abcc2c528a34ba0e151440546019b76b7">Declare</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* scope,
<a name="l00048"></a>00048                     <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>,
<a name="l00049"></a>00049                     <a class="code" href="namespacev8_1_1internal.html#a7e6c17aa46835cb34aa75323fcc10c16">VariableMode</a> mode,
<a name="l00050"></a>00050                     <span class="keywordtype">bool</span> is_valid_lhs,
<a name="l00051"></a>00051                     <a class="code" href="classv8_1_1internal_1_1_variable.html#a8d63c9319e6a17201b7c3585b5c09a45">Variable::Kind</a> kind,
<a name="l00052"></a>00052                     <a class="code" href="namespacev8_1_1internal.html#a1ba3f1160422ac24a0ad8dc4ee300e9c">InitializationFlag</a> initialization_flag,
<a name="l00053"></a>00053                     <a class="code" href="classv8_1_1internal_1_1_interface.html">Interface</a>* interface = <a class="code" href="classv8_1_1internal_1_1_interface.html#a6f67d744b08d96c0b52d095f8444f689">Interface::NewValue</a>());
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_variable_map.html#a4612dcf68951be6562b30a7780d19c69">Lookup</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> name);
<a name="l00056"></a>00056 };
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">// The dynamic scope part holds hash maps for the variables that will</span>
<a name="l00060"></a>00060 <span class="comment">// be looked up dynamically from within eval and with scopes. The objects</span>
<a name="l00061"></a>00061 <span class="comment">// are allocated on-demand from Scope::NonLocal to avoid wasting memory</span>
<a name="l00062"></a>00062 <span class="comment">// and setup time for scopes that don&#39;t need them.</span>
<a name="l00063"></a><a class="code" href="classv8_1_1internal_1_1_dynamic_scope_part.html">00063</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_dynamic_scope_part.html">DynamicScopePart</a> : <span class="keyword">public</span> <a class="code" href="classv8_1_1internal_1_1_zone_object.html">ZoneObject</a> {
<a name="l00064"></a>00064  <span class="keyword">public</span>:
<a name="l00065"></a><a class="code" href="classv8_1_1internal_1_1_dynamic_scope_part.html#ac1b3bda0729b6d8e3443442557465b85">00065</a>   <a class="code" href="classv8_1_1internal_1_1_variable_map.html">VariableMap</a>* <a class="code" href="classv8_1_1internal_1_1_dynamic_scope_part.html#ac1b3bda0729b6d8e3443442557465b85">GetMap</a>(<a class="code" href="namespacev8_1_1internal.html#a7e6c17aa46835cb34aa75323fcc10c16">VariableMode</a> mode) {
<a name="l00066"></a>00066     <span class="keywordtype">int</span> index = mode - <a class="code" href="namespacev8_1_1internal.html#a7e6c17aa46835cb34aa75323fcc10c16a74e32ffa40a3ca6805d2122120022e9a">DYNAMIC</a>;
<a name="l00067"></a>00067     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(index &gt;= 0 &amp;&amp; index &lt; 3);
<a name="l00068"></a>00068     <span class="keywordflow">return</span> &amp;maps_[index];
<a name="l00069"></a>00069   }
<a name="l00070"></a>00070 
<a name="l00071"></a>00071  <span class="keyword">private</span>:
<a name="l00072"></a>00072   <a class="code" href="classv8_1_1internal_1_1_variable_map.html">VariableMap</a> maps_[3];
<a name="l00073"></a>00073 };
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="comment">// Global invariants after AST construction: Each reference (i.e. identifier)</span>
<a name="l00077"></a>00077 <span class="comment">// to a JavaScript variable (including global properties) is represented by a</span>
<a name="l00078"></a>00078 <span class="comment">// VariableProxy node. Immediately after AST construction and before variable</span>
<a name="l00079"></a>00079 <span class="comment">// allocation, most VariableProxy nodes are &quot;unresolved&quot;, i.e. not bound to a</span>
<a name="l00080"></a>00080 <span class="comment">// corresponding variable (though some are bound during parse time). Variable</span>
<a name="l00081"></a>00081 <span class="comment">// allocation binds each unresolved VariableProxy to one Variable and assigns</span>
<a name="l00082"></a>00082 <span class="comment">// a location. Note that many VariableProxy nodes may refer to the same Java-</span>
<a name="l00083"></a>00083 <span class="comment">// Script variable.</span>
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="classv8_1_1internal_1_1_scope.html">00085</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>: <span class="keyword">public</span> <a class="code" href="classv8_1_1internal_1_1_zone_object.html">ZoneObject</a> {
<a name="l00086"></a>00086  <span class="keyword">public</span>:
<a name="l00087"></a>00087   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00088"></a>00088   <span class="comment">// Construction</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <a class="code" href="classv8_1_1internal_1_1_scope.html#a3d53cfa8ad035f4f47df598e5ecf8f82">Scope</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a103ace9a050c875d3df6e9f1152765f8">outer_scope</a>, <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17">ScopeType</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#af1042286593e51ba13561c6ced41a6bc">type</a>);
<a name="l00091"></a>00091 
<a name="l00092"></a>00092   <span class="comment">// Compute top scope and allocate variables. For lazy compilation the top</span>
<a name="l00093"></a>00093   <span class="comment">// scope only contains the single lazily compiled function, so this</span>
<a name="l00094"></a>00094   <span class="comment">// doesn&#39;t re-allocate variables repeatedly.</span>
<a name="l00095"></a>00095   <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a293698598869f07a08c7177440dcb73a">Analyze</a>(CompilationInfo* info);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   <span class="keyword">static</span> <a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a4f8aaa97457b815332b370e33a8e5085">DeserializeScopeChain</a>(<a class="code" href="classv8_1_1internal_1_1_context.html">Context</a>* context, <a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* global_scope);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   <span class="comment">// The scope name is only used for printing/debugging.</span>
<a name="l00100"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aac8464e91174fb00271f3e56ea42f58f">00100</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aac8464e91174fb00271f3e56ea42f58f">SetScopeName</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> scope_name) { <a class="code" href="classv8_1_1internal_1_1_scope.html#ac3f901d131bb05f1e0f1e8b8a19c804c">scope_name_</a> = scope_name; }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a7ff6df027b40c8976b5097c513415ebb">Initialize</a>();
<a name="l00103"></a>00103 
<a name="l00104"></a>00104   <span class="comment">// Checks if the block scope is redundant, i.e. it does not contain any</span>
<a name="l00105"></a>00105   <span class="comment">// block scoped declarations. In that case it is removed from the scope</span>
<a name="l00106"></a>00106   <span class="comment">// tree and its children are reparented.</span>
<a name="l00107"></a>00107   <a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#ac1de3630860a2fb185db850dae9f152c">FinalizeBlockScope</a>();
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00110"></a>00110   <span class="comment">// Declarations</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <span class="comment">// Lookup a variable in this scope. Returns the variable or NULL if not found.</span>
<a name="l00113"></a>00113   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a5b25f35b26559499c7ee8b7df512fcb0">LocalLookup</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="comment">// This lookup corresponds to a lookup in the &quot;intermediate&quot; scope sitting</span>
<a name="l00116"></a>00116   <span class="comment">// between this scope and the outer scope. (ECMA-262, 3rd., requires that</span>
<a name="l00117"></a>00117   <span class="comment">// the name of named function literal is kept in an intermediate scope</span>
<a name="l00118"></a>00118   <span class="comment">// in between this scope and the next outer scope.)</span>
<a name="l00119"></a>00119   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#ac6e34d546c49574545f54964a1bc6e71">LookupFunctionVar</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>,
<a name="l00120"></a>00120                               AstNodeFactory&lt;AstNullVisitor&gt;* factory);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   <span class="comment">// Lookup a variable in this scope or outer scopes.</span>
<a name="l00123"></a>00123   <span class="comment">// Returns the variable or NULL if not found.</span>
<a name="l00124"></a>00124   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#ace216d9a69b84259139ca69f46a79ac2">Lookup</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126   <span class="comment">// Declare the function variable for a function literal. This variable</span>
<a name="l00127"></a>00127   <span class="comment">// is in an intermediate scope between this function scope and the the</span>
<a name="l00128"></a>00128   <span class="comment">// outer scope. Only possible for function scopes; at most one variable.</span>
<a name="l00129"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a2af668e427258bf92475073646356aa8">00129</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a2af668e427258bf92475073646356aa8">DeclareFunctionVar</a>(<a class="code" href="classv8_1_1internal_1_1_variable_declaration.html">VariableDeclaration</a>* declaration) {
<a name="l00130"></a>00130     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html#a57d46167bd0008a565f55d2affcc468c">is_function_scope</a>());
<a name="l00131"></a>00131     <a class="code" href="classv8_1_1internal_1_1_scope.html#ad0c0cf049bc723932413e3355a3fce20">function_</a> = declaration;
<a name="l00132"></a>00132   }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="comment">// Declare a parameter in this scope.  When there are duplicated</span>
<a name="l00135"></a>00135   <span class="comment">// parameters the rightmost one &#39;wins&#39;.  However, the implementation</span>
<a name="l00136"></a>00136   <span class="comment">// expects all parameters to be declared and from left to right.</span>
<a name="l00137"></a>00137   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a565ba31604a035409b7b3d820ac1a8d6">DeclareParameter</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>, <a class="code" href="namespacev8_1_1internal.html#a7e6c17aa46835cb34aa75323fcc10c16">VariableMode</a> mode);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <span class="comment">// Declare a local variable in this scope. If the variable has been</span>
<a name="l00140"></a>00140   <span class="comment">// declared before, the previously declared variable is returned.</span>
<a name="l00141"></a>00141   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aa5b86463c0d10dbd4d3eb18d1bbd916e">DeclareLocal</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>,
<a name="l00142"></a>00142                          <a class="code" href="namespacev8_1_1internal.html#a7e6c17aa46835cb34aa75323fcc10c16">VariableMode</a> mode,
<a name="l00143"></a>00143                          <a class="code" href="namespacev8_1_1internal.html#a1ba3f1160422ac24a0ad8dc4ee300e9c">InitializationFlag</a> init_flag,
<a name="l00144"></a>00144                          <a class="code" href="classv8_1_1internal_1_1_interface.html">Interface</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#adef2e4ac765cbeba75f9e8de7e39cabd">interface</a> = <a class="code" href="classv8_1_1internal_1_1_interface.html#a6f67d744b08d96c0b52d095f8444f689">Interface::NewValue</a>());
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="comment">// Declare an implicit global variable in this scope which must be a</span>
<a name="l00147"></a>00147   <span class="comment">// global scope.  The variable was introduced (possibly from an inner</span>
<a name="l00148"></a>00148   <span class="comment">// scope) by a reference to an unresolved variable with no intervening</span>
<a name="l00149"></a>00149   <span class="comment">// with statements or eval calls.</span>
<a name="l00150"></a>00150   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#ac6a9401ecbc78915310676aca8eee0b7">DeclareGlobal</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> name);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">// Create a new unresolved variable.</span>
<a name="l00153"></a>00153   <span class="keyword">template</span>&lt;<span class="keyword">class</span> Visitor&gt;
<a name="l00154"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a07e793d644c1991abb758104d4cd871f">00154</a>   <a class="code" href="classv8_1_1internal_1_1_variable_proxy.html">VariableProxy</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a07e793d644c1991abb758104d4cd871f">NewUnresolved</a>(AstNodeFactory&lt;Visitor&gt;* factory,
<a name="l00155"></a>00155                                <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> name,
<a name="l00156"></a>00156                                <span class="keywordtype">int</span> position = RelocInfo::kNoPosition,
<a name="l00157"></a>00157                                <a class="code" href="classv8_1_1internal_1_1_interface.html">Interface</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#adef2e4ac765cbeba75f9e8de7e39cabd">interface</a> = <a class="code" href="classv8_1_1internal_1_1_interface.html#a6f67d744b08d96c0b52d095f8444f689">Interface::NewValue</a>()) {
<a name="l00158"></a>00158     <span class="comment">// Note that we must not share the unresolved variables with</span>
<a name="l00159"></a>00159     <span class="comment">// the same name because they may be removed selectively via</span>
<a name="l00160"></a>00160     <span class="comment">// RemoveUnresolved().</span>
<a name="l00161"></a>00161     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(!<a class="code" href="classv8_1_1internal_1_1_scope.html#ada85f14d546573a3bc19cd9e178919f3">already_resolved</a>());
<a name="l00162"></a>00162     <a class="code" href="classv8_1_1internal_1_1_variable_proxy.html">VariableProxy</a>* proxy =
<a name="l00163"></a>00163         factory-&gt;NewVariableProxy(name, <span class="keyword">false</span>, position, <a class="code" href="classv8_1_1internal_1_1_scope.html#adef2e4ac765cbeba75f9e8de7e39cabd">interface</a>);
<a name="l00164"></a>00164     <a class="code" href="classv8_1_1internal_1_1_scope.html#a37b9e8c30724515e9f8ca3531e41fd4c">unresolved_</a>.<a class="code" href="classv8_1_1internal_1_1_list.html#a19e166e0f9afcc82a17f426eadf322e4">Add</a>(proxy);
<a name="l00165"></a>00165     <span class="keywordflow">return</span> proxy;
<a name="l00166"></a>00166   }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168   <span class="comment">// Remove a unresolved variable. During parsing, an unresolved variable</span>
<a name="l00169"></a>00169   <span class="comment">// may have been added optimistically, but then only the variable name</span>
<a name="l00170"></a>00170   <span class="comment">// was used (typically for labels). If the variable was not declared, the</span>
<a name="l00171"></a>00171   <span class="comment">// addition introduced a new unresolved variable which may end up being</span>
<a name="l00172"></a>00172   <span class="comment">// allocated globally as a &quot;ghost&quot; variable. RemoveUnresolved removes</span>
<a name="l00173"></a>00173   <span class="comment">// such a variable again if it was added; otherwise this is a no-op.</span>
<a name="l00174"></a>00174   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a98eb6641a660b9df358f00cf085dbef1">RemoveUnresolved</a>(<a class="code" href="classv8_1_1internal_1_1_variable_proxy.html">VariableProxy</a>* var);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176   <span class="comment">// Creates a new temporary variable in this scope.  The name is only used</span>
<a name="l00177"></a>00177   <span class="comment">// for printing and cannot be used to find the variable.  In particular,</span>
<a name="l00178"></a>00178   <span class="comment">// the only way to get hold of the temporary is by keeping the Variable*</span>
<a name="l00179"></a>00179   <span class="comment">// around.</span>
<a name="l00180"></a>00180   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aa9d5ba303e293cf9c817e43cbcf51c6b">NewTemporary</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> name);
<a name="l00181"></a>00181 
<a name="l00182"></a>00182   <span class="comment">// Adds the specific declaration node to the list of declarations in</span>
<a name="l00183"></a>00183   <span class="comment">// this scope. The declarations are processed as part of entering</span>
<a name="l00184"></a>00184   <span class="comment">// the scope; see codegen.cc:ProcessDeclarations.</span>
<a name="l00185"></a>00185   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ae8c84baddb09eb2f7947182489cabd45">AddDeclaration</a>(<a class="code" href="classv8_1_1internal_1_1_declaration.html">Declaration</a>* declaration);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00188"></a>00188   <span class="comment">// Illegal redeclaration support.</span>
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   <span class="comment">// Set an expression node that will be executed when the scope is</span>
<a name="l00191"></a>00191   <span class="comment">// entered. We only keep track of one illegal redeclaration node per</span>
<a name="l00192"></a>00192   <span class="comment">// scope - the first one - so if you try to set it multiple times</span>
<a name="l00193"></a>00193   <span class="comment">// the additional requests will be silently ignored.</span>
<a name="l00194"></a>00194   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6f42effaecb7928c9e1ab2a08ae5d870">SetIllegalRedeclaration</a>(<a class="code" href="classv8_1_1internal_1_1_expression.html">Expression</a>* expression);
<a name="l00195"></a>00195 
<a name="l00196"></a>00196   <span class="comment">// Visit the illegal redeclaration expression. Do not call if the</span>
<a name="l00197"></a>00197   <span class="comment">// scope doesn&#39;t have an illegal redeclaration node.</span>
<a name="l00198"></a>00198   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a82051f3f1b87476303e261003d1d0514">VisitIllegalRedeclaration</a>(AstVisitor* visitor);
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   <span class="comment">// Check if the scope has (at least) one illegal redeclaration.</span>
<a name="l00201"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a9e3beeb76d403dc4d7c78edf98f345b9">00201</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a9e3beeb76d403dc4d7c78edf98f345b9">HasIllegalRedeclaration</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aac2bb70747d573b68dc5c6ff554fc827">illegal_redecl_</a> != <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>; }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <span class="comment">// For harmony block scoping mode: Check if the scope has conflicting var</span>
<a name="l00204"></a>00204   <span class="comment">// declarations, i.e. a var declaration that has been hoisted from a nested</span>
<a name="l00205"></a>00205   <span class="comment">// scope over a let binding of the same name.</span>
<a name="l00206"></a>00206   <a class="code" href="classv8_1_1internal_1_1_declaration.html">Declaration</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aca4da0b20082a008449bde02757d6358">CheckConflictingVarDeclarations</a>();
<a name="l00207"></a>00207 
<a name="l00208"></a>00208   <span class="comment">// For harmony block scoping mode: Check if the scope has variable proxies</span>
<a name="l00209"></a>00209   <span class="comment">// that are used as lvalues and point to const variables. Assumes that scopes</span>
<a name="l00210"></a>00210   <span class="comment">// have been analyzed and variables been resolved.</span>
<a name="l00211"></a>00211   <a class="code" href="classv8_1_1internal_1_1_variable_proxy.html">VariableProxy</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a5af23be3402b94d077b489400ec007af">CheckAssignmentToConst</a>();
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00214"></a>00214   <span class="comment">// Scope-specific info.</span>
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <span class="comment">// Inform the scope that the corresponding code contains a with statement.</span>
<a name="l00217"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ad4f0987d18c1f95e0a3cfc886a99203b">00217</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ad4f0987d18c1f95e0a3cfc886a99203b">RecordWithStatement</a>() { <a class="code" href="classv8_1_1internal_1_1_scope.html#abcc42b038d3e9377891bbb0ea1ad3804">scope_contains_with_</a> = <span class="keyword">true</span>; }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="comment">// Inform the scope that the corresponding code contains an eval call.</span>
<a name="l00220"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#abb725bce049d5b79020961a7d01154d7">00220</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#abb725bce049d5b79020961a7d01154d7">RecordEvalCall</a>() { <span class="keywordflow">if</span> (!<a class="code" href="classv8_1_1internal_1_1_scope.html#adcc7c6b7b9023f874ad5cce4c4fc3f9e">is_global_scope</a>()) <a class="code" href="classv8_1_1internal_1_1_scope.html#a4541ec4968037e4663d09c3d877b9f8d">scope_calls_eval_</a> = <span class="keyword">true</span>; }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <span class="comment">// Set the strict mode flag (unless disabled by a global flag).</span>
<a name="l00223"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a078880d1ac4f07135782b33d237413c0">00223</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a078880d1ac4f07135782b33d237413c0">SetLanguageMode</a>(<a class="code" href="namespacev8_1_1internal.html#a1ba33e2c27dbf4a22f26a28f80096e75">LanguageMode</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5753f13fa341fcbaecaf18c54254ddd5">language_mode</a>) {
<a name="l00224"></a>00224     <a class="code" href="classv8_1_1internal_1_1_scope.html#a924ba8d563265ab5ff1103f9101a6130">language_mode_</a> = <a class="code" href="classv8_1_1internal_1_1_scope.html#a5753f13fa341fcbaecaf18c54254ddd5">language_mode</a>;
<a name="l00225"></a>00225   }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="comment">// Position in the source where this scope begins and ends.</span>
<a name="l00228"></a>00228   <span class="comment">//</span>
<a name="l00229"></a>00229   <span class="comment">// * For the scope of a with statement</span>
<a name="l00230"></a>00230   <span class="comment">//     with (obj) stmt</span>
<a name="l00231"></a>00231   <span class="comment">//   start position: start position of first token of &#39;stmt&#39;</span>
<a name="l00232"></a>00232   <span class="comment">//   end position: end position of last token of &#39;stmt&#39;</span>
<a name="l00233"></a>00233   <span class="comment">// * For the scope of a block</span>
<a name="l00234"></a>00234   <span class="comment">//     { stmts }</span>
<a name="l00235"></a>00235   <span class="comment">//   start position: start position of &#39;{&#39;</span>
<a name="l00236"></a>00236   <span class="comment">//   end position: end position of &#39;}&#39;</span>
<a name="l00237"></a>00237   <span class="comment">// * For the scope of a function literal or decalaration</span>
<a name="l00238"></a>00238   <span class="comment">//     function fun(a,b) { stmts }</span>
<a name="l00239"></a>00239   <span class="comment">//   start position: start position of &#39;(&#39;</span>
<a name="l00240"></a>00240   <span class="comment">//   end position: end position of &#39;}&#39;</span>
<a name="l00241"></a>00241   <span class="comment">// * For the scope of a catch block</span>
<a name="l00242"></a>00242   <span class="comment">//     try { stms } catch(e) { stmts }</span>
<a name="l00243"></a>00243   <span class="comment">//   start position: start position of &#39;(&#39;</span>
<a name="l00244"></a>00244   <span class="comment">//   end position: end position of &#39;)&#39;</span>
<a name="l00245"></a>00245   <span class="comment">// * For the scope of a for-statement</span>
<a name="l00246"></a>00246   <span class="comment">//     for (let x ...) stmt</span>
<a name="l00247"></a>00247   <span class="comment">//   start position: start position of &#39;(&#39;</span>
<a name="l00248"></a>00248   <span class="comment">//   end position: end position of last token of &#39;stmt&#39;</span>
<a name="l00249"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#af78d3db495c9278ab8539571eefc7a96">00249</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#af78d3db495c9278ab8539571eefc7a96">start_position</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a9ea8507e658edffc2568771ccc5393db">start_position_</a>; }
<a name="l00250"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ab8b18eaeaf400ee1798af3a45fb4cd50">00250</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ab8b18eaeaf400ee1798af3a45fb4cd50">set_start_position</a>(<span class="keywordtype">int</span> statement_pos) {
<a name="l00251"></a>00251     <a class="code" href="classv8_1_1internal_1_1_scope.html#a9ea8507e658edffc2568771ccc5393db">start_position_</a> = statement_pos;
<a name="l00252"></a>00252   }
<a name="l00253"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aad5f40c0ebef98d84cd51cb31cf6eb53">00253</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aad5f40c0ebef98d84cd51cb31cf6eb53">end_position</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6592aac772a057e97a3f10ac72e04062">end_position_</a>; }
<a name="l00254"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a11abdf08eaa1d0a868efa18e28468820">00254</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a11abdf08eaa1d0a868efa18e28468820">set_end_position</a>(<span class="keywordtype">int</span> statement_pos) {
<a name="l00255"></a>00255     <a class="code" href="classv8_1_1internal_1_1_scope.html#a6592aac772a057e97a3f10ac72e04062">end_position_</a> = statement_pos;
<a name="l00256"></a>00256   }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00259"></a>00259   <span class="comment">// Predicates.</span>
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   <span class="comment">// Specific scope types.</span>
<a name="l00262"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ab1a48d82c89c499b7a55fd6ea27a7962">00262</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ab1a48d82c89c499b7a55fd6ea27a7962">is_eval_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a> == <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17a48625ba91413781664475508a89a23c4">EVAL_SCOPE</a>; }
<a name="l00263"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a57d46167bd0008a565f55d2affcc468c">00263</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a57d46167bd0008a565f55d2affcc468c">is_function_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a> == <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17a01dbdbdc814f90f2abce96c42cf80b97">FUNCTION_SCOPE</a>; }
<a name="l00264"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a89bb3ab01e4b47dc22a87a031e443ffa">00264</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a89bb3ab01e4b47dc22a87a031e443ffa">is_module_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a> == <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17a62f6317b08d0d6c179c985998226c669">MODULE_SCOPE</a>; }
<a name="l00265"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#adcc7c6b7b9023f874ad5cce4c4fc3f9e">00265</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#adcc7c6b7b9023f874ad5cce4c4fc3f9e">is_global_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a> == <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17a6ffc021ecdf0bd6e9daa6f4e181c83d7">GLOBAL_SCOPE</a>; }
<a name="l00266"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a6d2d4fcaacd0cf17701344352433492c">00266</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6d2d4fcaacd0cf17701344352433492c">is_catch_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a> == <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17aa1dc2a583fc19c3636a1c599cda82622">CATCH_SCOPE</a>; }
<a name="l00267"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a7729b352d0ff683e82be0a9a30ae71fb">00267</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a7729b352d0ff683e82be0a9a30ae71fb">is_block_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a> == <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17ae893dcd5397cf8fcb11a338ce04fa20c">BLOCK_SCOPE</a>; }
<a name="l00268"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a240c2ab59b4da740d24a3798ea5950fa">00268</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a240c2ab59b4da740d24a3798ea5950fa">is_with_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a> == <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17ae1109491a5aa875d1cc5c3806f9b7ab3">WITH_SCOPE</a>; }
<a name="l00269"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ab184f54ad2e9ecc34dc3464b6a540501">00269</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ab184f54ad2e9ecc34dc3464b6a540501">is_declaration_scope</a>()<span class="keyword"> const </span>{
<a name="l00270"></a>00270     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ab1a48d82c89c499b7a55fd6ea27a7962">is_eval_scope</a>() || <a class="code" href="classv8_1_1internal_1_1_scope.html#a57d46167bd0008a565f55d2affcc468c">is_function_scope</a>() || <a class="code" href="classv8_1_1internal_1_1_scope.html#adcc7c6b7b9023f874ad5cce4c4fc3f9e">is_global_scope</a>();
<a name="l00271"></a>00271   }
<a name="l00272"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a6dbb72a219f72a7c6ae301c831c4e13f">00272</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6dbb72a219f72a7c6ae301c831c4e13f">is_classic_mode</a>()<span class="keyword"> const </span>{
<a name="l00273"></a>00273     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5753f13fa341fcbaecaf18c54254ddd5">language_mode</a>() == <a class="code" href="namespacev8_1_1internal.html#a1ba33e2c27dbf4a22f26a28f80096e75af8474a96ccda57ff2ba1b7cac73459c8">CLASSIC_MODE</a>;
<a name="l00274"></a>00274   }
<a name="l00275"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac6a60abc8545332bad692c3974c25f28">00275</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ac6a60abc8545332bad692c3974c25f28">is_extended_mode</a>()<span class="keyword"> const </span>{
<a name="l00276"></a>00276     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5753f13fa341fcbaecaf18c54254ddd5">language_mode</a>() == <a class="code" href="namespacev8_1_1internal.html#a1ba33e2c27dbf4a22f26a28f80096e75a1d578be70b2207ed04c9b7cc05527ec5">EXTENDED_MODE</a>;
<a name="l00277"></a>00277   }
<a name="l00278"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a776ec213e86f5e3814138119cb5d75eb">00278</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a776ec213e86f5e3814138119cb5d75eb">is_strict_or_extended_eval_scope</a>()<span class="keyword"> const </span>{
<a name="l00279"></a>00279     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ab1a48d82c89c499b7a55fd6ea27a7962">is_eval_scope</a>() &amp;&amp; !<a class="code" href="classv8_1_1internal_1_1_scope.html#a6dbb72a219f72a7c6ae301c831c4e13f">is_classic_mode</a>();
<a name="l00280"></a>00280   }
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   <span class="comment">// Information about which scopes calls eval.</span>
<a name="l00283"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a9c1e2e9ba6c6690f2330ab8807e444e7">00283</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a9c1e2e9ba6c6690f2330ab8807e444e7">calls_eval</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a4541ec4968037e4663d09c3d877b9f8d">scope_calls_eval_</a>; }
<a name="l00284"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a73830a1974c2e4ee638851c80e1724aa">00284</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a73830a1974c2e4ee638851c80e1724aa">calls_non_strict_eval</a>() {
<a name="l00285"></a>00285     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a4541ec4968037e4663d09c3d877b9f8d">scope_calls_eval_</a> &amp;&amp; <a class="code" href="classv8_1_1internal_1_1_scope.html#a6dbb72a219f72a7c6ae301c831c4e13f">is_classic_mode</a>();
<a name="l00286"></a>00286   }
<a name="l00287"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aae6306e076ec6b706a0d44d268ccf799">00287</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aae6306e076ec6b706a0d44d268ccf799">outer_scope_calls_non_strict_eval</a>()<span class="keyword"> const </span>{
<a name="l00288"></a>00288     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a26926147efcf362e108ae9245f24192d">outer_scope_calls_non_strict_eval_</a>;
<a name="l00289"></a>00289   }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291   <span class="comment">// Is this scope inside a with statement.</span>
<a name="l00292"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a876d4310ccde172a49d6f7fc872e5f80">00292</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a876d4310ccde172a49d6f7fc872e5f80">inside_with</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6201c5804752ef136e470df0c79b8b30">scope_inside_with_</a>; }
<a name="l00293"></a>00293   <span class="comment">// Does this scope contain a with statement.</span>
<a name="l00294"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ae2ff8bd87995159f2d3a82afe15f318a">00294</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ae2ff8bd87995159f2d3a82afe15f318a">contains_with</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#abcc42b038d3e9377891bbb0ea1ad3804">scope_contains_with_</a>; }
<a name="l00295"></a>00295 
<a name="l00296"></a>00296   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00297"></a>00297   <span class="comment">// Accessors.</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   <span class="comment">// The type of this scope.</span>
<a name="l00300"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#af1042286593e51ba13561c6ced41a6bc">00300</a>   <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17">ScopeType</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#af1042286593e51ba13561c6ced41a6bc">type</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a>; }
<a name="l00301"></a>00301 
<a name="l00302"></a>00302   <span class="comment">// The language mode of this scope.</span>
<a name="l00303"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a5753f13fa341fcbaecaf18c54254ddd5">00303</a>   <a class="code" href="namespacev8_1_1internal.html#a1ba33e2c27dbf4a22f26a28f80096e75">LanguageMode</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5753f13fa341fcbaecaf18c54254ddd5">language_mode</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a924ba8d563265ab5ff1103f9101a6130">language_mode_</a>; }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <span class="comment">// The variable corresponding the &#39;this&#39; value.</span>
<a name="l00306"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a68df9b2021d65dd954c1535dec4280c6">00306</a>   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a68df9b2021d65dd954c1535dec4280c6">receiver</a>() { <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a93c770d146d54d5eb48668f81d260501">receiver_</a>; }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308   <span class="comment">// The variable holding the function literal for named function</span>
<a name="l00309"></a>00309   <span class="comment">// literals, or NULL.  Only valid for function scopes.</span>
<a name="l00310"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a085bb7f233b867975bc29ec565697b0e">00310</a>   <a class="code" href="classv8_1_1internal_1_1_variable_declaration.html">VariableDeclaration</a>* <span class="keyword">function</span>() <span class="keyword">const</span> {
<a name="l00311"></a>00311     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html#a57d46167bd0008a565f55d2affcc468c">is_function_scope</a>());
<a name="l00312"></a>00312     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ad0c0cf049bc723932413e3355a3fce20">function_</a>;
<a name="l00313"></a>00313   }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315   <span class="comment">// Parameters. The left-most parameter has index 0.</span>
<a name="l00316"></a>00316   <span class="comment">// Only valid for function scopes.</span>
<a name="l00317"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a2bc11ea84ff36e325adca9a6b524226d">00317</a>   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a2bc11ea84ff36e325adca9a6b524226d">parameter</a>(<span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l00318"></a>00318     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html#a57d46167bd0008a565f55d2affcc468c">is_function_scope</a>());
<a name="l00319"></a>00319     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a670a1f3c09b6142f530942e3c6c8ba62">params_</a>[index];
<a name="l00320"></a>00320   }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#abf2dc87c78971a13940c62801760e98a">00322</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#abf2dc87c78971a13940c62801760e98a">num_parameters</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a670a1f3c09b6142f530942e3c6c8ba62">params_</a>.length(); }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324   <span class="comment">// The local variable &#39;arguments&#39; if we need to allocate it; NULL otherwise.</span>
<a name="l00325"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aca31ee71179c70dffd2b7722fa940f4a">00325</a>   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aca31ee71179c70dffd2b7722fa940f4a">arguments</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aeaeb3e90ef3d0214b1ce8ad3a3ed18df">arguments_</a>; }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327   <span class="comment">// Declarations list.</span>
<a name="l00328"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a7ddec523f1cd9d59aa9f72a9c0308cdc">00328</a>   <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Declaration*&gt;</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a7ddec523f1cd9d59aa9f72a9c0308cdc">declarations</a>() { <span class="keywordflow">return</span> &amp;<a class="code" href="classv8_1_1internal_1_1_scope.html#a717a82aa2d9f3edc973099833496062b">decls_</a>; }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330   <span class="comment">// Inner scope list.</span>
<a name="l00331"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a0e4d097ff1d3d529fecd08644a1131ba">00331</a>   <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Scope*&gt;</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a0e4d097ff1d3d529fecd08644a1131ba">inner_scopes</a>() { <span class="keywordflow">return</span> &amp;<a class="code" href="classv8_1_1internal_1_1_scope.html#a55862f98a87fcf63cdbb082e86206309">inner_scopes_</a>; }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   <span class="comment">// The scope immediately surrounding this scope, or NULL.</span>
<a name="l00334"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a103ace9a050c875d3df6e9f1152765f8">00334</a>   <a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a103ace9a050c875d3df6e9f1152765f8">outer_scope</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5583f7ff4187f292daac9cd625918ad8">outer_scope_</a>; }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336   <span class="comment">// The interface as inferred so far; only for module scopes.</span>
<a name="l00337"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#adef2e4ac765cbeba75f9e8de7e39cabd">00337</a>   <a class="code" href="classv8_1_1internal_1_1_interface.html">Interface</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#adef2e4ac765cbeba75f9e8de7e39cabd">interface</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aeb175ac2e7610dfb5a6a8675ac5e38ce">interface_</a>; }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00340"></a>00340   <span class="comment">// Variable allocation.</span>
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   <span class="comment">// Collect stack and context allocated local variables in this scope. Note</span>
<a name="l00343"></a>00343   <span class="comment">// that the function variable - if present - is not collected and should be</span>
<a name="l00344"></a>00344   <span class="comment">// handled separately.</span>
<a name="l00345"></a>00345   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6ffd0dbee0a6e5b59ac6d69b7500bdfc">CollectStackAndContextLocals</a>(<a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Variable*&gt;</a>* stack_locals,
<a name="l00346"></a>00346                                     <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Variable*&gt;</a>* context_locals);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348   <span class="comment">// Current number of var or const locals.</span>
<a name="l00349"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ae644a88477f9835859d5958a21393167">00349</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ae644a88477f9835859d5958a21393167">num_var_or_const</a>() { <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a58789c0f81c7cf66bed710d731e99993">num_var_or_const_</a>; }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351   <span class="comment">// Result of variable allocation.</span>
<a name="l00352"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac39784ef532a81635569d1c0bac14a54">00352</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ac39784ef532a81635569d1c0bac14a54">num_stack_slots</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#acb1ad68ebcafc0823caace322bc62d8e">num_stack_slots_</a>; }
<a name="l00353"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a0fb01c6c7008dab7ee6420011381bb7a">00353</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a0fb01c6c7008dab7ee6420011381bb7a">num_heap_slots</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aa7ff8ad11414d999f7328fedfee94c13">num_heap_slots_</a>; }
<a name="l00354"></a>00354 
<a name="l00355"></a>00355   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a87178b7d3605282589cf613a417ebebf">StackLocalCount</a>() <span class="keyword">const</span>;
<a name="l00356"></a>00356   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a035a505d7381a7973a1fa58e6e615eb1">ContextLocalCount</a>() <span class="keyword">const</span>;
<a name="l00357"></a>00357 
<a name="l00358"></a>00358   <span class="comment">// Make sure this scope and all outer scopes are eagerly compiled.</span>
<a name="l00359"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a609251b5a5e8fd6762298a9c282c9c77">00359</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a609251b5a5e8fd6762298a9c282c9c77">ForceEagerCompilation</a>()  { <a class="code" href="classv8_1_1internal_1_1_scope.html#a2730664fa3391665d16fc60938343574">force_eager_compilation_</a> = <span class="keyword">true</span>; }
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <span class="comment">// Determine if we can use lazy compilation for this scope.</span>
<a name="l00362"></a>00362   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a4d0aa05a7281a6445cf5b3f6685222ce">AllowsLazyCompilation</a>() <span class="keyword">const</span>;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364   <span class="comment">// True if we can lazily recompile functions with this scope.</span>
<a name="l00365"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a8633a32ddfed91f20f37830889b6a54b">00365</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a8633a32ddfed91f20f37830889b6a54b">allows_lazy_recompilation</a>()<span class="keyword"> const </span>{
<a name="l00366"></a>00366     <span class="keywordflow">return</span> !<a class="code" href="classv8_1_1internal_1_1_scope.html#a2730664fa3391665d16fc60938343574">force_eager_compilation_</a>;
<a name="l00367"></a>00367   }
<a name="l00368"></a>00368 
<a name="l00369"></a>00369   <span class="comment">// True if the outer context of this scope is always the global context.</span>
<a name="l00370"></a>00370   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a013580c95b228155f384966c8efe32db">HasTrivialOuterContext</a>() <span class="keyword">const</span>;
<a name="l00371"></a>00371 
<a name="l00372"></a>00372   <span class="comment">// The number of contexts between this and scope; zero if this == scope.</span>
<a name="l00373"></a>00373   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a529511c688fa9164e09a39ef9dc65e67">ContextChainLength</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* scope);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375   <span class="comment">// Find the first function, global, or eval scope.  This is the scope</span>
<a name="l00376"></a>00376   <span class="comment">// where var declarations will be hoisted to in the implementation.</span>
<a name="l00377"></a>00377   <a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aa39f7b4d3208196486b1e535228ab2a2">DeclarationScope</a>();
<a name="l00378"></a>00378 
<a name="l00379"></a>00379   <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;ScopeInfo&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#ae179acd04199865c85c9a0c3ca6d0790">GetScopeInfo</a>();
<a name="l00380"></a>00380 
<a name="l00381"></a>00381   <span class="comment">// Get the chain of nested scopes within this scope for the source statement</span>
<a name="l00382"></a>00382   <span class="comment">// position. The scopes will be added to the list from the outermost scope to</span>
<a name="l00383"></a>00383   <span class="comment">// the innermost scope. Only nested block, catch or with scopes are tracked</span>
<a name="l00384"></a>00384   <span class="comment">// and will be returned, but no inner function scopes.</span>
<a name="l00385"></a>00385   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#af5718c80c576d2d9de1eae1d676d409a">GetNestedScopeChain</a>(<a class="code" href="classv8_1_1internal_1_1_list.html">List</a>&lt;<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;ScopeInfo&gt;</a> &gt;* chain,
<a name="l00386"></a>00386                            <span class="keywordtype">int</span> statement_position);
<a name="l00387"></a>00387 
<a name="l00388"></a>00388   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00389"></a>00389   <span class="comment">// Strict mode support.</span>
<a name="l00390"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ab06108ae5a446fba07c5fb66afc152c0">00390</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ab06108ae5a446fba07c5fb66afc152c0">IsDeclared</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> name) {
<a name="l00391"></a>00391     <span class="comment">// During formal parameter list parsing the scope only contains</span>
<a name="l00392"></a>00392     <span class="comment">// two variables inserted at initialization: &quot;this&quot; and &quot;arguments&quot;.</span>
<a name="l00393"></a>00393     <span class="comment">// &quot;this&quot; is an invalid parameter name and &quot;arguments&quot; is invalid parameter</span>
<a name="l00394"></a>00394     <span class="comment">// name in strict mode. Therefore looking up with the map which includes</span>
<a name="l00395"></a>00395     <span class="comment">// &quot;this&quot; and &quot;arguments&quot; in addition to all formal parameters is safe.</span>
<a name="l00396"></a>00396     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5e4d6891383e2107c3d9e066d13bbdd4">variables_</a>.<a class="code" href="classv8_1_1internal_1_1_variable_map.html#a4612dcf68951be6562b30a7780d19c69">Lookup</a>(name) != <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>;
<a name="l00397"></a>00397   }
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00400"></a>00400   <span class="comment">// Debugging.</span>
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00403"></a>00403 <span class="preprocessor"></span>  <span class="keywordtype">void</span> <a class="code" href="lineprocessor_8cc.html#ae894408d53a5dd2fec4c3e7ea09d5d4b">Print</a>(<span class="keywordtype">int</span> n = 0);  <span class="comment">// n = indentation; n &lt; 0 =&gt; don&#39;t print recursively</span>
<a name="l00404"></a>00404 <span class="preprocessor">#endif</span>
<a name="l00405"></a>00405 <span class="preprocessor"></span>
<a name="l00406"></a>00406   <span class="comment">// ---------------------------------------------------------------------------</span>
<a name="l00407"></a>00407   <span class="comment">// Implementation.</span>
<a name="l00408"></a>00408  <span class="keyword">protected</span>:
<a name="l00409"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac43d6a50f1f6ed99577048bea49180fb">00409</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_scope.html#ac43d6a50f1f6ed99577048bea49180fb">ParserFactory</a>;
<a name="l00410"></a>00410 
<a name="l00411"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a828d7069bea2f13084f04fc43291d160">00411</a>   <a class="code" href="classv8_1_1internal_1_1_isolate.html">Isolate</a>* <span class="keyword">const</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a828d7069bea2f13084f04fc43291d160">isolate_</a>;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413   <span class="comment">// Scope tree.</span>
<a name="l00414"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a5583f7ff4187f292daac9cd625918ad8">00414</a>   <a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a5583f7ff4187f292daac9cd625918ad8">outer_scope_</a>;  <span class="comment">// the immediately enclosing outer scope, or NULL</span>
<a name="l00415"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a55862f98a87fcf63cdbb082e86206309">00415</a>   <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Scope*&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a55862f98a87fcf63cdbb082e86206309">inner_scopes_</a>;  <span class="comment">// the immediately enclosed inner scopes</span>
<a name="l00416"></a>00416 
<a name="l00417"></a>00417   <span class="comment">// The scope type.</span>
<a name="l00418"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">00418</a>   <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17">ScopeType</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5c60fcc484bb4d78752cafcf653ddce5">type_</a>;
<a name="l00419"></a>00419 
<a name="l00420"></a>00420   <span class="comment">// Debugging support.</span>
<a name="l00421"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac3f901d131bb05f1e0f1e8b8a19c804c">00421</a>   <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#ac3f901d131bb05f1e0f1e8b8a19c804c">scope_name_</a>;
<a name="l00422"></a>00422 
<a name="l00423"></a>00423   <span class="comment">// The variables declared in this scope:</span>
<a name="l00424"></a>00424   <span class="comment">//</span>
<a name="l00425"></a>00425   <span class="comment">// All user-declared variables (incl. parameters).  For global scopes</span>
<a name="l00426"></a>00426   <span class="comment">// variables may be implicitly &#39;declared&#39; by being used (possibly in</span>
<a name="l00427"></a>00427   <span class="comment">// an inner scope) with no intervening with statements or eval calls.</span>
<a name="l00428"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a5e4d6891383e2107c3d9e066d13bbdd4">00428</a>   <a class="code" href="classv8_1_1internal_1_1_variable_map.html">VariableMap</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5e4d6891383e2107c3d9e066d13bbdd4">variables_</a>;
<a name="l00429"></a>00429   <span class="comment">// Compiler-allocated (user-invisible) temporaries.</span>
<a name="l00430"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a1be7b435dfc60c78db11b2d74220f9ae">00430</a>   <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Variable*&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a1be7b435dfc60c78db11b2d74220f9ae">temps_</a>;
<a name="l00431"></a>00431   <span class="comment">// Parameter list in source order.</span>
<a name="l00432"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a670a1f3c09b6142f530942e3c6c8ba62">00432</a>   <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Variable*&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a670a1f3c09b6142f530942e3c6c8ba62">params_</a>;
<a name="l00433"></a>00433   <span class="comment">// Variables that must be looked up dynamically.</span>
<a name="l00434"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ab198d779a60c0912234dc4c3db768d47">00434</a>   <a class="code" href="classv8_1_1internal_1_1_dynamic_scope_part.html">DynamicScopePart</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#ab198d779a60c0912234dc4c3db768d47">dynamics_</a>;
<a name="l00435"></a>00435   <span class="comment">// Unresolved variables referred to from this scope.</span>
<a name="l00436"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a37b9e8c30724515e9f8ca3531e41fd4c">00436</a>   <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;VariableProxy*&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a37b9e8c30724515e9f8ca3531e41fd4c">unresolved_</a>;
<a name="l00437"></a>00437   <span class="comment">// Declarations.</span>
<a name="l00438"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a717a82aa2d9f3edc973099833496062b">00438</a>   <a class="code" href="classv8_1_1internal_1_1_zone_list.html">ZoneList&lt;Declaration*&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a717a82aa2d9f3edc973099833496062b">decls_</a>;
<a name="l00439"></a>00439   <span class="comment">// Convenience variable.</span>
<a name="l00440"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a93c770d146d54d5eb48668f81d260501">00440</a>   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a93c770d146d54d5eb48668f81d260501">receiver_</a>;
<a name="l00441"></a>00441   <span class="comment">// Function variable, if any; function scopes only.</span>
<a name="l00442"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ad0c0cf049bc723932413e3355a3fce20">00442</a>   <a class="code" href="classv8_1_1internal_1_1_variable_declaration.html">VariableDeclaration</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#ad0c0cf049bc723932413e3355a3fce20">function_</a>;
<a name="l00443"></a>00443   <span class="comment">// Convenience variable; function scopes only.</span>
<a name="l00444"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aeaeb3e90ef3d0214b1ce8ad3a3ed18df">00444</a>   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aeaeb3e90ef3d0214b1ce8ad3a3ed18df">arguments_</a>;
<a name="l00445"></a>00445   <span class="comment">// Interface; module scopes only.</span>
<a name="l00446"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aeb175ac2e7610dfb5a6a8675ac5e38ce">00446</a>   <a class="code" href="classv8_1_1internal_1_1_interface.html">Interface</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aeb175ac2e7610dfb5a6a8675ac5e38ce">interface_</a>;
<a name="l00447"></a>00447 
<a name="l00448"></a>00448   <span class="comment">// Illegal redeclaration.</span>
<a name="l00449"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aac2bb70747d573b68dc5c6ff554fc827">00449</a>   <a class="code" href="classv8_1_1internal_1_1_expression.html">Expression</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#aac2bb70747d573b68dc5c6ff554fc827">illegal_redecl_</a>;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   <span class="comment">// Scope-specific information computed during parsing.</span>
<a name="l00452"></a>00452   <span class="comment">//</span>
<a name="l00453"></a>00453   <span class="comment">// This scope is inside a &#39;with&#39; of some outer scope.</span>
<a name="l00454"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a6201c5804752ef136e470df0c79b8b30">00454</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6201c5804752ef136e470df0c79b8b30">scope_inside_with_</a>;
<a name="l00455"></a>00455   <span class="comment">// This scope contains a &#39;with&#39; statement.</span>
<a name="l00456"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#abcc42b038d3e9377891bbb0ea1ad3804">00456</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#abcc42b038d3e9377891bbb0ea1ad3804">scope_contains_with_</a>;
<a name="l00457"></a>00457   <span class="comment">// This scope or a nested catch scope or with scope contain an &#39;eval&#39; call. At</span>
<a name="l00458"></a>00458   <span class="comment">// the &#39;eval&#39; call site this scope is the declaration scope.</span>
<a name="l00459"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a4541ec4968037e4663d09c3d877b9f8d">00459</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a4541ec4968037e4663d09c3d877b9f8d">scope_calls_eval_</a>;
<a name="l00460"></a>00460   <span class="comment">// The language mode of this scope.</span>
<a name="l00461"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a924ba8d563265ab5ff1103f9101a6130">00461</a>   <a class="code" href="namespacev8_1_1internal.html#a1ba33e2c27dbf4a22f26a28f80096e75">LanguageMode</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a924ba8d563265ab5ff1103f9101a6130">language_mode_</a>;
<a name="l00462"></a>00462   <span class="comment">// Source positions.</span>
<a name="l00463"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a9ea8507e658edffc2568771ccc5393db">00463</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a9ea8507e658edffc2568771ccc5393db">start_position_</a>;
<a name="l00464"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a6592aac772a057e97a3f10ac72e04062">00464</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a6592aac772a057e97a3f10ac72e04062">end_position_</a>;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466   <span class="comment">// Computed via PropagateScopeInfo.</span>
<a name="l00467"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a26926147efcf362e108ae9245f24192d">00467</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a26926147efcf362e108ae9245f24192d">outer_scope_calls_non_strict_eval_</a>;
<a name="l00468"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ab653543f5209af44a5356c2e2e87cbae">00468</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ab653543f5209af44a5356c2e2e87cbae">inner_scope_calls_eval_</a>;
<a name="l00469"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a2730664fa3391665d16fc60938343574">00469</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a2730664fa3391665d16fc60938343574">force_eager_compilation_</a>;
<a name="l00470"></a>00470 
<a name="l00471"></a>00471   <span class="comment">// True if it doesn&#39;t need scope resolution (e.g., if the scope was</span>
<a name="l00472"></a>00472   <span class="comment">// constructed based on a serialized scope info or a catch context).</span>
<a name="l00473"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a91489cb76b587d340324e5ff04057e45">00473</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a91489cb76b587d340324e5ff04057e45">already_resolved_</a>;
<a name="l00474"></a>00474 
<a name="l00475"></a>00475   <span class="comment">// Computed as variables are declared.</span>
<a name="l00476"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a58789c0f81c7cf66bed710d731e99993">00476</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a58789c0f81c7cf66bed710d731e99993">num_var_or_const_</a>;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="comment">// Computed via AllocateVariables; function, block and catch scopes only.</span>
<a name="l00479"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#acb1ad68ebcafc0823caace322bc62d8e">00479</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#acb1ad68ebcafc0823caace322bc62d8e">num_stack_slots_</a>;
<a name="l00480"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#aa7ff8ad11414d999f7328fedfee94c13">00480</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aa7ff8ad11414d999f7328fedfee94c13">num_heap_slots_</a>;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482   <span class="comment">// Serialized scope info support.</span>
<a name="l00483"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#a3a53ff212117f98292cf31609105b4d0">00483</a>   <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;ScopeInfo&gt;</a> <a class="code" href="classv8_1_1internal_1_1_scope.html#a3a53ff212117f98292cf31609105b4d0">scope_info_</a>;
<a name="l00484"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ada85f14d546573a3bc19cd9e178919f3">00484</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ada85f14d546573a3bc19cd9e178919f3">already_resolved</a>() { <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a91489cb76b587d340324e5ff04057e45">already_resolved_</a>; }
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <span class="comment">// Create a non-local variable with a given name.</span>
<a name="l00487"></a>00487   <span class="comment">// These variables are looked up dynamically at runtime.</span>
<a name="l00488"></a>00488   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a7d91e1b1bad8087ec486cc0cab9fbb31">NonLocal</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> name, <a class="code" href="namespacev8_1_1internal.html#a7e6c17aa46835cb34aa75323fcc10c16">VariableMode</a> mode);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490   <span class="comment">// Variable resolution.</span>
<a name="l00491"></a>00491   <span class="comment">// Possible results of a recursive variable lookup telling if and how a</span>
<a name="l00492"></a>00492   <span class="comment">// variable is bound. These are returned in the output parameter *binding_kind</span>
<a name="l00493"></a>00493   <span class="comment">// of the LookupRecursive function.</span>
<a name="l00494"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145">00494</a>   <span class="keyword">enum</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145">BindingKind</a> {
<a name="l00495"></a>00495     <span class="comment">// The variable reference could be statically resolved to a variable binding</span>
<a name="l00496"></a>00496     <span class="comment">// which is returned. There is no &#39;with&#39; statement between the reference and</span>
<a name="l00497"></a>00497     <span class="comment">// the binding and no scope between the reference scope (inclusive) and</span>
<a name="l00498"></a>00498     <span class="comment">// binding scope (exclusive) makes a non-strict &#39;eval&#39; call.</span>
<a name="l00499"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145a8a6bef34c427123638395f69468dd172">00499</a>     <a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145a8a6bef34c427123638395f69468dd172">BOUND</a>,
<a name="l00500"></a>00500 
<a name="l00501"></a>00501     <span class="comment">// The variable reference could be statically resolved to a variable binding</span>
<a name="l00502"></a>00502     <span class="comment">// which is returned. There is no &#39;with&#39; statement between the reference and</span>
<a name="l00503"></a>00503     <span class="comment">// the binding, but some scope between the reference scope (inclusive) and</span>
<a name="l00504"></a>00504     <span class="comment">// binding scope (exclusive) makes a non-strict &#39;eval&#39; call, that might</span>
<a name="l00505"></a>00505     <span class="comment">// possibly introduce variable bindings shadowing the found one. Thus the</span>
<a name="l00506"></a>00506     <span class="comment">// found variable binding is just a guess.</span>
<a name="l00507"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145af72b93ad30567f8fe2a0886ca0077ffd">00507</a>     <a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145af72b93ad30567f8fe2a0886ca0077ffd">BOUND_EVAL_SHADOWED</a>,
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="comment">// The variable reference could not be statically resolved to any binding</span>
<a name="l00510"></a>00510     <span class="comment">// and thus should be considered referencing a global variable. NULL is</span>
<a name="l00511"></a>00511     <span class="comment">// returned. The variable reference is not inside any &#39;with&#39; statement and</span>
<a name="l00512"></a>00512     <span class="comment">// no scope between the reference scope (inclusive) and global scope</span>
<a name="l00513"></a>00513     <span class="comment">// (exclusive) makes a non-strict &#39;eval&#39; call.</span>
<a name="l00514"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145a8d34e25299437206c26d806cfe4d93d0">00514</a>     <a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145a8d34e25299437206c26d806cfe4d93d0">UNBOUND</a>,
<a name="l00515"></a>00515 
<a name="l00516"></a>00516     <span class="comment">// The variable reference could not be statically resolved to any binding</span>
<a name="l00517"></a>00517     <span class="comment">// NULL is returned. The variable reference is not inside any &#39;with&#39;</span>
<a name="l00518"></a>00518     <span class="comment">// statement, but some scope between the reference scope (inclusive) and</span>
<a name="l00519"></a>00519     <span class="comment">// global scope (exclusive) makes a non-strict &#39;eval&#39; call, that might</span>
<a name="l00520"></a>00520     <span class="comment">// possibly introduce a variable binding. Thus the reference should be</span>
<a name="l00521"></a>00521     <span class="comment">// considered referencing a global variable unless it is shadowed by an</span>
<a name="l00522"></a>00522     <span class="comment">// &#39;eval&#39; introduced binding.</span>
<a name="l00523"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145ad4af66701b3002ac486004f71a69c3ad">00523</a>     <a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145ad4af66701b3002ac486004f71a69c3ad">UNBOUND_EVAL_SHADOWED</a>,
<a name="l00524"></a>00524 
<a name="l00525"></a>00525     <span class="comment">// The variable could not be statically resolved and needs to be looked up</span>
<a name="l00526"></a>00526     <span class="comment">// dynamically. NULL is returned. There are two possible reasons:</span>
<a name="l00527"></a>00527     <span class="comment">// * A &#39;with&#39; statement has been encountered and there is no variable</span>
<a name="l00528"></a>00528     <span class="comment">//   binding for the name between the variable reference and the &#39;with&#39;.</span>
<a name="l00529"></a>00529     <span class="comment">//   The variable potentially references a property of the &#39;with&#39; object.</span>
<a name="l00530"></a>00530     <span class="comment">// * The code is being executed as part of a call to &#39;eval&#39; and the calling</span>
<a name="l00531"></a>00531     <span class="comment">//   context chain contains either a variable binding for the name or it</span>
<a name="l00532"></a>00532     <span class="comment">//   contains a &#39;with&#39; context.</span>
<a name="l00533"></a><a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145acc700bb45f5a02a25340df5dcfa1488c">00533</a>     <a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145acc700bb45f5a02a25340df5dcfa1488c">DYNAMIC_LOOKUP</a>
<a name="l00534"></a>00534   };
<a name="l00535"></a>00535 
<a name="l00536"></a>00536   <span class="comment">// Lookup a variable reference given by name recursively starting with this</span>
<a name="l00537"></a>00537   <span class="comment">// scope. If the code is executed because of a call to &#39;eval&#39;, the context</span>
<a name="l00538"></a>00538   <span class="comment">// parameter should be set to the calling context of &#39;eval&#39;.</span>
<a name="l00539"></a>00539   <a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* <a class="code" href="classv8_1_1internal_1_1_scope.html#a1de89af5be79ae4cb185b46123cdb869">LookupRecursive</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> name,
<a name="l00540"></a>00540                             <a class="code" href="classv8_1_1internal_1_1_scope.html#ac0377699b350082cce5e931f1dbfa145">BindingKind</a>* binding_kind,
<a name="l00541"></a>00541                             AstNodeFactory&lt;AstNullVisitor&gt;* factory);
<a name="l00542"></a>00542   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a>
<a name="l00543"></a>00543   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a79c1137dd9cfb144f8314166db770b46">ResolveVariable</a>(CompilationInfo* info,
<a name="l00544"></a>00544                        <a class="code" href="classv8_1_1internal_1_1_variable_proxy.html">VariableProxy</a>* proxy,
<a name="l00545"></a>00545                        AstNodeFactory&lt;AstNullVisitor&gt;* factory);
<a name="l00546"></a>00546   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a>
<a name="l00547"></a>00547   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#afa5634e1f0f8fed6bd4373bbcf07327b">ResolveVariablesRecursively</a>(CompilationInfo* info,
<a name="l00548"></a>00548                                    AstNodeFactory&lt;AstNullVisitor&gt;* factory);
<a name="l00549"></a>00549 
<a name="l00550"></a>00550   <span class="comment">// Scope analysis.</span>
<a name="l00551"></a>00551   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a47ab8dcff542318a23b21ccd5dfa5eae">PropagateScopeInfo</a>(<span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#aae6306e076ec6b706a0d44d268ccf799">outer_scope_calls_non_strict_eval</a>);
<a name="l00552"></a>00552   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a3b8d0a35414fea4bb389a228631a1da4">HasTrivialContext</a>() <span class="keyword">const</span>;
<a name="l00553"></a>00553 
<a name="l00554"></a>00554   <span class="comment">// Predicates.</span>
<a name="l00555"></a>00555   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#ace80ba20403956a4ac174a7e44eb47bd">MustAllocate</a>(<a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* var);
<a name="l00556"></a>00556   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a7b2293179db997cf4398e46b77b44213">MustAllocateInContext</a>(<a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* var);
<a name="l00557"></a>00557   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a8a5a424b647900a34c6939b1c6f388bc">HasArgumentsParameter</a>();
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <span class="comment">// Variable allocation.</span>
<a name="l00560"></a>00560   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a765d63a4936a0993deb5934a20dfb0c3">AllocateStackSlot</a>(<a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* var);
<a name="l00561"></a>00561   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a03c32bfa8205b464b1630479f9e91679">AllocateHeapSlot</a>(<a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* var);
<a name="l00562"></a>00562   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a38ce394f1b00141a4b6abc185974257a">AllocateParameterLocals</a>();
<a name="l00563"></a>00563   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a0280894e48a1c4cc08c12740c1297767">AllocateNonParameterLocal</a>(<a class="code" href="classv8_1_1internal_1_1_variable.html">Variable</a>* var);
<a name="l00564"></a>00564   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a4f31edf3b1181d93ab1329f90227c56e">AllocateNonParameterLocals</a>();
<a name="l00565"></a>00565   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a5658e6c37363a9ef878f887b134fdec5">AllocateVariablesRecursively</a>();
<a name="l00566"></a>00566 
<a name="l00567"></a>00567   <span class="comment">// Resolve and fill in the allocation information for all variables</span>
<a name="l00568"></a>00568   <span class="comment">// in this scopes. Must be called *after* all scopes have been</span>
<a name="l00569"></a>00569   <span class="comment">// processed (parsed) to ensure that unresolved variables can be</span>
<a name="l00570"></a>00570   <span class="comment">// resolved properly.</span>
<a name="l00571"></a>00571   <span class="comment">//</span>
<a name="l00572"></a>00572   <span class="comment">// In the case of code compiled and run using &#39;eval&#39;, the context</span>
<a name="l00573"></a>00573   <span class="comment">// parameter is the context in which eval was called.  In all other</span>
<a name="l00574"></a>00574   <span class="comment">// cases the context parameter is an empty handle.</span>
<a name="l00575"></a>00575   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a>
<a name="l00576"></a>00576   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_scope.html#a200e0933c8ef7917ef8e2a2ba8bc1d34">AllocateVariables</a>(CompilationInfo* info,
<a name="l00577"></a>00577                          AstNodeFactory&lt;AstNullVisitor&gt;* factory);
<a name="l00578"></a>00578 
<a name="l00579"></a>00579  <span class="keyword">private</span>:
<a name="l00580"></a>00580   <span class="comment">// Construct a scope based on the scope info.</span>
<a name="l00581"></a>00581   <a class="code" href="classv8_1_1internal_1_1_scope.html#a3d53cfa8ad035f4f47df598e5ecf8f82">Scope</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* inner_scope, <a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17">ScopeType</a> type, <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;ScopeInfo&gt;</a> scope_info);
<a name="l00582"></a>00582 
<a name="l00583"></a>00583   <span class="comment">// Construct a catch scope with a binding for the name.</span>
<a name="l00584"></a>00584   <a class="code" href="classv8_1_1internal_1_1_scope.html#a3d53cfa8ad035f4f47df598e5ecf8f82">Scope</a>(<a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* inner_scope, <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;String&gt;</a> catch_variable_name);
<a name="l00585"></a>00585 
<a name="l00586"></a>00586   <span class="keywordtype">void</span> AddInnerScope(<a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a>* inner_scope) {
<a name="l00587"></a>00587     <span class="keywordflow">if</span> (inner_scope != <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>) {
<a name="l00588"></a>00588       <a class="code" href="classv8_1_1internal_1_1_scope.html#a55862f98a87fcf63cdbb082e86206309">inner_scopes_</a>.<a class="code" href="classv8_1_1internal_1_1_list.html#a19e166e0f9afcc82a17f426eadf322e4">Add</a>(inner_scope);
<a name="l00589"></a>00589       inner_scope-&gt;<a class="code" href="classv8_1_1internal_1_1_scope.html#a5583f7ff4187f292daac9cd625918ad8">outer_scope_</a> = <span class="keyword">this</span>;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591   }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593   <span class="keywordtype">void</span> SetDefaults(<a class="code" href="namespacev8_1_1internal.html#ad0138f8a2874ad84f5d2517b45e30e17">ScopeType</a> type,
<a name="l00594"></a>00594                    <a class="code" href="classv8_1_1internal_1_1_scope.html#a3d53cfa8ad035f4f47df598e5ecf8f82">Scope</a>* outer_scope,
<a name="l00595"></a>00595                    Handle&lt;ScopeInfo&gt; scope_info);
<a name="l00596"></a>00596 };
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 } }  <span class="comment">// namespace v8::internal</span>
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 <span class="preprocessor">#endif  // V8_SCOPES_H_</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="scopes_8h.html">scopes.h</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 13:06:13 for V8 API Reference Guide by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
