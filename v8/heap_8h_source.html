<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>V8 API Reference Guide: /home/codex/apps/v8/src/heap.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.jpg"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">V8 API Reference Guide
   
   </div>
   <div id="projectbrief">If this is out of date tweet @Contra</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('heap_8h.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/home/codex/apps/v8/src/heap.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="heap_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright 2012 the V8 project authors. All rights reserved.</span>
<a name="l00002"></a>00002 <span class="comment">// Redistribution and use in source and binary forms, with or without</span>
<a name="l00003"></a>00003 <span class="comment">// modification, are permitted provided that the following conditions are</span>
<a name="l00004"></a>00004 <span class="comment">// met:</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//     * Redistributions of source code must retain the above copyright</span>
<a name="l00007"></a>00007 <span class="comment">//       notice, this list of conditions and the following disclaimer.</span>
<a name="l00008"></a>00008 <span class="comment">//     * Redistributions in binary form must reproduce the above</span>
<a name="l00009"></a>00009 <span class="comment">//       copyright notice, this list of conditions and the following</span>
<a name="l00010"></a>00010 <span class="comment">//       disclaimer in the documentation and/or other materials provided</span>
<a name="l00011"></a>00011 <span class="comment">//       with the distribution.</span>
<a name="l00012"></a>00012 <span class="comment">//     * Neither the name of Google Inc. nor the names of its</span>
<a name="l00013"></a>00013 <span class="comment">//       contributors may be used to endorse or promote products derived</span>
<a name="l00014"></a>00014 <span class="comment">//       from this software without specific prior written permission.</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00017"></a>00017 <span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00018"></a>00018 <span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00019"></a>00019 <span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00020"></a>00020 <span class="comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00021"></a>00021 <span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00022"></a>00022 <span class="comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00023"></a>00023 <span class="comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00024"></a>00024 <span class="comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00025"></a>00025 <span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00026"></a>00026 <span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#ifndef V8_HEAP_H_</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#define V8_HEAP_H_</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="allocation_8h.html">allocation.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="globals_8h.html">globals.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="incremental-marking_8h.html">incremental-marking.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="list_8h.html">list.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="mark-compact_8h.html">mark-compact.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="objects-visiting_8h.html">objects-visiting.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="spaces_8h.html">spaces.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="splay-tree-inl_8h.html">splay-tree-inl.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="store-buffer_8h.html">store-buffer.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="v8-counters_8h.html">v8-counters.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="v8globals_8h.html">v8globals.h</a>&quot;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="keyword">namespace </span>v8 {
<a name="l00046"></a>00046 <span class="keyword">namespace </span>internal {
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="comment">// Defines all the roots in Heap.</span>
<a name="l00049"></a><a class="code" href="heap_8h.html#a9f01550232518f85dca2f152bbc3677d">00049</a> <span class="preprocessor">#define STRONG_ROOT_LIST(V)                                                    \</span>
<a name="l00050"></a>00050 <span class="preprocessor">  V(Map, byte_array_map, ByteArrayMap)                                         \</span>
<a name="l00051"></a>00051 <span class="preprocessor">  V(Map, free_space_map, FreeSpaceMap)                                         \</span>
<a name="l00052"></a>00052 <span class="preprocessor">  V(Map, one_pointer_filler_map, OnePointerFillerMap)                          \</span>
<a name="l00053"></a>00053 <span class="preprocessor">  V(Map, two_pointer_filler_map, TwoPointerFillerMap)                          \</span>
<a name="l00054"></a>00054 <span class="preprocessor">  </span><span class="comment">/* Cluster the most popular ones in a few cache lines here at the top.    */</span> \
<a name="l00055"></a>00055   V(Smi, store_buffer_top, StoreBufferTop)                                     \
<a name="l00056"></a>00056   V(Oddball, undefined_value, UndefinedValue)                                  \
<a name="l00057"></a>00057   V(Oddball, the_hole_value, TheHoleValue)                                     \
<a name="l00058"></a>00058   V(Oddball, null_value, NullValue)                                            \
<a name="l00059"></a>00059   V(Oddball, true_value, TrueValue)                                            \
<a name="l00060"></a>00060   V(Oddball, false_value, FalseValue)                                          \
<a name="l00061"></a>00061   V(Map, global_property_cell_map, GlobalPropertyCellMap)                      \
<a name="l00062"></a>00062   V(Map, shared_function_info_map, SharedFunctionInfoMap)                      \
<a name="l00063"></a>00063   V(Map, meta_map, MetaMap)                                                    \
<a name="l00064"></a>00064   V(Map, ascii_symbol_map, AsciiSymbolMap)                                     \
<a name="l00065"></a>00065   V(Map, ascii_string_map, AsciiStringMap)                                     \
<a name="l00066"></a>00066   V(Map, heap_number_map, HeapNumberMap)                                       \
<a name="l00067"></a>00067   V(Map, global_context_map, GlobalContextMap)                                 \
<a name="l00068"></a>00068   V(Map, fixed_array_map, FixedArrayMap)                                       \
<a name="l00069"></a>00069   V(Map, code_map, CodeMap)                                                    \
<a name="l00070"></a>00070   V(Map, scope_info_map, ScopeInfoMap)                                         \
<a name="l00071"></a>00071   V(Map, fixed_cow_array_map, FixedCOWArrayMap)                                \
<a name="l00072"></a>00072   V(Map, fixed_double_array_map, FixedDoubleArrayMap)                          \
<a name="l00073"></a>00073   V(Object, no_interceptor_result_sentinel, NoInterceptorResultSentinel)       \
<a name="l00074"></a>00074   V(Map, hash_table_map, HashTableMap)                                         \
<a name="l00075"></a>00075   V(FixedArray, empty_fixed_array, EmptyFixedArray)                            \
<a name="l00076"></a>00076   V(ByteArray, empty_byte_array, EmptyByteArray)                               \
<a name="l00077"></a>00077   V(String, empty_string, EmptyString)                                         \
<a name="l00078"></a>00078   V(DescriptorArray, empty_descriptor_array, EmptyDescriptorArray)             \
<a name="l00079"></a>00079   V(Smi, stack_limit, StackLimit)                                              \
<a name="l00080"></a>00080   V(Oddball, arguments_marker, ArgumentsMarker)                                \
<a name="l00081"></a>00081   <span class="comment">/* The first 32 roots above this line should be boring from a GC point of */</span> \
<a name="l00082"></a>00082   <span class="comment">/* view.  This means they are never in new space and never on a page that */</span> \
<a name="l00083"></a>00083   <span class="comment">/* is being compacted.                                                    */</span> \
<a name="l00084"></a>00084   V(FixedArray, number_string_cache, NumberStringCache)                        \
<a name="l00085"></a>00085   V(Object, instanceof_cache_function, InstanceofCacheFunction)                \
<a name="l00086"></a>00086   V(Object, instanceof_cache_map, InstanceofCacheMap)                          \
<a name="l00087"></a>00087   V(Object, instanceof_cache_answer, InstanceofCacheAnswer)                    \
<a name="l00088"></a>00088   V(FixedArray, single_character_string_cache, SingleCharacterStringCache)     \
<a name="l00089"></a>00089   V(FixedArray, string_split_cache, StringSplitCache)                          \
<a name="l00090"></a>00090   V(Object, termination_exception, TerminationException)                       \
<a name="l00091"></a>00091   V(Smi, hash_seed, HashSeed)                                                  \
<a name="l00092"></a>00092   V(Map, string_map, StringMap)                                                \
<a name="l00093"></a>00093   V(Map, symbol_map, SymbolMap)                                                \
<a name="l00094"></a>00094   V(Map, cons_string_map, ConsStringMap)                                       \
<a name="l00095"></a>00095   V(Map, cons_ascii_string_map, ConsAsciiStringMap)                            \
<a name="l00096"></a>00096   V(Map, sliced_string_map, SlicedStringMap)                                   \
<a name="l00097"></a>00097   V(Map, sliced_ascii_string_map, SlicedAsciiStringMap)                        \
<a name="l00098"></a>00098   V(Map, cons_symbol_map, ConsSymbolMap)                                       \
<a name="l00099"></a>00099   V(Map, cons_ascii_symbol_map, ConsAsciiSymbolMap)                            \
<a name="l00100"></a>00100   V(Map, external_symbol_map, ExternalSymbolMap)                               \
<a name="l00101"></a>00101   V(Map, external_symbol_with_ascii_data_map, ExternalSymbolWithAsciiDataMap)  \
<a name="l00102"></a>00102   V(Map, external_ascii_symbol_map, ExternalAsciiSymbolMap)                    \
<a name="l00103"></a>00103   V(Map, external_string_map, ExternalStringMap)                               \
<a name="l00104"></a>00104   V(Map, external_string_with_ascii_data_map, ExternalStringWithAsciiDataMap)  \
<a name="l00105"></a>00105   V(Map, external_ascii_string_map, ExternalAsciiStringMap)                    \
<a name="l00106"></a>00106   V(Map, short_external_symbol_map, ShortExternalSymbolMap)                    \
<a name="l00107"></a>00107   V(Map,                                                                       \
<a name="l00108"></a>00108     short_external_symbol_with_ascii_data_map,                                 \
<a name="l00109"></a>00109     ShortExternalSymbolWithAsciiDataMap)                                       \
<a name="l00110"></a>00110   V(Map, short_external_ascii_symbol_map, ShortExternalAsciiSymbolMap)         \
<a name="l00111"></a>00111   V(Map, short_external_string_map, ShortExternalStringMap)                    \
<a name="l00112"></a>00112   V(Map,                                                                       \
<a name="l00113"></a>00113     short_external_string_with_ascii_data_map,                                 \
<a name="l00114"></a>00114     ShortExternalStringWithAsciiDataMap)                                       \
<a name="l00115"></a>00115   V(Map, short_external_ascii_string_map, ShortExternalAsciiStringMap)         \
<a name="l00116"></a>00116   V(Map, undetectable_string_map, UndetectableStringMap)                       \
<a name="l00117"></a>00117   V(Map, undetectable_ascii_string_map, UndetectableAsciiStringMap)            \
<a name="l00118"></a>00118   V(Map, external_pixel_array_map, ExternalPixelArrayMap)                      \
<a name="l00119"></a>00119   V(Map, external_byte_array_map, ExternalByteArrayMap)                        \
<a name="l00120"></a>00120   V(Map, external_unsigned_byte_array_map, ExternalUnsignedByteArrayMap)       \
<a name="l00121"></a>00121   V(Map, external_short_array_map, ExternalShortArrayMap)                      \
<a name="l00122"></a>00122   V(Map, external_unsigned_short_array_map, ExternalUnsignedShortArrayMap)     \
<a name="l00123"></a>00123   V(Map, external_int_array_map, ExternalIntArrayMap)                          \
<a name="l00124"></a>00124   V(Map, external_unsigned_int_array_map, ExternalUnsignedIntArrayMap)         \
<a name="l00125"></a>00125   V(Map, external_float_array_map, ExternalFloatArrayMap)                      \
<a name="l00126"></a>00126   V(Map, external_double_array_map, ExternalDoubleArrayMap)                    \
<a name="l00127"></a>00127   V(Map, non_strict_arguments_elements_map, NonStrictArgumentsElementsMap)     \
<a name="l00128"></a>00128   V(Map, function_context_map, FunctionContextMap)                             \
<a name="l00129"></a>00129   V(Map, catch_context_map, CatchContextMap)                                   \
<a name="l00130"></a>00130   V(Map, with_context_map, WithContextMap)                                     \
<a name="l00131"></a>00131   V(Map, block_context_map, BlockContextMap)                                   \
<a name="l00132"></a>00132   V(Map, module_context_map, ModuleContextMap)                                 \
<a name="l00133"></a>00133   V(Map, oddball_map, OddballMap)                                              \
<a name="l00134"></a>00134   V(Map, message_object_map, JSMessageObjectMap)                               \
<a name="l00135"></a>00135   V(Map, foreign_map, ForeignMap)                                              \
<a name="l00136"></a>00136   V(HeapNumber, nan_value, NanValue)                                           \
<a name="l00137"></a>00137   V(HeapNumber, infinity_value, InfinityValue)                                 \
<a name="l00138"></a>00138   V(HeapNumber, minus_zero_value, MinusZeroValue)                              \
<a name="l00139"></a>00139   V(Map, neander_map, NeanderMap)                                              \
<a name="l00140"></a>00140   V(JSObject, message_listeners, MessageListeners)                             \
<a name="l00141"></a>00141   V(Foreign, prototype_accessors, PrototypeAccessors)                          \
<a name="l00142"></a>00142   V(UnseededNumberDictionary, code_stubs, CodeStubs)                           \
<a name="l00143"></a>00143   V(UnseededNumberDictionary, non_monomorphic_cache, NonMonomorphicCache)      \
<a name="l00144"></a>00144   V(PolymorphicCodeCache, polymorphic_code_cache, PolymorphicCodeCache)        \
<a name="l00145"></a>00145   V(Code, js_entry_code, JsEntryCode)                                          \
<a name="l00146"></a>00146   V(Code, js_construct_entry_code, JsConstructEntryCode)                       \
<a name="l00147"></a>00147   V(FixedArray, natives_source_cache, NativesSourceCache)                      \
<a name="l00148"></a>00148   V(Object, last_script_id, LastScriptId)                                      \
<a name="l00149"></a>00149   V(Script, empty_script, EmptyScript)                                         \
<a name="l00150"></a>00150   V(Smi, real_stack_limit, RealStackLimit)                                     \
<a name="l00151"></a>00151   V(StringDictionary, intrinsic_function_names, IntrinsicFunctionNames)        \
<a name="l00152"></a>00152   V(Smi, arguments_adaptor_deopt_pc_offset, ArgumentsAdaptorDeoptPCOffset)     \
<a name="l00153"></a>00153   V(Smi, construct_stub_deopt_pc_offset, ConstructStubDeoptPCOffset)
<a name="l00154"></a>00154 
<a name="l00155"></a><a class="code" href="heap_8h.html#a6f2cf89f87e025582097c2febe7ca152">00155</a> <span class="preprocessor">#define ROOT_LIST(V)                                  \</span>
<a name="l00156"></a>00156 <span class="preprocessor">  STRONG_ROOT_LIST(V)                                 \</span>
<a name="l00157"></a>00157 <span class="preprocessor">  V(SymbolTable, symbol_table, SymbolTable)</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span>
<a name="l00159"></a><a class="code" href="heap_8h.html#a5fc83e0f16e7ddf38e053f8537c39727">00159</a> <span class="preprocessor">#define SYMBOL_LIST(V)                                                   \</span>
<a name="l00160"></a>00160 <span class="preprocessor">  V(Array_symbol, &quot;Array&quot;)                                               \</span>
<a name="l00161"></a>00161 <span class="preprocessor">  V(Object_symbol, &quot;Object&quot;)                                             \</span>
<a name="l00162"></a>00162 <span class="preprocessor">  V(Proto_symbol, &quot;__proto__&quot;)                                           \</span>
<a name="l00163"></a>00163 <span class="preprocessor">  V(StringImpl_symbol, &quot;StringImpl&quot;)                                     \</span>
<a name="l00164"></a>00164 <span class="preprocessor">  V(arguments_symbol, &quot;arguments&quot;)                                       \</span>
<a name="l00165"></a>00165 <span class="preprocessor">  V(Arguments_symbol, &quot;Arguments&quot;)                                       \</span>
<a name="l00166"></a>00166 <span class="preprocessor">  V(call_symbol, &quot;call&quot;)                                                 \</span>
<a name="l00167"></a>00167 <span class="preprocessor">  V(apply_symbol, &quot;apply&quot;)                                               \</span>
<a name="l00168"></a>00168 <span class="preprocessor">  V(caller_symbol, &quot;caller&quot;)                                             \</span>
<a name="l00169"></a>00169 <span class="preprocessor">  V(boolean_symbol, &quot;boolean&quot;)                                           \</span>
<a name="l00170"></a>00170 <span class="preprocessor">  V(Boolean_symbol, &quot;Boolean&quot;)                                           \</span>
<a name="l00171"></a>00171 <span class="preprocessor">  V(callee_symbol, &quot;callee&quot;)                                             \</span>
<a name="l00172"></a>00172 <span class="preprocessor">  V(constructor_symbol, &quot;constructor&quot;)                                   \</span>
<a name="l00173"></a>00173 <span class="preprocessor">  V(code_symbol, &quot;.code&quot;)                                                \</span>
<a name="l00174"></a>00174 <span class="preprocessor">  V(result_symbol, &quot;.result&quot;)                                            \</span>
<a name="l00175"></a>00175 <span class="preprocessor">  V(catch_var_symbol, &quot;.catch-var&quot;)                                      \</span>
<a name="l00176"></a>00176 <span class="preprocessor">  V(empty_symbol, &quot;&quot;)                                                    \</span>
<a name="l00177"></a>00177 <span class="preprocessor">  V(eval_symbol, &quot;eval&quot;)                                                 \</span>
<a name="l00178"></a>00178 <span class="preprocessor">  V(function_symbol, &quot;function&quot;)                                         \</span>
<a name="l00179"></a>00179 <span class="preprocessor">  V(length_symbol, &quot;length&quot;)                                             \</span>
<a name="l00180"></a>00180 <span class="preprocessor">  V(module_symbol, &quot;module&quot;)                                             \</span>
<a name="l00181"></a>00181 <span class="preprocessor">  V(name_symbol, &quot;name&quot;)                                                 \</span>
<a name="l00182"></a>00182 <span class="preprocessor">  V(native_symbol, &quot;native&quot;)                                             \</span>
<a name="l00183"></a>00183 <span class="preprocessor">  V(null_symbol, &quot;null&quot;)                                                 \</span>
<a name="l00184"></a>00184 <span class="preprocessor">  V(number_symbol, &quot;number&quot;)                                             \</span>
<a name="l00185"></a>00185 <span class="preprocessor">  V(Number_symbol, &quot;Number&quot;)                                             \</span>
<a name="l00186"></a>00186 <span class="preprocessor">  V(nan_symbol, &quot;NaN&quot;)                                                   \</span>
<a name="l00187"></a>00187 <span class="preprocessor">  V(RegExp_symbol, &quot;RegExp&quot;)                                             \</span>
<a name="l00188"></a>00188 <span class="preprocessor">  V(source_symbol, &quot;source&quot;)                                             \</span>
<a name="l00189"></a>00189 <span class="preprocessor">  V(global_symbol, &quot;global&quot;)                                             \</span>
<a name="l00190"></a>00190 <span class="preprocessor">  V(ignore_case_symbol, &quot;ignoreCase&quot;)                                    \</span>
<a name="l00191"></a>00191 <span class="preprocessor">  V(multiline_symbol, &quot;multiline&quot;)                                       \</span>
<a name="l00192"></a>00192 <span class="preprocessor">  V(input_symbol, &quot;input&quot;)                                               \</span>
<a name="l00193"></a>00193 <span class="preprocessor">  V(index_symbol, &quot;index&quot;)                                               \</span>
<a name="l00194"></a>00194 <span class="preprocessor">  V(last_index_symbol, &quot;lastIndex&quot;)                                      \</span>
<a name="l00195"></a>00195 <span class="preprocessor">  V(object_symbol, &quot;object&quot;)                                             \</span>
<a name="l00196"></a>00196 <span class="preprocessor">  V(prototype_symbol, &quot;prototype&quot;)                                       \</span>
<a name="l00197"></a>00197 <span class="preprocessor">  V(string_symbol, &quot;string&quot;)                                             \</span>
<a name="l00198"></a>00198 <span class="preprocessor">  V(String_symbol, &quot;String&quot;)                                             \</span>
<a name="l00199"></a>00199 <span class="preprocessor">  V(Date_symbol, &quot;Date&quot;)                                                 \</span>
<a name="l00200"></a>00200 <span class="preprocessor">  V(this_symbol, &quot;this&quot;)                                                 \</span>
<a name="l00201"></a>00201 <span class="preprocessor">  V(to_string_symbol, &quot;toString&quot;)                                        \</span>
<a name="l00202"></a>00202 <span class="preprocessor">  V(char_at_symbol, &quot;CharAt&quot;)                                            \</span>
<a name="l00203"></a>00203 <span class="preprocessor">  V(undefined_symbol, &quot;undefined&quot;)                                       \</span>
<a name="l00204"></a>00204 <span class="preprocessor">  V(value_of_symbol, &quot;valueOf&quot;)                                          \</span>
<a name="l00205"></a>00205 <span class="preprocessor">  V(InitializeVarGlobal_symbol, &quot;InitializeVarGlobal&quot;)                   \</span>
<a name="l00206"></a>00206 <span class="preprocessor">  V(InitializeConstGlobal_symbol, &quot;InitializeConstGlobal&quot;)               \</span>
<a name="l00207"></a>00207 <span class="preprocessor">  V(KeyedLoadElementMonomorphic_symbol,                                  \</span>
<a name="l00208"></a>00208 <span class="preprocessor">    &quot;KeyedLoadElementMonomorphic&quot;)                                       \</span>
<a name="l00209"></a>00209 <span class="preprocessor">  V(KeyedStoreElementMonomorphic_symbol,                                 \</span>
<a name="l00210"></a>00210 <span class="preprocessor">    &quot;KeyedStoreElementMonomorphic&quot;)                                      \</span>
<a name="l00211"></a>00211 <span class="preprocessor">  V(KeyedStoreAndGrowElementMonomorphic_symbol,                          \</span>
<a name="l00212"></a>00212 <span class="preprocessor">    &quot;KeyedStoreAndGrowElementMonomorphic&quot;)                               \</span>
<a name="l00213"></a>00213 <span class="preprocessor">  V(stack_overflow_symbol, &quot;kStackOverflowBoilerplate&quot;)                  \</span>
<a name="l00214"></a>00214 <span class="preprocessor">  V(illegal_access_symbol, &quot;illegal access&quot;)                             \</span>
<a name="l00215"></a>00215 <span class="preprocessor">  V(out_of_memory_symbol, &quot;out-of-memory&quot;)                               \</span>
<a name="l00216"></a>00216 <span class="preprocessor">  V(illegal_execution_state_symbol, &quot;illegal execution state&quot;)           \</span>
<a name="l00217"></a>00217 <span class="preprocessor">  V(get_symbol, &quot;get&quot;)                                                   \</span>
<a name="l00218"></a>00218 <span class="preprocessor">  V(set_symbol, &quot;set&quot;)                                                   \</span>
<a name="l00219"></a>00219 <span class="preprocessor">  V(function_class_symbol, &quot;Function&quot;)                                   \</span>
<a name="l00220"></a>00220 <span class="preprocessor">  V(illegal_argument_symbol, &quot;illegal argument&quot;)                         \</span>
<a name="l00221"></a>00221 <span class="preprocessor">  V(MakeReferenceError_symbol, &quot;MakeReferenceError&quot;)                     \</span>
<a name="l00222"></a>00222 <span class="preprocessor">  V(MakeSyntaxError_symbol, &quot;MakeSyntaxError&quot;)                           \</span>
<a name="l00223"></a>00223 <span class="preprocessor">  V(MakeTypeError_symbol, &quot;MakeTypeError&quot;)                               \</span>
<a name="l00224"></a>00224 <span class="preprocessor">  V(invalid_lhs_in_assignment_symbol, &quot;invalid_lhs_in_assignment&quot;)       \</span>
<a name="l00225"></a>00225 <span class="preprocessor">  V(invalid_lhs_in_for_in_symbol, &quot;invalid_lhs_in_for_in&quot;)               \</span>
<a name="l00226"></a>00226 <span class="preprocessor">  V(invalid_lhs_in_postfix_op_symbol, &quot;invalid_lhs_in_postfix_op&quot;)       \</span>
<a name="l00227"></a>00227 <span class="preprocessor">  V(invalid_lhs_in_prefix_op_symbol, &quot;invalid_lhs_in_prefix_op&quot;)         \</span>
<a name="l00228"></a>00228 <span class="preprocessor">  V(illegal_return_symbol, &quot;illegal_return&quot;)                             \</span>
<a name="l00229"></a>00229 <span class="preprocessor">  V(illegal_break_symbol, &quot;illegal_break&quot;)                               \</span>
<a name="l00230"></a>00230 <span class="preprocessor">  V(illegal_continue_symbol, &quot;illegal_continue&quot;)                         \</span>
<a name="l00231"></a>00231 <span class="preprocessor">  V(unknown_label_symbol, &quot;unknown_label&quot;)                               \</span>
<a name="l00232"></a>00232 <span class="preprocessor">  V(redeclaration_symbol, &quot;redeclaration&quot;)                               \</span>
<a name="l00233"></a>00233 <span class="preprocessor">  V(failure_symbol, &quot;&lt;failure&gt;&quot;)                                         \</span>
<a name="l00234"></a>00234 <span class="preprocessor">  V(space_symbol, &quot; &quot;)                                                   \</span>
<a name="l00235"></a>00235 <span class="preprocessor">  V(exec_symbol, &quot;exec&quot;)                                                 \</span>
<a name="l00236"></a>00236 <span class="preprocessor">  V(zero_symbol, &quot;0&quot;)                                                    \</span>
<a name="l00237"></a>00237 <span class="preprocessor">  V(global_eval_symbol, &quot;GlobalEval&quot;)                                    \</span>
<a name="l00238"></a>00238 <span class="preprocessor">  V(identity_hash_symbol, &quot;v8::IdentityHash&quot;)                            \</span>
<a name="l00239"></a>00239 <span class="preprocessor">  V(closure_symbol, &quot;(closure)&quot;)                                         \</span>
<a name="l00240"></a>00240 <span class="preprocessor">  V(use_strict, &quot;use strict&quot;)                                            \</span>
<a name="l00241"></a>00241 <span class="preprocessor">  V(dot_symbol, &quot;.&quot;)                                                     \</span>
<a name="l00242"></a>00242 <span class="preprocessor">  V(anonymous_function_symbol, &quot;(anonymous function)&quot;)                   \</span>
<a name="l00243"></a>00243 <span class="preprocessor">  V(compare_ic_symbol, &quot;.compare_ic&quot;)                                    \</span>
<a name="l00244"></a>00244 <span class="preprocessor">  V(infinity_symbol, &quot;Infinity&quot;)                                         \</span>
<a name="l00245"></a>00245 <span class="preprocessor">  V(minus_infinity_symbol, &quot;-Infinity&quot;)                                  \</span>
<a name="l00246"></a>00246 <span class="preprocessor">  V(hidden_stack_trace_symbol, &quot;v8::hidden_stack_trace&quot;)                 \</span>
<a name="l00247"></a>00247 <span class="preprocessor">  V(query_colon_symbol, &quot;(?:)&quot;)</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>
<a name="l00249"></a>00249 <span class="comment">// Forward declarations.</span>
<a name="l00250"></a>00250 <span class="keyword">class </span>GCTracer;
<a name="l00251"></a>00251 <span class="keyword">class </span>HeapStats;
<a name="l00252"></a>00252 <span class="keyword">class </span>Isolate;
<a name="l00253"></a>00253 <span class="keyword">class </span>WeakObjectRetainer;
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="namespacev8_1_1internal.html#aa7a678fdf86beb6a8ac5f27b9d3525c0">00256</a> <span class="keyword">typedef</span> <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* (*ExternalStringTableUpdaterCallback)(<a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>* heap,
<a name="l00257"></a>00257                                                       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>** pointer);
<a name="l00258"></a>00258 
<a name="l00259"></a><a class="code" href="classv8_1_1internal_1_1_store_buffer_rebuilder.html">00259</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_store_buffer_rebuilder.html">StoreBufferRebuilder</a> {
<a name="l00260"></a>00260  <span class="keyword">public</span>:
<a name="l00261"></a><a class="code" href="classv8_1_1internal_1_1_store_buffer_rebuilder.html#ac65b8f7d37182813ff0b132fe5846fd5">00261</a>   <span class="keyword">explicit</span> <a class="code" href="classv8_1_1internal_1_1_store_buffer_rebuilder.html#ac65b8f7d37182813ff0b132fe5846fd5">StoreBufferRebuilder</a>(<a class="code" href="classv8_1_1internal_1_1_store_buffer.html">StoreBuffer</a>* store_buffer)
<a name="l00262"></a>00262       : store_buffer_(store_buffer) {
<a name="l00263"></a>00263   }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_store_buffer_rebuilder.html#a4443adecb0d222557bcf3d62589d9cc4">Callback</a>(<a class="code" href="classv8_1_1internal_1_1_memory_chunk.html">MemoryChunk</a>* page, <a class="code" href="namespacev8_1_1internal.html#a64d7c87386ac80c1e616cbfc6bb4446a">StoreBufferEvent</a> event);
<a name="l00266"></a>00266 
<a name="l00267"></a>00267  <span class="keyword">private</span>:
<a name="l00268"></a>00268   <a class="code" href="classv8_1_1internal_1_1_store_buffer.html">StoreBuffer</a>* store_buffer_;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270   <span class="comment">// We record in this variable how full the store buffer was when we started</span>
<a name="l00271"></a>00271   <span class="comment">// iterating over the current page, finding pointers to new space.  If the</span>
<a name="l00272"></a>00272   <span class="comment">// store buffer overflows again we can exempt the page from the store buffer</span>
<a name="l00273"></a>00273   <span class="comment">// by rewinding to this point instead of having to search the store buffer.</span>
<a name="l00274"></a>00274   <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>*** start_of_current_page_;
<a name="l00275"></a>00275   <span class="comment">// The current page we are scanning in the store buffer iterator.</span>
<a name="l00276"></a>00276   <a class="code" href="classv8_1_1internal_1_1_memory_chunk.html">MemoryChunk</a>* current_page_;
<a name="l00277"></a>00277 };
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">// The all static Heap captures the interface to the global object heap.</span>
<a name="l00282"></a>00282 <span class="comment">// All JavaScript contexts by this process share the same object heap.</span>
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00285"></a>00285 <span class="preprocessor"></span><span class="keyword">class </span>HeapDebugUtils;
<a name="l00286"></a>00286 <span class="preprocessor">#endif</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span>
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 <span class="comment">// A queue of objects promoted during scavenge. Each object is accompanied</span>
<a name="l00290"></a>00290 <span class="comment">// by it&#39;s size to avoid dereferencing a map pointer for scanning.</span>
<a name="l00291"></a><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html">00291</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html">PromotionQueue</a> {
<a name="l00292"></a>00292  <span class="keyword">public</span>:
<a name="l00293"></a><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#ac9c472b9d1c50a83bc7374dd552201cf">00293</a>   <span class="keyword">explicit</span> <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#ac9c472b9d1c50a83bc7374dd552201cf">PromotionQueue</a>(<a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>* heap)
<a name="l00294"></a>00294       : front_(<a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>),
<a name="l00295"></a>00295         rear_(<a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>),
<a name="l00296"></a>00296         limit_(<a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>),
<a name="l00297"></a>00297         emergency_stack_(0),
<a name="l00298"></a>00298         heap_(heap) { }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#a6a3bd7f803954858deabd4615ce293f1">Initialize</a>();
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#af99253e51b342838cb1a489340a03f07">00302</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#af99253e51b342838cb1a489340a03f07">Destroy</a>() {
<a name="l00303"></a>00303     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(<a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#af4f0442551e6e3374ef388e669727a43">is_empty</a>());
<a name="l00304"></a>00304     <span class="keyword">delete</span> emergency_stack_;
<a name="l00305"></a>00305     emergency_stack_ = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>;
<a name="l00306"></a>00306   }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#a478eac1e5b68c1ac388c8c8299e04359">ActivateGuardIfOnTheSamePage</a>();
<a name="l00309"></a>00309 
<a name="l00310"></a><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#aa7ee948adff739d5dd2e2197533bb911">00310</a>   <a class="code" href="classv8_1_1internal_1_1_page.html">Page</a>* <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#aa7ee948adff739d5dd2e2197533bb911">GetHeadPage</a>() {
<a name="l00311"></a>00311     <span class="keywordflow">return</span> Page::FromAllocationTop(reinterpret_cast&lt;Address&gt;(rear_));
<a name="l00312"></a>00312   }
<a name="l00313"></a>00313 
<a name="l00314"></a><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#ad2459b5e1377d362335de242ed9a771e">00314</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#ad2459b5e1377d362335de242ed9a771e">SetNewLimit</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> limit) {
<a name="l00315"></a>00315     <span class="keywordflow">if</span> (!guard_) {
<a name="l00316"></a>00316       <span class="keywordflow">return</span>;
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(<a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#aa7ee948adff739d5dd2e2197533bb911">GetHeadPage</a>() == Page::FromAllocationTop(limit));
<a name="l00320"></a>00320     limit_ = <span class="keyword">reinterpret_cast&lt;</span>intptr_t*<span class="keyword">&gt;</span>(limit);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322     <span class="keywordflow">if</span> (limit_ &lt;= rear_) {
<a name="l00323"></a>00323       <span class="keywordflow">return</span>;
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     RelocateQueueHead();
<a name="l00327"></a>00327   }
<a name="l00328"></a>00328 
<a name="l00329"></a><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#af4f0442551e6e3374ef388e669727a43">00329</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#af4f0442551e6e3374ef388e669727a43">is_empty</a>() {
<a name="l00330"></a>00330     <span class="keywordflow">return</span> (front_ == rear_) &amp;&amp;
<a name="l00331"></a>00331         (emergency_stack_ == <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a> || emergency_stack_-&gt;length() == 0);
<a name="l00332"></a>00332   }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#aceaebf449282a5e02ccffd8b664d208f">insert</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* target, <span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>);
<a name="l00335"></a>00335 
<a name="l00336"></a><a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#a7990e838e6cd5ffe41aaa9d6bf6b58d9">00336</a>   <span class="keywordtype">void</span> <span class="keyword">remove</span>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>** target, <span class="keywordtype">int</span>* <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>) {
<a name="l00337"></a>00337     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(!<a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#af4f0442551e6e3374ef388e669727a43">is_empty</a>());
<a name="l00338"></a>00338     <span class="keywordflow">if</span> (front_ == rear_) {
<a name="l00339"></a>00339       Entry e = emergency_stack_-&gt;RemoveLast();
<a name="l00340"></a>00340       *target = e.obj_;
<a name="l00341"></a>00341       *<a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a> = e.size_;
<a name="l00342"></a>00342       <span class="keywordflow">return</span>;
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345     <span class="keywordflow">if</span> (<a class="code" href="classv8_1_1internal_1_1_new_space_page.html#a95c0f65be99a16369f76708bf27ead2d">NewSpacePage::IsAtStart</a>(reinterpret_cast&lt;Address&gt;(front_))) {
<a name="l00346"></a>00346       <a class="code" href="classv8_1_1internal_1_1_new_space_page.html">NewSpacePage</a>* front_page =
<a name="l00347"></a>00347           <a class="code" href="classv8_1_1internal_1_1_new_space_page.html#abfc27202ec422e3a19ea430440cf3608">NewSpacePage::FromAddress</a>(reinterpret_cast&lt;Address&gt;(front_));
<a name="l00348"></a>00348       <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(!front_page-&gt;<a class="code" href="classv8_1_1internal_1_1_new_space_page.html#ac97a49a13d7c0aba5c4372f5b9fa7403">prev_page</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1_new_space_page.html#a4e9f30cf45b58385257c7f353c86ffdd">is_anchor</a>());
<a name="l00349"></a>00349       front_ =
<a name="l00350"></a>00350           <span class="keyword">reinterpret_cast&lt;</span>intptr_t*<span class="keyword">&gt;</span>(front_page-&gt;<a class="code" href="classv8_1_1internal_1_1_new_space_page.html#ac97a49a13d7c0aba5c4372f5b9fa7403">prev_page</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1_memory_chunk.html#ad3898b428d291ef457bc87c2999ff18d">area_end</a>());
<a name="l00351"></a>00351     }
<a name="l00352"></a>00352     *target = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>*<span class="keyword">&gt;</span>(*(--front_));
<a name="l00353"></a>00353     *<a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(*(--front_));
<a name="l00354"></a>00354     <span class="comment">// Assert no underflow.</span>
<a name="l00355"></a>00355     <a class="code" href="classv8_1_1internal_1_1_semi_space.html#ae78e80586c1013a2339790bd6f5938e2">SemiSpace::AssertValidRange</a>(reinterpret_cast&lt;Address&gt;(rear_),
<a name="l00356"></a>00356                                 reinterpret_cast&lt;Address&gt;(front_));
<a name="l00357"></a>00357   }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359  <span class="keyword">private</span>:
<a name="l00360"></a>00360   <span class="comment">// The front of the queue is higher in the memory page chain than the rear.</span>
<a name="l00361"></a>00361   intptr_t* front_;
<a name="l00362"></a>00362   intptr_t* rear_;
<a name="l00363"></a>00363   intptr_t* limit_;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   <span class="keywordtype">bool</span> guard_;
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kEntrySizeInWords = 2;
<a name="l00368"></a>00368 
<a name="l00369"></a>00369   <span class="keyword">struct </span>Entry {
<a name="l00370"></a>00370     Entry(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* obj, <span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>) : obj_(obj), size_(size) { }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372     HeapObject* obj_;
<a name="l00373"></a>00373     <span class="keywordtype">int</span> size_;
<a name="l00374"></a>00374   };
<a name="l00375"></a>00375   List&lt;Entry&gt;* emergency_stack_;
<a name="l00376"></a>00376 
<a name="l00377"></a>00377   Heap* heap_;
<a name="l00378"></a>00378 
<a name="l00379"></a>00379   <span class="keywordtype">void</span> RelocateQueueHead();
<a name="l00380"></a>00380 
<a name="l00381"></a>00381   DISALLOW_COPY_AND_ASSIGN(<a class="code" href="classv8_1_1internal_1_1_promotion_queue.html#ac9c472b9d1c50a83bc7374dd552201cf">PromotionQueue</a>);
<a name="l00382"></a>00382 };
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 
<a name="l00385"></a><a class="code" href="namespacev8_1_1internal.html#a439ed64ac061568c0cbeb85fe465ff74">00385</a> <span class="keyword">typedef</span> void (*<a class="code" href="namespacev8_1_1internal.html#a439ed64ac061568c0cbeb85fe465ff74">ScavengingCallback</a>)(<a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map,
<a name="l00386"></a>00386                                    <a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>** slot,
<a name="l00387"></a>00387                                    <a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* object);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 <span class="comment">// External strings table is a place where all external strings are</span>
<a name="l00391"></a>00391 <span class="comment">// registered.  We need to keep track of such strings to properly</span>
<a name="l00392"></a>00392 <span class="comment">// finalize them.</span>
<a name="l00393"></a><a class="code" href="classv8_1_1internal_1_1_external_string_table.html">00393</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_external_string_table.html">ExternalStringTable</a> {
<a name="l00394"></a>00394  <span class="keyword">public</span>:
<a name="l00395"></a>00395   <span class="comment">// Registers an external string.</span>
<a name="l00396"></a>00396   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_external_string_table.html#a3bf7b49408dd2ab6adcea923fa0a4ae3">AddString</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <span class="keywordtype">string</span>);
<a name="l00397"></a>00397 
<a name="l00398"></a>00398   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_external_string_table.html#a268c59925d1c4cbda628992da9cca5b5">Iterate</a>(ObjectVisitor* v);
<a name="l00399"></a>00399 
<a name="l00400"></a>00400   <span class="comment">// Restores internal invariant and gets rid of collected strings.</span>
<a name="l00401"></a>00401   <span class="comment">// Must be called after each Iterate() that modified the strings.</span>
<a name="l00402"></a>00402   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_external_string_table.html#a4f54beeecab102c7c8d21105912682b4">CleanUp</a>();
<a name="l00403"></a>00403 
<a name="l00404"></a>00404   <span class="comment">// Destroys all allocated memory.</span>
<a name="l00405"></a>00405   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_external_string_table.html#a4a8138d461c15851db4815837e605f46">TearDown</a>();
<a name="l00406"></a>00406 
<a name="l00407"></a>00407  <span class="keyword">private</span>:
<a name="l00408"></a>00408   <a class="code" href="classv8_1_1internal_1_1_external_string_table.html">ExternalStringTable</a>() { }
<a name="l00409"></a>00409 
<a name="l00410"></a><a class="code" href="classv8_1_1internal_1_1_external_string_table.html#a3d69975be2e998e7bf2dcd1b1c8b4577">00410</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="keyword">inline</span> <span class="keywordtype">void</span> Verify();
<a name="l00413"></a>00413 
<a name="l00414"></a>00414   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddOldString(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <span class="keywordtype">string</span>);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416   <span class="comment">// Notifies the table that only a prefix of the new list is valid.</span>
<a name="l00417"></a>00417   <span class="keyword">inline</span> <span class="keywordtype">void</span> ShrinkNewStrings(<span class="keywordtype">int</span> position);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="comment">// To speed up scavenge collections new space string are kept</span>
<a name="l00420"></a>00420   <span class="comment">// separate from old space strings.</span>
<a name="l00421"></a>00421   <a class="code" href="classv8_1_1internal_1_1_list.html">List&lt;Object*&gt;</a> new_space_strings_;
<a name="l00422"></a>00422   <a class="code" href="classv8_1_1internal_1_1_list.html">List&lt;Object*&gt;</a> old_space_strings_;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424   <a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>* heap_;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <a class="code" href="globals_8h.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(<a class="code" href="classv8_1_1internal_1_1_external_string_table.html">ExternalStringTable</a>);
<a name="l00427"></a>00427 };
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0becc">00430</a> <span class="keyword">enum</span> <a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0becc">ArrayStorageAllocationMode</a> {
<a name="l00431"></a><a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0beccacdaf8ca1a4da2a7507b667eee5b59a6b">00431</a>   <a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0beccacdaf8ca1a4da2a7507b667eee5b59a6b">DONT_INITIALIZE_ARRAY_ELEMENTS</a>,
<a name="l00432"></a><a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0becca6d6948eef9a5a76a9bd36cbb9c61f700">00432</a>   <a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0becca6d6948eef9a5a76a9bd36cbb9c61f700">INITIALIZE_ARRAY_ELEMENTS_WITH_HOLE</a>
<a name="l00433"></a>00433 };
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="classv8_1_1internal_1_1_heap.html">00435</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a> {
<a name="l00436"></a>00436  <span class="keyword">public</span>:
<a name="l00437"></a>00437   <span class="comment">// Configure heap size before setup. Return false if the heap has been</span>
<a name="l00438"></a>00438   <span class="comment">// set up already.</span>
<a name="l00439"></a>00439   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a14a00c2a8a661fbdde874acae0a0999d">ConfigureHeap</a>(<span class="keywordtype">int</span> max_semispace_size,
<a name="l00440"></a>00440                      intptr_t max_old_gen_size,
<a name="l00441"></a>00441                      intptr_t max_executable_size);
<a name="l00442"></a>00442   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#adc6be218f980e9f7388078766ff7bbb5">ConfigureHeapDefault</a>();
<a name="l00443"></a>00443 
<a name="l00444"></a>00444   <span class="comment">// Initializes the global object heap. If create_heap_objects is true,</span>
<a name="l00445"></a>00445   <span class="comment">// also creates the basic non-mutable objects.</span>
<a name="l00446"></a>00446   <span class="comment">// Returns whether it succeeded.</span>
<a name="l00447"></a>00447   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac93f63f5b35fcd4048d054abacfac375">SetUp</a>(<span class="keywordtype">bool</span> create_heap_objects);
<a name="l00448"></a>00448 
<a name="l00449"></a>00449   <span class="comment">// Destroys all memory allocated by the heap.</span>
<a name="l00450"></a>00450   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ab2deb2dc488bddc2a509e068fddcb89b">TearDown</a>();
<a name="l00451"></a>00451 
<a name="l00452"></a>00452   <span class="comment">// Set the stack limit in the roots_ array.  Some architectures generate</span>
<a name="l00453"></a>00453   <span class="comment">// code that looks here, because it is faster than loading from the static</span>
<a name="l00454"></a>00454   <span class="comment">// jslimit_/real_jslimit_ variable in the StackGuard.</span>
<a name="l00455"></a>00455   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a15c1be5638d9e7858555810ee6745a57">SetStackLimits</a>();
<a name="l00456"></a>00456 
<a name="l00457"></a>00457   <span class="comment">// Returns whether SetUp has been called.</span>
<a name="l00458"></a>00458   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aad225fb00e461d862dd4ce44d6be2009">HasBeenSetUp</a>();
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   <span class="comment">// Returns the maximum amount of memory reserved for the heap.  For</span>
<a name="l00461"></a>00461   <span class="comment">// the young generation, we reserve 4 times the amount needed for a</span>
<a name="l00462"></a>00462   <span class="comment">// semi space.  The young generation consists of two semi spaces and</span>
<a name="l00463"></a>00463   <span class="comment">// we reserve twice the amount needed for those in order to ensure</span>
<a name="l00464"></a>00464   <span class="comment">// that new space can be aligned to its size.</span>
<a name="l00465"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a6985f7237d936063f214cc5ff7492467">00465</a>   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a6985f7237d936063f214cc5ff7492467">MaxReserved</a>() {
<a name="l00466"></a>00466     <span class="keywordflow">return</span> 4 * reserved_semispace_size_ + max_old_generation_size_;
<a name="l00467"></a>00467   }
<a name="l00468"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aea940688ad0d52c47b7145e4e1c9497a">00468</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aea940688ad0d52c47b7145e4e1c9497a">MaxSemiSpaceSize</a>() { <span class="keywordflow">return</span> max_semispace_size_; }
<a name="l00469"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aa843eba9fe9dc8f0ea733642c10c0595">00469</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aa843eba9fe9dc8f0ea733642c10c0595">ReservedSemiSpaceSize</a>() { <span class="keywordflow">return</span> reserved_semispace_size_; }
<a name="l00470"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aa14059e13579c9035eb517603d7a075a">00470</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aa14059e13579c9035eb517603d7a075a">InitialSemiSpaceSize</a>() { <span class="keywordflow">return</span> initial_semispace_size_; }
<a name="l00471"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a03f9e59f9b28d86fe392b01530a59803">00471</a>   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a03f9e59f9b28d86fe392b01530a59803">MaxOldGenerationSize</a>() { <span class="keywordflow">return</span> max_old_generation_size_; }
<a name="l00472"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a5d5a8d60465fbf66d2468c781d764f7d">00472</a>   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a5d5a8d60465fbf66d2468c781d764f7d">MaxExecutableSize</a>() { <span class="keywordflow">return</span> max_executable_size_; }
<a name="l00473"></a>00473 
<a name="l00474"></a>00474   <span class="comment">// Returns the capacity of the heap in bytes w/o growing. Heap grows when</span>
<a name="l00475"></a>00475   <span class="comment">// more spaces are needed until it reaches the limit.</span>
<a name="l00476"></a>00476   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#ad7150b0b8779df02426caf208d4b461b">Capacity</a>();
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="comment">// Returns the amount of memory currently committed for the heap.</span>
<a name="l00479"></a>00479   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#ac3e40b6212e1e969d3d1957bbf4aafb9">CommittedMemory</a>();
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="comment">// Returns the amount of executable memory currently committed for the heap.</span>
<a name="l00482"></a>00482   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a27cdc86dcaa54ae8db2a14d9a466b10c">CommittedMemoryExecutable</a>();
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="comment">// Returns the available bytes in space w/o growing.</span>
<a name="l00485"></a>00485   <span class="comment">// Heap doesn&#39;t guarantee that it can allocate an object that requires</span>
<a name="l00486"></a>00486   <span class="comment">// all available bytes. Check MaxHeapObjectSize() instead.</span>
<a name="l00487"></a>00487   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a79fbb6f19e2e4193920ef94d5dec54d4">Available</a>();
<a name="l00488"></a>00488 
<a name="l00489"></a>00489   <span class="comment">// Returns of size of all objects residing in the heap.</span>
<a name="l00490"></a>00490   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#ae864c40e24bf7d6fcdbfbf97ac309d14">SizeOfObjects</a>();
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="comment">// Return the starting address and a mask for the new space.  And-masking an</span>
<a name="l00493"></a>00493   <span class="comment">// address with the mask will result in the start address of the new space</span>
<a name="l00494"></a>00494   <span class="comment">// for all addresses in either semispace.</span>
<a name="l00495"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a09d26d32d1f75c8256f9e4df98f96f5c">00495</a>   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> <a class="code" href="classv8_1_1internal_1_1_heap.html#a09d26d32d1f75c8256f9e4df98f96f5c">NewSpaceStart</a>() { <span class="keywordflow">return</span> new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#ad350338a57641d5d844e1e45415bb327">start</a>(); }
<a name="l00496"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a12789005c26130e01719fd312f0bbd30">00496</a>   uintptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a12789005c26130e01719fd312f0bbd30">NewSpaceMask</a>() { <span class="keywordflow">return</span> new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#af7b8398afe3e58368f8b4d2115692738">mask</a>(); }
<a name="l00497"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a5201e67e7a9eff6f9f7c2dea9e4c2775">00497</a>   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> <a class="code" href="classv8_1_1internal_1_1_heap.html#a5201e67e7a9eff6f9f7c2dea9e4c2775">NewSpaceTop</a>() { <span class="keywordflow">return</span> new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#a92582edd8562e673b9f6594f5f6d21bd">top</a>(); }
<a name="l00498"></a>00498 
<a name="l00499"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ac478b09b843c03d566d054dba67a498e">00499</a>   <a class="code" href="classv8_1_1internal_1_1_new_space.html">NewSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#ac478b09b843c03d566d054dba67a498e">new_space</a>() { <span class="keywordflow">return</span> &amp;new_space_; }
<a name="l00500"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a0fa4311d4e5b283b63602a4abb0d89bf">00500</a>   <a class="code" href="classv8_1_1internal_1_1_old_space.html">OldSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a0fa4311d4e5b283b63602a4abb0d89bf">old_pointer_space</a>() { <span class="keywordflow">return</span> old_pointer_space_; }
<a name="l00501"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aab6a41e438e2c1fd8c092f1fc6e74275">00501</a>   <a class="code" href="classv8_1_1internal_1_1_old_space.html">OldSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#aab6a41e438e2c1fd8c092f1fc6e74275">old_data_space</a>() { <span class="keywordflow">return</span> old_data_space_; }
<a name="l00502"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a3054c1b31521fd219e9bac641e51ef93">00502</a>   <a class="code" href="classv8_1_1internal_1_1_old_space.html">OldSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3054c1b31521fd219e9bac641e51ef93">code_space</a>() { <span class="keywordflow">return</span> code_space_; }
<a name="l00503"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#af5b05ff7475a3b3aa0c69f1a81b10f8f">00503</a>   <a class="code" href="classv8_1_1internal_1_1_map_space.html">MapSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#af5b05ff7475a3b3aa0c69f1a81b10f8f">map_space</a>() { <span class="keywordflow">return</span> map_space_; }
<a name="l00504"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a65028ef47a53823e7e1666b70448e5f0">00504</a>   <a class="code" href="classv8_1_1internal_1_1_cell_space.html">CellSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a65028ef47a53823e7e1666b70448e5f0">cell_space</a>() { <span class="keywordflow">return</span> cell_space_; }
<a name="l00505"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a432feeeb72affcad98250366a4e4d2cd">00505</a>   <a class="code" href="classv8_1_1internal_1_1_large_object_space.html">LargeObjectSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a432feeeb72affcad98250366a4e4d2cd">lo_space</a>() { <span class="keywordflow">return</span> lo_space_; }
<a name="l00506"></a>00506 
<a name="l00507"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ad6ec033a38869520cb70b1a47ae2e25b">00507</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad6ec033a38869520cb70b1a47ae2e25b">always_allocate</a>() { <span class="keywordflow">return</span> always_allocate_scope_depth_ != 0; }
<a name="l00508"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ae2901251bdc9c6cb4738f8267d6f8c7a">00508</a>   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> <a class="code" href="classv8_1_1internal_1_1_heap.html#ae2901251bdc9c6cb4738f8267d6f8c7a">always_allocate_scope_depth_address</a>() {
<a name="l00509"></a>00509     <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a><span class="keyword">&gt;</span>(&amp;always_allocate_scope_depth_);
<a name="l00510"></a>00510   }
<a name="l00511"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a8f36f29fdd8caea29fe5eabe03a04245">00511</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a8f36f29fdd8caea29fe5eabe03a04245">linear_allocation</a>() {
<a name="l00512"></a>00512     <span class="keywordflow">return</span> linear_allocation_scope_depth_ != 0;
<a name="l00513"></a>00513   }
<a name="l00514"></a>00514 
<a name="l00515"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a3c6bc4955a8f4fbc6a480f77f5ff702a">00515</a>   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3c6bc4955a8f4fbc6a480f77f5ff702a">NewSpaceAllocationTopAddress</a>() {
<a name="l00516"></a>00516     <span class="keywordflow">return</span> new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#a76390e249756e491e6887b27718a31b6">allocation_top_address</a>();
<a name="l00517"></a>00517   }
<a name="l00518"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a39ddf64de374b93a01f2fadbed09bc20">00518</a>   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a39ddf64de374b93a01f2fadbed09bc20">NewSpaceAllocationLimitAddress</a>() {
<a name="l00519"></a>00519     <span class="keywordflow">return</span> new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#ab132e5fe993a4e1ade3bf1137dc655bb">allocation_limit_address</a>();
<a name="l00520"></a>00520   }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522   <span class="comment">// Uncommit unused semi space.</span>
<a name="l00523"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a04d450829451fa2312ec04e38bc04b5b">00523</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a04d450829451fa2312ec04e38bc04b5b">UncommitFromSpace</a>() { <span class="keywordflow">return</span> new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#aa96d85e9b611f7e6ab4f555ad63ab4d9">UncommitFromSpace</a>(); }
<a name="l00524"></a>00524 
<a name="l00525"></a>00525   <span class="comment">// Allocates and initializes a new JavaScript object based on a</span>
<a name="l00526"></a>00526   <span class="comment">// constructor.</span>
<a name="l00527"></a>00527   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00528"></a>00528   <span class="comment">// failed.</span>
<a name="l00529"></a>00529   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00530"></a>00530   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a143a298b81de2c2a93f92a5ec1e388ff">AllocateJSObject</a>(
<a name="l00531"></a>00531       <a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* constructor, <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00532"></a>00532 
<a name="l00533"></a>00533   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab6e341494efe512d6d33a801548e160a">AllocateJSModule</a>();
<a name="l00534"></a>00534 
<a name="l00535"></a>00535   <span class="comment">// Allocate a JSArray with no elements</span>
<a name="l00536"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ab0568fa2957772b6c03d1b0a3ea73e31">00536</a>   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab0568fa2957772b6c03d1b0a3ea73e31">AllocateEmptyJSArray</a>(
<a name="l00537"></a>00537       <a class="code" href="namespacev8_1_1internal.html#a63689e64c196a95ef58c92ea3134ce31">ElementsKind</a> elements_kind,
<a name="l00538"></a>00538       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>) {
<a name="l00539"></a>00539     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a1fbdf1395b9f882ba902904884843699">AllocateJSArrayAndStorage</a>(elements_kind, 0, 0,
<a name="l00540"></a>00540                                      <a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0beccacdaf8ca1a4da2a7507b667eee5b59a6b">DONT_INITIALIZE_ARRAY_ELEMENTS</a>,
<a name="l00541"></a>00541                                      pretenure);
<a name="l00542"></a>00542   }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544   <span class="comment">// Allocate a JSArray with a specified length but elements that are left</span>
<a name="l00545"></a>00545   <span class="comment">// uninitialized.</span>
<a name="l00546"></a>00546   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a1fbdf1395b9f882ba902904884843699">AllocateJSArrayAndStorage</a>(
<a name="l00547"></a>00547       <a class="code" href="namespacev8_1_1internal.html#a63689e64c196a95ef58c92ea3134ce31">ElementsKind</a> elements_kind,
<a name="l00548"></a>00548       <span class="keywordtype">int</span> length,
<a name="l00549"></a>00549       <span class="keywordtype">int</span> capacity,
<a name="l00550"></a>00550       <a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0becc">ArrayStorageAllocationMode</a> mode = <a class="code" href="namespacev8_1_1internal.html#af1db0bf4e61f50c222e1f23fd9e0beccacdaf8ca1a4da2a7507b667eee5b59a6b">DONT_INITIALIZE_ARRAY_ELEMENTS</a>,
<a name="l00551"></a>00551       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00552"></a>00552 
<a name="l00553"></a>00553   <span class="comment">// Allocate a JSArray with no elements</span>
<a name="l00554"></a>00554   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a51c5f7d4a52d05853d1da90cf1628c90">AllocateJSArrayWithElements</a>(
<a name="l00555"></a>00555       <a class="code" href="classv8_1_1internal_1_1_fixed_array_base.html">FixedArrayBase</a>* array_base,
<a name="l00556"></a>00556       <a class="code" href="namespacev8_1_1internal.html#a63689e64c196a95ef58c92ea3134ce31">ElementsKind</a> elements_kind,
<a name="l00557"></a>00557       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <span class="comment">// Allocates and initializes a new global object based on a constructor.</span>
<a name="l00560"></a>00560   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00561"></a>00561   <span class="comment">// failed.</span>
<a name="l00562"></a>00562   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00563"></a>00563   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab4899d3560955efbdddfd687d4db70fd">AllocateGlobalObject</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* constructor);
<a name="l00564"></a>00564 
<a name="l00565"></a>00565   <span class="comment">// Returns a deep copy of the JavaScript object.</span>
<a name="l00566"></a>00566   <span class="comment">// Properties and elements are copied too.</span>
<a name="l00567"></a>00567   <span class="comment">// Returns failure if allocation failed.</span>
<a name="l00568"></a>00568   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a875b7fc499892c982ddcd6acf73dd3fd">CopyJSObject</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_object.html">JSObject</a>* source);
<a name="l00569"></a>00569 
<a name="l00570"></a>00570   <span class="comment">// Allocates the function prototype.</span>
<a name="l00571"></a>00571   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00572"></a>00572   <span class="comment">// failed.</span>
<a name="l00573"></a>00573   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00574"></a>00574   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a75a9c636fe7fe77636ccc135c068849c">AllocateFunctionPrototype</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* <span class="keyword">function</span>);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576   <span class="comment">// Allocates a Harmony proxy or function proxy.</span>
<a name="l00577"></a>00577   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00578"></a>00578   <span class="comment">// failed.</span>
<a name="l00579"></a>00579   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00580"></a>00580   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3ef034a8f32daaa22e85ed4403c45185">AllocateJSProxy</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* handler,
<a name="l00581"></a>00581                                                <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* prototype);
<a name="l00582"></a>00582 
<a name="l00583"></a>00583   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8de824a72a0f6d09adb041e700585c67">AllocateJSFunctionProxy</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* handler,
<a name="l00584"></a>00584                                                        <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* call_trap,
<a name="l00585"></a>00585                                                        <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* construct_trap,
<a name="l00586"></a>00586                                                        <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* prototype);
<a name="l00587"></a>00587 
<a name="l00588"></a>00588   <span class="comment">// Reinitialize a JSReceiver into an (empty) JS object of respective type and</span>
<a name="l00589"></a>00589   <span class="comment">// size, but keeping the original prototype.  The receiver must have at least</span>
<a name="l00590"></a>00590   <span class="comment">// the size of the new object.  The object is reinitialized and behaves as an</span>
<a name="l00591"></a>00591   <span class="comment">// object that has been freshly allocated.</span>
<a name="l00592"></a>00592   <span class="comment">// Returns failure if an error occured, otherwise object.</span>
<a name="l00593"></a>00593   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a6e6395a1eba305fcba3caa0ffb916bb7">ReinitializeJSReceiver</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_receiver.html">JSReceiver</a>* <span class="keywordtype">object</span>,
<a name="l00594"></a>00594                                                       <a class="code" href="namespacev8_1_1internal.html#a62f89b8df648b3e45bce097100c2ab9b">InstanceType</a> <a class="code" href="namespacev8_1_1internal.html#af325044478c719d86be7dc7a017f250a">type</a>,
<a name="l00595"></a>00595                                                       <span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>);
<a name="l00596"></a>00596 
<a name="l00597"></a>00597   <span class="comment">// Reinitialize an JSGlobalProxy based on a constructor.  The object</span>
<a name="l00598"></a>00598   <span class="comment">// must have the same size as objects allocated using the</span>
<a name="l00599"></a>00599   <span class="comment">// constructor.  The object is reinitialized and behaves as an</span>
<a name="l00600"></a>00600   <span class="comment">// object that has been freshly allocated using the constructor.</span>
<a name="l00601"></a>00601   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ae0bbf689e420bb8580c108a5542ec931">ReinitializeJSGlobalProxy</a>(
<a name="l00602"></a>00602       <a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* constructor, <a class="code" href="classv8_1_1internal_1_1_j_s_global_proxy.html">JSGlobalProxy</a>* global);
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <span class="comment">// Allocates and initializes a new JavaScript object based on a map.</span>
<a name="l00605"></a>00605   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00606"></a>00606   <span class="comment">// failed.</span>
<a name="l00607"></a>00607   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00608"></a>00608   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab2bdefffdd6963579aaccece99da9faa">AllocateJSObjectFromMap</a>(
<a name="l00609"></a>00609       <a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map, <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611   <span class="comment">// Allocates a heap object based on the map.</span>
<a name="l00612"></a>00612   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00613"></a>00613   <span class="comment">// failed.</span>
<a name="l00614"></a>00614   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l00615"></a>00615   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3e8919206d2ae7c9f0effc238a3c19c2">Allocate</a>(<a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map, <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> space);
<a name="l00616"></a>00616 
<a name="l00617"></a>00617   <span class="comment">// Allocates a JS Map in the heap.</span>
<a name="l00618"></a>00618   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00619"></a>00619   <span class="comment">// failed.</span>
<a name="l00620"></a>00620   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l00621"></a>00621   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a772fe18303117cfb77672a76811a8739">AllocateMap</a>(
<a name="l00622"></a>00622       <a class="code" href="namespacev8_1_1internal.html#a62f89b8df648b3e45bce097100c2ab9b">InstanceType</a> instance_type,
<a name="l00623"></a>00623       <span class="keywordtype">int</span> instance_size,
<a name="l00624"></a>00624       <a class="code" href="namespacev8_1_1internal.html#a63689e64c196a95ef58c92ea3134ce31">ElementsKind</a> elements_kind = <a class="code" href="namespacev8_1_1internal.html#a63689e64c196a95ef58c92ea3134ce31a02e35be424bf2b17338a33a8a0786862">FAST_ELEMENTS</a>);
<a name="l00625"></a>00625 
<a name="l00626"></a>00626   <span class="comment">// Allocates a partial map for bootstrapping.</span>
<a name="l00627"></a>00627   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8cf79922477f4ec822729a71ab200ee6">AllocatePartialMap</a>(<a class="code" href="namespacev8_1_1internal.html#a62f89b8df648b3e45bce097100c2ab9b">InstanceType</a> instance_type,
<a name="l00628"></a>00628                                                   <span class="keywordtype">int</span> instance_size);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630   <span class="comment">// Allocate a map for the specified function</span>
<a name="l00631"></a>00631   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a2be1e890ea5d8aa8228d4ce0d5d372cb">AllocateInitialMap</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* fun);
<a name="l00632"></a>00632 
<a name="l00633"></a>00633   <span class="comment">// Allocates an empty code cache.</span>
<a name="l00634"></a>00634   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a409f33e3f560178d65a5d7e2236c8ce4">AllocateCodeCache</a>();
<a name="l00635"></a>00635 
<a name="l00636"></a>00636   <span class="comment">// Allocates a serialized scope info.</span>
<a name="l00637"></a>00637   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8e3f8b993c95cd2368f50e8ef27759fc">AllocateScopeInfo</a>(<span class="keywordtype">int</span> length);
<a name="l00638"></a>00638 
<a name="l00639"></a>00639   <span class="comment">// Allocates an empty PolymorphicCodeCache.</span>
<a name="l00640"></a>00640   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a60627fe4720dd3644e3290db4b34e576">AllocatePolymorphicCodeCache</a>();
<a name="l00641"></a>00641 
<a name="l00642"></a>00642   <span class="comment">// Allocates a pre-tenured empty AccessorPair.</span>
<a name="l00643"></a>00643   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a7f24f3c4a7e8870c928a251d61ff373d">AllocateAccessorPair</a>();
<a name="l00644"></a>00644 
<a name="l00645"></a>00645   <span class="comment">// Allocates an empty TypeFeedbackInfo.</span>
<a name="l00646"></a>00646   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ad999cdba23f52ed34c17b626ff965209">AllocateTypeFeedbackInfo</a>();
<a name="l00647"></a>00647 
<a name="l00648"></a>00648   <span class="comment">// Allocates an AliasedArgumentsEntry.</span>
<a name="l00649"></a>00649   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a6ec217c23a8048165101103e7c2b9598">AllocateAliasedArgumentsEntry</a>(<span class="keywordtype">int</span> slot);
<a name="l00650"></a>00650 
<a name="l00651"></a>00651   <span class="comment">// Clear the Instanceof cache (used when a prototype changes).</span>
<a name="l00652"></a>00652   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a469e15823f6b91b5531365c3ba5ba012">ClearInstanceofCache</a>();
<a name="l00653"></a>00653 
<a name="l00654"></a>00654   <span class="comment">// Allocates and fully initializes a String.  There are two String</span>
<a name="l00655"></a>00655   <span class="comment">// encodings: ASCII and two byte. One should choose between the three string</span>
<a name="l00656"></a>00656   <span class="comment">// allocation functions based on the encoding of the string buffer used to</span>
<a name="l00657"></a>00657   <span class="comment">// initialized the string.</span>
<a name="l00658"></a>00658   <span class="comment">//   - ...FromAscii initializes the string from a buffer that is ASCII</span>
<a name="l00659"></a>00659   <span class="comment">//     encoded (it does not check that the buffer is ASCII encoded) and the</span>
<a name="l00660"></a>00660   <span class="comment">//     result will be ASCII encoded.</span>
<a name="l00661"></a>00661   <span class="comment">//   - ...FromUTF8 initializes the string from a buffer that is UTF-8</span>
<a name="l00662"></a>00662   <span class="comment">//     encoded.  If the characters are all single-byte characters, the</span>
<a name="l00663"></a>00663   <span class="comment">//     result will be ASCII encoded, otherwise it will converted to two</span>
<a name="l00664"></a>00664   <span class="comment">//     byte.</span>
<a name="l00665"></a>00665   <span class="comment">//   - ...FromTwoByte initializes the string from a buffer that is two-byte</span>
<a name="l00666"></a>00666   <span class="comment">//     encoded.  If the characters are all single-byte characters, the</span>
<a name="l00667"></a>00667   <span class="comment">//     result will be converted to ASCII, otherwise it will be left as</span>
<a name="l00668"></a>00668   <span class="comment">//     two-byte.</span>
<a name="l00669"></a>00669   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00670"></a>00670   <span class="comment">// failed.</span>
<a name="l00671"></a>00671   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00672"></a>00672   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#aa3d33aecd2f331d624c61f7594a17c19">AllocateStringFromAscii</a>(
<a name="l00673"></a>00673       <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str,
<a name="l00674"></a>00674       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00675"></a>00675   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a351ed92ee09eebee99c05aef20221223">AllocateStringFromUtf8</a>(
<a name="l00676"></a>00676       <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str,
<a name="l00677"></a>00677       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00678"></a>00678   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a888f5b8f1b7ad78932180a4509431d71">AllocateStringFromUtf8Slow</a>(
<a name="l00679"></a>00679       <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str,
<a name="l00680"></a>00680       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00681"></a>00681   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ad008e3c768e71d94b67821eb3276f6fa">AllocateStringFromTwoByte</a>(
<a name="l00682"></a>00682       <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const uc16&gt;</a> str,
<a name="l00683"></a>00683       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00684"></a>00684 
<a name="l00685"></a>00685   <span class="comment">// Allocates a symbol in old space based on the character stream.</span>
<a name="l00686"></a>00686   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00687"></a>00687   <span class="comment">// failed.</span>
<a name="l00688"></a>00688   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l00689"></a>00689   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a1d053025269222e6c12d0af9891a1094">AllocateSymbol</a>(<a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str,
<a name="l00690"></a>00690                                                      <span class="keywordtype">int</span> chars,
<a name="l00691"></a>00691                                                      uint32_t hash_field);
<a name="l00692"></a>00692 
<a name="l00693"></a>00693   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8615b38d786355b301217f8225701e24">AllocateAsciiSymbol</a>(
<a name="l00694"></a>00694         <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str,
<a name="l00695"></a>00695         uint32_t hash_field);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8c1cfcab10e706cd9967ac0a5fa0036b">AllocateTwoByteSymbol</a>(
<a name="l00698"></a>00698         <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const uc16&gt;</a> str,
<a name="l00699"></a>00699         uint32_t hash_field);
<a name="l00700"></a>00700 
<a name="l00701"></a>00701   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#af153013f3baef2f5273b79b23db769ac">AllocateInternalSymbol</a>(
<a name="l00702"></a>00702       <a class="code" href="classunibrow_1_1_character_stream.html">unibrow::CharacterStream</a>* buffer, <span class="keywordtype">int</span> chars, uint32_t hash_field);
<a name="l00703"></a>00703 
<a name="l00704"></a>00704   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3a0bd48c7ab5c1dee0d44b71c84d2913">AllocateExternalSymbol</a>(
<a name="l00705"></a>00705       <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str,
<a name="l00706"></a>00706       <span class="keywordtype">int</span> chars);
<a name="l00707"></a>00707 
<a name="l00708"></a>00708   <span class="comment">// Allocates and partially initializes a String.  There are two String</span>
<a name="l00709"></a>00709   <span class="comment">// encodings: ASCII and two byte.  These functions allocate a string of the</span>
<a name="l00710"></a>00710   <span class="comment">// given length and set its map and length fields.  The characters of the</span>
<a name="l00711"></a>00711   <span class="comment">// string are uninitialized.</span>
<a name="l00712"></a>00712   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00713"></a>00713   <span class="comment">// failed.</span>
<a name="l00714"></a>00714   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00715"></a>00715   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a6c2cdc6616e98c570fd41bdb94ea6b8a">AllocateRawAsciiString</a>(
<a name="l00716"></a>00716       <span class="keywordtype">int</span> length,
<a name="l00717"></a>00717       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00718"></a>00718   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ad38a3cd66f4d7aa70d8a6915b0a438e7">AllocateRawTwoByteString</a>(
<a name="l00719"></a>00719       <span class="keywordtype">int</span> length,
<a name="l00720"></a>00720       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00721"></a>00721 
<a name="l00722"></a>00722   <span class="comment">// Computes a single character string where the character has code.</span>
<a name="l00723"></a>00723   <span class="comment">// A cache is used for ASCII codes.</span>
<a name="l00724"></a>00724   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00725"></a>00725   <span class="comment">// failed. Please note this does not perform a garbage collection.</span>
<a name="l00726"></a>00726   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ac1d44fe792a4d31bbc8bb1ca75e6dbf9">LookupSingleCharacterStringFromCode</a>(
<a name="l00727"></a>00727       <a class="code" href="namespaceunibrow.html#a1a9f000a71024f8d15d88a4fa57e1a18">uint16_t</a> <a class="code" href="namespacev8_1_1internal.html#a7500f5d92d93409e192a671bd4425496">code</a>);
<a name="l00728"></a>00728 
<a name="l00729"></a>00729   <span class="comment">// Allocate a byte array of the specified length</span>
<a name="l00730"></a>00730   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00731"></a>00731   <span class="comment">// failed.</span>
<a name="l00732"></a>00732   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00733"></a>00733   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a1ffb312a4bf1cdf649ec8d663cd9b213">AllocateByteArray</a>(<span class="keywordtype">int</span> length,
<a name="l00734"></a>00734                                                  <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure);
<a name="l00735"></a>00735 
<a name="l00736"></a>00736   <span class="comment">// Allocate a non-tenured byte array of the specified length</span>
<a name="l00737"></a>00737   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00738"></a>00738   <span class="comment">// failed.</span>
<a name="l00739"></a>00739   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00740"></a>00740   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a1ffb312a4bf1cdf649ec8d663cd9b213">AllocateByteArray</a>(<span class="keywordtype">int</span> length);
<a name="l00741"></a>00741 
<a name="l00742"></a>00742   <span class="comment">// Allocates an external array of the specified length and type.</span>
<a name="l00743"></a>00743   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00744"></a>00744   <span class="comment">// failed.</span>
<a name="l00745"></a>00745   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00746"></a>00746   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a452a230819680f61575690a2f99804b3">AllocateExternalArray</a>(
<a name="l00747"></a>00747       <span class="keywordtype">int</span> length,
<a name="l00748"></a>00748       <a class="code" href="namespacev8.html#aabbbc5430374565be119ff192a40544e">ExternalArrayType</a> array_type,
<a name="l00749"></a>00749       <span class="keywordtype">void</span>* external_pointer,
<a name="l00750"></a>00750       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure);
<a name="l00751"></a>00751 
<a name="l00752"></a>00752   <span class="comment">// Allocate a tenured JS global property cell.</span>
<a name="l00753"></a>00753   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00754"></a>00754   <span class="comment">// failed.</span>
<a name="l00755"></a>00755   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00756"></a>00756   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a0e3675bf698b0ec4b69992ed3e8af1a2">AllocateJSGlobalPropertyCell</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* value);
<a name="l00757"></a>00757 
<a name="l00758"></a>00758   <span class="comment">// Allocates a fixed array initialized with undefined values</span>
<a name="l00759"></a>00759   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00760"></a>00760   <span class="comment">// failed.</span>
<a name="l00761"></a>00761   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00762"></a>00762   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#aeb8fda72e8d22b95d51e02058261b503">AllocateFixedArray</a>(<span class="keywordtype">int</span> length,
<a name="l00763"></a>00763                                                   <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure);
<a name="l00764"></a>00764   <span class="comment">// Allocates a fixed array initialized with undefined values</span>
<a name="l00765"></a>00765   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#aeb8fda72e8d22b95d51e02058261b503">AllocateFixedArray</a>(<span class="keywordtype">int</span> length);
<a name="l00766"></a>00766 
<a name="l00767"></a>00767   <span class="comment">// Allocates an uninitialized fixed array. It must be filled by the caller.</span>
<a name="l00768"></a>00768   <span class="comment">//</span>
<a name="l00769"></a>00769   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00770"></a>00770   <span class="comment">// failed.</span>
<a name="l00771"></a>00771   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00772"></a>00772   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a9b5ac0a4a6b539f049868fc4516187ef">AllocateUninitializedFixedArray</a>(<span class="keywordtype">int</span> length);
<a name="l00773"></a>00773 
<a name="l00774"></a>00774   <span class="comment">// Make a copy of src and return it. Returns</span>
<a name="l00775"></a>00775   <span class="comment">// Failure::RetryAfterGC(requested_bytes, space) if the allocation failed.</span>
<a name="l00776"></a>00776   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#aff20ac001f2cb25ce2a762aee2a359b7">CopyFixedArray</a>(<a class="code" href="classv8_1_1internal_1_1_fixed_array.html">FixedArray</a>* src);
<a name="l00777"></a>00777 
<a name="l00778"></a>00778   <span class="comment">// Make a copy of src, set the map, and return the copy. Returns</span>
<a name="l00779"></a>00779   <span class="comment">// Failure::RetryAfterGC(requested_bytes, space) if the allocation failed.</span>
<a name="l00780"></a>00780   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a2810393e65369ffc3c5146982425e59e">CopyFixedArrayWithMap</a>(<a class="code" href="classv8_1_1internal_1_1_fixed_array.html">FixedArray</a>* src, <a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map);
<a name="l00781"></a>00781 
<a name="l00782"></a>00782   <span class="comment">// Make a copy of src and return it. Returns</span>
<a name="l00783"></a>00783   <span class="comment">// Failure::RetryAfterGC(requested_bytes, space) if the allocation failed.</span>
<a name="l00784"></a>00784   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a5960f943209f068207af54827d718d1b">CopyFixedDoubleArray</a>(
<a name="l00785"></a>00785       <a class="code" href="classv8_1_1internal_1_1_fixed_double_array.html">FixedDoubleArray</a>* src);
<a name="l00786"></a>00786 
<a name="l00787"></a>00787   <span class="comment">// Make a copy of src, set the map, and return the copy. Returns</span>
<a name="l00788"></a>00788   <span class="comment">// Failure::RetryAfterGC(requested_bytes, space) if the allocation failed.</span>
<a name="l00789"></a>00789   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#abeb4f8941d47edb0131494aa8e5b6399">CopyFixedDoubleArrayWithMap</a>(
<a name="l00790"></a>00790       <a class="code" href="classv8_1_1internal_1_1_fixed_double_array.html">FixedDoubleArray</a>* src, <a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map);
<a name="l00791"></a>00791 
<a name="l00792"></a>00792   <span class="comment">// Allocates a fixed array initialized with the hole values.</span>
<a name="l00793"></a>00793   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00794"></a>00794   <span class="comment">// failed.</span>
<a name="l00795"></a>00795   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00796"></a>00796   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#aca9081db7b3c81fd3b436309b5ebee3d">AllocateFixedArrayWithHoles</a>(
<a name="l00797"></a>00797       <span class="keywordtype">int</span> length,
<a name="l00798"></a>00798       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00799"></a>00799 
<a name="l00800"></a>00800   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a5b6a10c908d14c5097a10d63d28e4914">AllocateRawFixedDoubleArray</a>(
<a name="l00801"></a>00801       <span class="keywordtype">int</span> length,
<a name="l00802"></a>00802       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure);
<a name="l00803"></a>00803 
<a name="l00804"></a>00804   <span class="comment">// Allocates a fixed double array with uninitialized values. Returns</span>
<a name="l00805"></a>00805   <span class="comment">// Failure::RetryAfterGC(requested_bytes, space) if the allocation failed.</span>
<a name="l00806"></a>00806   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00807"></a>00807   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a1adc898271ec141eacfb4c02755d7ea0">AllocateUninitializedFixedDoubleArray</a>(
<a name="l00808"></a>00808       <span class="keywordtype">int</span> length,
<a name="l00809"></a>00809       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00810"></a>00810 
<a name="l00811"></a>00811   <span class="comment">// Allocates a fixed double array with hole values. Returns</span>
<a name="l00812"></a>00812   <span class="comment">// Failure::RetryAfterGC(requested_bytes, space) if the allocation failed.</span>
<a name="l00813"></a>00813   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00814"></a>00814   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a27f1e345227b9cb7f1b8efa9c755a8b6">AllocateFixedDoubleArrayWithHoles</a>(
<a name="l00815"></a>00815       <span class="keywordtype">int</span> length,
<a name="l00816"></a>00816       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00817"></a>00817 
<a name="l00818"></a>00818   <span class="comment">// AllocateHashTable is identical to AllocateFixedArray except</span>
<a name="l00819"></a>00819   <span class="comment">// that the resulting object has hash_table_map as map.</span>
<a name="l00820"></a>00820   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8309eaa6a96f3c0f59facdf0ee6ef2a9">AllocateHashTable</a>(
<a name="l00821"></a>00821       <span class="keywordtype">int</span> length, <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00822"></a>00822 
<a name="l00823"></a>00823   <span class="comment">// Allocate a global (but otherwise uninitialized) context.</span>
<a name="l00824"></a>00824   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a2fd20ed190355a6a09abca20264ec0dc">AllocateGlobalContext</a>();
<a name="l00825"></a>00825 
<a name="l00826"></a>00826   <span class="comment">// Allocate a module context.</span>
<a name="l00827"></a>00827   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a006dc08e73dff78c6040479fbf361260">AllocateModuleContext</a>(<a class="code" href="classv8_1_1internal_1_1_context.html">Context</a>* previous,
<a name="l00828"></a>00828                                                      <a class="code" href="classv8_1_1internal_1_1_scope_info.html">ScopeInfo</a>* scope_info);
<a name="l00829"></a>00829 
<a name="l00830"></a>00830   <span class="comment">// Allocate a function context.</span>
<a name="l00831"></a>00831   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab3e36e2ad65772e508d2f298da423029">AllocateFunctionContext</a>(<span class="keywordtype">int</span> length,
<a name="l00832"></a>00832                                                        <a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* <span class="keyword">function</span>);
<a name="l00833"></a>00833 
<a name="l00834"></a>00834   <span class="comment">// Allocate a catch context.</span>
<a name="l00835"></a>00835   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a39d4e23e2a390af0c22020a6cba9a80b">AllocateCatchContext</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* <span class="keyword">function</span>,
<a name="l00836"></a>00836                                                     <a class="code" href="classv8_1_1internal_1_1_context.html">Context</a>* previous,
<a name="l00837"></a>00837                                                     <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>,
<a name="l00838"></a>00838                                                     <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* thrown_object);
<a name="l00839"></a>00839   <span class="comment">// Allocate a &#39;with&#39; context.</span>
<a name="l00840"></a>00840   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ac6cd61abd89e109bce6638be568e043d">AllocateWithContext</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* <span class="keyword">function</span>,
<a name="l00841"></a>00841                                                    <a class="code" href="classv8_1_1internal_1_1_context.html">Context</a>* previous,
<a name="l00842"></a>00842                                                    <a class="code" href="classv8_1_1internal_1_1_j_s_object.html">JSObject</a>* extension);
<a name="l00843"></a>00843 
<a name="l00844"></a>00844   <span class="comment">// Allocate a block context.</span>
<a name="l00845"></a>00845   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a7e000d44db878d8424118de42bcf8dbb">AllocateBlockContext</a>(<a class="code" href="classv8_1_1internal_1_1_j_s_function.html">JSFunction</a>* <span class="keyword">function</span>,
<a name="l00846"></a>00846                                                     <a class="code" href="classv8_1_1internal_1_1_context.html">Context</a>* previous,
<a name="l00847"></a>00847                                                     <a class="code" href="classv8_1_1internal_1_1_scope_info.html">ScopeInfo</a>* info);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849   <span class="comment">// Allocates a new utility object in the old generation.</span>
<a name="l00850"></a>00850   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ac7cc2dfe72635a38503f47c90f1eb711">AllocateStruct</a>(<a class="code" href="namespacev8_1_1internal.html#a62f89b8df648b3e45bce097100c2ab9b">InstanceType</a> <a class="code" href="namespacev8_1_1internal.html#af325044478c719d86be7dc7a017f250a">type</a>);
<a name="l00851"></a>00851 
<a name="l00852"></a>00852   <span class="comment">// Allocates a function initialized with a shared part.</span>
<a name="l00853"></a>00853   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00854"></a>00854   <span class="comment">// failed.</span>
<a name="l00855"></a>00855   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00856"></a>00856   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a36257e75ecdf9cc839771c0a77abf90f">AllocateFunction</a>(
<a name="l00857"></a>00857       <a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* function_map,
<a name="l00858"></a>00858       <a class="code" href="classv8_1_1internal_1_1_shared_function_info.html">SharedFunctionInfo</a>* shared,
<a name="l00859"></a>00859       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* prototype,
<a name="l00860"></a>00860       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8a05bbe45f0768c4b85377537017b87bd7">TENURED</a>);
<a name="l00861"></a>00861 
<a name="l00862"></a>00862   <span class="comment">// Arguments object size.</span>
<a name="l00863"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a79fea4984f6a40ddcaf15e84c24408a4">00863</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a79fea4984f6a40ddcaf15e84c24408a4">kArgumentsObjectSize</a> =
<a name="l00864"></a>00864       <a class="code" href="classv8_1_1internal_1_1_j_s_object.html#a5ba6da4d81bc33d61cafa6a5b3f1e619">JSObject::kHeaderSize</a> + 2 * <a class="code" href="namespacev8_1_1internal.html#a023300bfff7e3bace1bbc934a501681c">kPointerSize</a>;
<a name="l00865"></a>00865   <span class="comment">// Strict mode arguments has no callee so it is smaller.</span>
<a name="l00866"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ac54fdf84a03b4d710d5c889cb8de5147">00866</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac54fdf84a03b4d710d5c889cb8de5147">kArgumentsObjectSizeStrict</a> =
<a name="l00867"></a>00867       <a class="code" href="classv8_1_1internal_1_1_j_s_object.html#a5ba6da4d81bc33d61cafa6a5b3f1e619">JSObject::kHeaderSize</a> + 1 * <a class="code" href="namespacev8_1_1internal.html#a023300bfff7e3bace1bbc934a501681c">kPointerSize</a>;
<a name="l00868"></a>00868   <span class="comment">// Indicies for direct access into argument objects.</span>
<a name="l00869"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ac83d5a1f910e4fa44dd5f76cf8c88a62">00869</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac83d5a1f910e4fa44dd5f76cf8c88a62">kArgumentsLengthIndex</a> = 0;
<a name="l00870"></a>00870   <span class="comment">// callee is only valid in non-strict mode.</span>
<a name="l00871"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a615fe73572c6d56a15e1133e577704ef">00871</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a615fe73572c6d56a15e1133e577704ef">kArgumentsCalleeIndex</a> = 1;
<a name="l00872"></a>00872 
<a name="l00873"></a>00873   <span class="comment">// Allocates an arguments object - optionally with an elements array.</span>
<a name="l00874"></a>00874   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00875"></a>00875   <span class="comment">// failed.</span>
<a name="l00876"></a>00876   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00877"></a>00877   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a06aa8e0b89f301a2092ef8031a31d05a">AllocateArgumentsObject</a>(
<a name="l00878"></a>00878       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* callee, <span class="keywordtype">int</span> length);
<a name="l00879"></a>00879 
<a name="l00880"></a>00880   <span class="comment">// Same as NewNumberFromDouble, but may return a preallocated/immutable</span>
<a name="l00881"></a>00881   <span class="comment">// number object (e.g., minus_zero_value_, nan_value_)</span>
<a name="l00882"></a>00882   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a7553d0ee1c03e62f2cb92f3fafff926f">NumberFromDouble</a>(
<a name="l00883"></a>00883       <span class="keywordtype">double</span> value, <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00884"></a>00884 
<a name="l00885"></a>00885   <span class="comment">// Allocated a HeapNumber from value.</span>
<a name="l00886"></a>00886   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a99391bf15d8a13858cf50eb344fdad9a">AllocateHeapNumber</a>(
<a name="l00887"></a>00887       <span class="keywordtype">double</span> value,
<a name="l00888"></a>00888       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure);
<a name="l00889"></a>00889   <span class="comment">// pretenure = NOT_TENURED</span>
<a name="l00890"></a>00890   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a99391bf15d8a13858cf50eb344fdad9a">AllocateHeapNumber</a>(<span class="keywordtype">double</span> value);
<a name="l00891"></a>00891 
<a name="l00892"></a>00892   <span class="comment">// Converts an int into either a Smi or a HeapNumber object.</span>
<a name="l00893"></a>00893   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00894"></a>00894   <span class="comment">// failed.</span>
<a name="l00895"></a>00895   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00896"></a>00896   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#aa7930a108ec600f9030138c88c4274de">NumberFromInt32</a>(
<a name="l00897"></a>00897       <a class="code" href="namespaceunibrow.html#a60d2324d08aaa746bbaaa291aca51448">int32_t</a> value, <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00898"></a>00898 
<a name="l00899"></a>00899   <span class="comment">// Converts an int into either a Smi or a HeapNumber object.</span>
<a name="l00900"></a>00900   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00901"></a>00901   <span class="comment">// failed.</span>
<a name="l00902"></a>00902   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00903"></a>00903   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a6f3c3b64bdbb977bbed7c93ec7d31a4c">NumberFromUint32</a>(
<a name="l00904"></a>00904       uint32_t value, <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00905"></a>00905 
<a name="l00906"></a>00906   <span class="comment">// Allocates a new foreign object.</span>
<a name="l00907"></a>00907   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00908"></a>00908   <span class="comment">// failed.</span>
<a name="l00909"></a>00909   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00910"></a>00910   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a53d3ed8c9eaa9bb41e180404e8a485be">AllocateForeign</a>(
<a name="l00911"></a>00911       <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> address, <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00912"></a>00912 
<a name="l00913"></a>00913   <span class="comment">// Allocates a new SharedFunctionInfo object.</span>
<a name="l00914"></a>00914   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00915"></a>00915   <span class="comment">// failed.</span>
<a name="l00916"></a>00916   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00917"></a>00917   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a0ca3367d8622b0cab93b4ee8670b93ab">AllocateSharedFunctionInfo</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919   <span class="comment">// Allocates a new JSMessageObject object.</span>
<a name="l00920"></a>00920   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00921"></a>00921   <span class="comment">// failed.</span>
<a name="l00922"></a>00922   <span class="comment">// Please note that this does not perform a garbage collection.</span>
<a name="l00923"></a>00923   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a9f87b279b586260d7c00ccc66e466dff">AllocateJSMessageObject</a>(
<a name="l00924"></a>00924       <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <a class="code" href="namespacev8_1_1internal.html#af325044478c719d86be7dc7a017f250a">type</a>,
<a name="l00925"></a>00925       <a class="code" href="classv8_1_1internal_1_1_j_s_array.html">JSArray</a>* arguments,
<a name="l00926"></a>00926       <span class="keywordtype">int</span> start_position,
<a name="l00927"></a>00927       <span class="keywordtype">int</span> end_position,
<a name="l00928"></a>00928       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* script,
<a name="l00929"></a>00929       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* stack_trace,
<a name="l00930"></a>00930       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* stack_frames);
<a name="l00931"></a>00931 
<a name="l00932"></a>00932   <span class="comment">// Allocates a new cons string object.</span>
<a name="l00933"></a>00933   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00934"></a>00934   <span class="comment">// failed.</span>
<a name="l00935"></a>00935   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00936"></a>00936   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a4fcc183aec571a833fd8b9626057bc2d">AllocateConsString</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* first,
<a name="l00937"></a>00937                                                   <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* second);
<a name="l00938"></a>00938 
<a name="l00939"></a>00939   <span class="comment">// Allocates a new sub string object which is a substring of an underlying</span>
<a name="l00940"></a>00940   <span class="comment">// string buffer stretching from the index start (inclusive) to the index</span>
<a name="l00941"></a>00941   <span class="comment">// end (exclusive).</span>
<a name="l00942"></a>00942   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00943"></a>00943   <span class="comment">// failed.</span>
<a name="l00944"></a>00944   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00945"></a>00945   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8e52867c83e03227323fa5292b882d8a">AllocateSubString</a>(
<a name="l00946"></a>00946       <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* buffer,
<a name="l00947"></a>00947       <span class="keywordtype">int</span> <a class="code" href="namespacell__prof.html#a5b7aee10eba26bc62f35b1049906c277">start</a>,
<a name="l00948"></a>00948       <span class="keywordtype">int</span> end,
<a name="l00949"></a>00949       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l00950"></a>00950 
<a name="l00951"></a>00951   <span class="comment">// Allocate a new external string object, which is backed by a string</span>
<a name="l00952"></a>00952   <span class="comment">// resource that resides outside the V8 heap.</span>
<a name="l00953"></a>00953   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00954"></a>00954   <span class="comment">// failed.</span>
<a name="l00955"></a>00955   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l00956"></a>00956   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3220f627ee74f53d0ffb1d2cb8762c2c">AllocateExternalStringFromAscii</a>(
<a name="l00957"></a>00957       <span class="keyword">const</span> <a class="code" href="classv8_1_1_string_1_1_external_ascii_string_resource.html">ExternalAsciiString::Resource</a>* resource);
<a name="l00958"></a>00958   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#abc8a2386014a2cab01c5e4b841d4284f">AllocateExternalStringFromTwoByte</a>(
<a name="l00959"></a>00959       <span class="keyword">const</span> <a class="code" href="classv8_1_1_string_1_1_external_string_resource.html">ExternalTwoByteString::Resource</a>* resource);
<a name="l00960"></a>00960 
<a name="l00961"></a>00961   <span class="comment">// Finalizes an external string by deleting the associated external</span>
<a name="l00962"></a>00962   <span class="comment">// data and clearing the resource pointer.</span>
<a name="l00963"></a>00963   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a5bf15011d272b2585b175fdab5e980fe">FinalizeExternalString</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <span class="keywordtype">string</span>);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965   <span class="comment">// Allocates an uninitialized object.  The memory is non-executable if the</span>
<a name="l00966"></a>00966   <span class="comment">// hardware and OS allow.</span>
<a name="l00967"></a>00967   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00968"></a>00968   <span class="comment">// failed.</span>
<a name="l00969"></a>00969   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l00970"></a>00970   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a8a918b659210b0a77e46765e9ca6b4a6">AllocateRaw</a>(<span class="keywordtype">int</span> size_in_bytes,
<a name="l00971"></a>00971                                                   <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> space,
<a name="l00972"></a>00972                                                   <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> retry_space);
<a name="l00973"></a>00973 
<a name="l00974"></a>00974   <span class="comment">// Initialize a filler object to keep the ability to iterate over the heap</span>
<a name="l00975"></a>00975   <span class="comment">// when shortening objects.</span>
<a name="l00976"></a>00976   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a66afd5824b6d99574e2fa90829f1883d">CreateFillerObjectAt</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> addr, <span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>);
<a name="l00977"></a>00977 
<a name="l00978"></a>00978   <span class="comment">// Makes a new native code object</span>
<a name="l00979"></a>00979   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l00980"></a>00980   <span class="comment">// failed. On success, the pointer to the Code object is stored in the</span>
<a name="l00981"></a>00981   <span class="comment">// self_reference. This allows generated code to reference its own Code</span>
<a name="l00982"></a>00982   <span class="comment">// object by containing this pointer.</span>
<a name="l00983"></a>00983   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l00984"></a>00984   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a56175d328f57e3642cb17b680037dba1">CreateCode</a>(<span class="keyword">const</span> <a class="code" href="structv8_1_1internal_1_1_code_desc.html">CodeDesc</a>&amp; desc,
<a name="l00985"></a>00985                                           <a class="code" href="classv8_1_1internal_1_1_code.html#a0bbeb0472b9eee1b2ffb9d03814e5110">Code::Flags</a> <a class="code" href="namespacev8_1_1internal.html#a9b4b1c68517c9a42918bc7079187ec70">flags</a>,
<a name="l00986"></a>00986                                           <a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;Object&gt;</a> self_reference,
<a name="l00987"></a>00987                                           <span class="keywordtype">bool</span> immovable = <span class="keyword">false</span>);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#afe5460a0779597462783e6aa0b197e99">CopyCode</a>(<a class="code" href="classv8_1_1internal_1_1_code.html">Code</a>* <a class="code" href="namespacev8_1_1internal.html#a7500f5d92d93409e192a671bd4425496">code</a>);
<a name="l00990"></a>00990 
<a name="l00991"></a>00991   <span class="comment">// Copy the code and scope info part of the code object, but insert</span>
<a name="l00992"></a>00992   <span class="comment">// the provided data as the relocation information.</span>
<a name="l00993"></a>00993   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#afe5460a0779597462783e6aa0b197e99">CopyCode</a>(<a class="code" href="classv8_1_1internal_1_1_code.html">Code</a>* <a class="code" href="namespacev8_1_1internal.html#a7500f5d92d93409e192a671bd4425496">code</a>, <a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;byte&gt;</a> reloc_info);
<a name="l00994"></a>00994 
<a name="l00995"></a>00995   <span class="comment">// Finds the symbol for string in the symbol table.</span>
<a name="l00996"></a>00996   <span class="comment">// If not found, a new symbol is added to the table and returned.</span>
<a name="l00997"></a>00997   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if allocation</span>
<a name="l00998"></a>00998   <span class="comment">// failed.</span>
<a name="l00999"></a>00999   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l01000"></a>01000   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a9bc9d319fa74b1e62de0468df0467c63">LookupSymbol</a>(<a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str);
<a name="l01001"></a>01001   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a76af2c9b9539681f4a33a3f19cec09b8">LookupAsciiSymbol</a>(<a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const char&gt;</a> str);
<a name="l01002"></a>01002   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3cba6552e94e948b1a30e7b411a0d192">LookupTwoByteSymbol</a>(<a class="code" href="classv8_1_1internal_1_1_vector.html">Vector&lt;const uc16&gt;</a> str);
<a name="l01003"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#abbb68fe977e9e3368c91deb6c1fb6d34">01003</a>   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#abbb68fe977e9e3368c91deb6c1fb6d34">LookupAsciiSymbol</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* str) {
<a name="l01004"></a>01004     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a9bc9d319fa74b1e62de0468df0467c63">LookupSymbol</a>(<a class="code" href="namespacev8_1_1internal.html#a00e8464566c15cbc97c5c8c850309df7">CStrVector</a>(str));
<a name="l01005"></a>01005   }
<a name="l01006"></a>01006   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a9bc9d319fa74b1e62de0468df0467c63">LookupSymbol</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* str);
<a name="l01007"></a>01007   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a76af2c9b9539681f4a33a3f19cec09b8">LookupAsciiSymbol</a>(<a class="code" href="classv8_1_1internal_1_1_handle.html">Handle&lt;SeqAsciiString&gt;</a> <span class="keywordtype">string</span>,
<a name="l01008"></a>01008                                                  <span class="keywordtype">int</span> from,
<a name="l01009"></a>01009                                                  <span class="keywordtype">int</span> length);
<a name="l01010"></a>01010 
<a name="l01011"></a>01011   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a66c0a2eaa636a7c857c00edf22f96c67">LookupSymbolIfExists</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* str, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>** symbol);
<a name="l01012"></a>01012   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a1916c8e305064682383183dc1fd033ae">LookupTwoCharsSymbolIfExists</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* str, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>** symbol);
<a name="l01013"></a>01013 
<a name="l01014"></a>01014   <span class="comment">// Compute the matching symbol map for a string if possible.</span>
<a name="l01015"></a>01015   <span class="comment">// NULL is returned if string is in new space or not flattened.</span>
<a name="l01016"></a>01016   <a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a58ce413b2335eef3ecfeeb4ece9a396e">SymbolMapForString</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* str);
<a name="l01017"></a>01017 
<a name="l01018"></a>01018   <span class="comment">// Tries to flatten a string before compare operation.</span>
<a name="l01019"></a>01019   <span class="comment">//</span>
<a name="l01020"></a>01020   <span class="comment">// Returns a failure in case it was decided that flattening was</span>
<a name="l01021"></a>01021   <span class="comment">// necessary and failed.  Note, if flattening is not necessary the</span>
<a name="l01022"></a>01022   <span class="comment">// string might stay non-flat even when not a failure is returned.</span>
<a name="l01023"></a>01023   <span class="comment">//</span>
<a name="l01024"></a>01024   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l01025"></a>01025   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#aa519cf2f9409a8936ee22d0633b173fb">PrepareForCompare</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* str);
<a name="l01026"></a>01026 
<a name="l01027"></a>01027   <span class="comment">// Converts the given boolean condition to JavaScript boolean value.</span>
<a name="l01028"></a>01028   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a6dad25be59dd58bc5c0e30362c9c95c2">ToBoolean</a>(<span class="keywordtype">bool</span> condition);
<a name="l01029"></a>01029 
<a name="l01030"></a>01030   <span class="comment">// Code that should be run before and after each GC.  Includes some</span>
<a name="l01031"></a>01031   <span class="comment">// reporting/verification activities when compiled with DEBUG set.</span>
<a name="l01032"></a>01032   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a62ef7f0b99fd142eed6d3ee4c894613d">GarbageCollectionPrologue</a>();
<a name="l01033"></a>01033   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a3fb53ca7fe502b725dffef370b406f45">GarbageCollectionEpilogue</a>();
<a name="l01034"></a>01034 
<a name="l01035"></a>01035   <span class="comment">// Performs garbage collection operation.</span>
<a name="l01036"></a>01036   <span class="comment">// Returns whether there is a chance that another major GC could</span>
<a name="l01037"></a>01037   <span class="comment">// collect more garbage.</span>
<a name="l01038"></a>01038   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a307e09de4a61a42e41983f7a4e387080">CollectGarbage</a>(<a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> space,
<a name="l01039"></a>01039                       <a class="code" href="namespacev8_1_1internal.html#ad504e70236bfcc0478d67053d1ed9ac0">GarbageCollector</a> collector,
<a name="l01040"></a>01040                       <span class="keyword">const</span> <span class="keywordtype">char</span>* gc_reason,
<a name="l01041"></a>01041                       <span class="keyword">const</span> <span class="keywordtype">char</span>* collector_reason);
<a name="l01042"></a>01042 
<a name="l01043"></a>01043   <span class="comment">// Performs garbage collection operation.</span>
<a name="l01044"></a>01044   <span class="comment">// Returns whether there is a chance that another major GC could</span>
<a name="l01045"></a>01045   <span class="comment">// collect more garbage.</span>
<a name="l01046"></a>01046   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a307e09de4a61a42e41983f7a4e387080">CollectGarbage</a>(<a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> space,
<a name="l01047"></a>01047                              <span class="keyword">const</span> <span class="keywordtype">char</span>* gc_reason = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>);
<a name="l01048"></a>01048 
<a name="l01049"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a961837df65c137b572023585c5c72191">01049</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a961837df65c137b572023585c5c72191">kNoGCFlags</a> = 0;
<a name="l01050"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ae909c6f870c69cf45437942bd77c99a0">01050</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ae909c6f870c69cf45437942bd77c99a0">kSweepPreciselyMask</a> = 1;
<a name="l01051"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a1792e93ed5d827373c21b9a99bc19c54">01051</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a1792e93ed5d827373c21b9a99bc19c54">kReduceMemoryFootprintMask</a> = 2;
<a name="l01052"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a70df0482b0c5f555696f1962656a0d38">01052</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a70df0482b0c5f555696f1962656a0d38">kAbortIncrementalMarkingMask</a> = 4;
<a name="l01053"></a>01053 
<a name="l01054"></a>01054   <span class="comment">// Making the heap iterable requires us to sweep precisely and abort any</span>
<a name="l01055"></a>01055   <span class="comment">// incremental marking as well.</span>
<a name="l01056"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a63d0cdfe1c567474e7351d642089eea1">01056</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a63d0cdfe1c567474e7351d642089eea1">kMakeHeapIterableMask</a> =
<a name="l01057"></a>01057       <a class="code" href="classv8_1_1internal_1_1_heap.html#ae909c6f870c69cf45437942bd77c99a0">kSweepPreciselyMask</a> | <a class="code" href="classv8_1_1internal_1_1_heap.html#a70df0482b0c5f555696f1962656a0d38">kAbortIncrementalMarkingMask</a>;
<a name="l01058"></a>01058 
<a name="l01059"></a>01059   <span class="comment">// Performs a full garbage collection.  If (flags &amp; kMakeHeapIterableMask) is</span>
<a name="l01060"></a>01060   <span class="comment">// non-zero, then the slower precise sweeper is used, which leaves the heap</span>
<a name="l01061"></a>01061   <span class="comment">// in a state where we can iterate over the heap visiting all objects.</span>
<a name="l01062"></a>01062   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a04c6030fef86da52bf561fa838f1cc4a">CollectAllGarbage</a>(<span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#a9b4b1c68517c9a42918bc7079187ec70">flags</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* gc_reason = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>);
<a name="l01063"></a>01063 
<a name="l01064"></a>01064   <span class="comment">// Last hope GC, should try to squeeze as much as possible.</span>
<a name="l01065"></a>01065   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#adcb7ec243bbb40bbe0739e3fb64b5427">CollectAllAvailableGarbage</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* gc_reason = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>);
<a name="l01066"></a>01066 
<a name="l01067"></a>01067   <span class="comment">// Check whether the heap is currently iterable.</span>
<a name="l01068"></a>01068   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a53b6f4fdb378f3a8db7eaf589235234b">IsHeapIterable</a>();
<a name="l01069"></a>01069 
<a name="l01070"></a>01070   <span class="comment">// Ensure that we have swept all spaces in such a way that we can iterate</span>
<a name="l01071"></a>01071   <span class="comment">// over all objects.  May cause a GC.</span>
<a name="l01072"></a>01072   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a2d4fa4eb4768d3f9b169826a97c9b7ac">EnsureHeapIsIterable</a>();
<a name="l01073"></a>01073 
<a name="l01074"></a>01074   <span class="comment">// Notify the heap that a context has been disposed.</span>
<a name="l01075"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#af52425d4a7642850a7289f11159e793a">01075</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#af52425d4a7642850a7289f11159e793a">NotifyContextDisposed</a>() { <span class="keywordflow">return</span> ++contexts_disposed_; }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077   <span class="comment">// Utility to invoke the scavenger. This is needed in test code to</span>
<a name="l01078"></a>01078   <span class="comment">// ensure correct callback for weak global handles.</span>
<a name="l01079"></a>01079   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a819484314fa6d49353668b01a2046198">PerformScavenge</a>();
<a name="l01080"></a>01080 
<a name="l01081"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a7befb47bf130b1937ad73d759ad17c5d">01081</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a7befb47bf130b1937ad73d759ad17c5d">increment_scan_on_scavenge_pages</a>() {
<a name="l01082"></a>01082     scan_on_scavenge_pages_++;
<a name="l01083"></a>01083     <span class="keywordflow">if</span> (FLAG_gc_verbose) {
<a name="l01084"></a>01084       <a class="code" href="namespacev8_1_1internal.html#a983357dee691fc08ce75ee9b0c132ca7">PrintF</a>(<span class="stringliteral">&quot;Scan-on-scavenge pages: %d\n&quot;</span>, scan_on_scavenge_pages_);
<a name="l01085"></a>01085     }
<a name="l01086"></a>01086   }
<a name="l01087"></a>01087 
<a name="l01088"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#adfe1eb5f1475acd36c65e27d77a447d9">01088</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#adfe1eb5f1475acd36c65e27d77a447d9">decrement_scan_on_scavenge_pages</a>() {
<a name="l01089"></a>01089     scan_on_scavenge_pages_--;
<a name="l01090"></a>01090     <span class="keywordflow">if</span> (FLAG_gc_verbose) {
<a name="l01091"></a>01091       <a class="code" href="namespacev8_1_1internal.html#a983357dee691fc08ce75ee9b0c132ca7">PrintF</a>(<span class="stringliteral">&quot;Scan-on-scavenge pages: %d\n&quot;</span>, scan_on_scavenge_pages_);
<a name="l01092"></a>01092     }
<a name="l01093"></a>01093   }
<a name="l01094"></a>01094 
<a name="l01095"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a5542984f4d7809b2622685bad7138d1a">01095</a>   <a class="code" href="classv8_1_1internal_1_1_promotion_queue.html">PromotionQueue</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a5542984f4d7809b2622685bad7138d1a">promotion_queue</a>() { <span class="keywordflow">return</span> &amp;promotion_queue_; }
<a name="l01096"></a>01096 
<a name="l01097"></a>01097 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01098"></a>01098 <span class="preprocessor"></span>  <span class="comment">// Utility used with flag gc-greedy.</span>
<a name="l01099"></a>01099   <span class="keywordtype">void</span> GarbageCollectionGreedyCheck();
<a name="l01100"></a>01100 <span class="preprocessor">#endif</span>
<a name="l01101"></a>01101 <span class="preprocessor"></span>
<a name="l01102"></a>01102   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a2f36d2d1220dc5f20097fcfef762e6da">AddGCPrologueCallback</a>(
<a name="l01103"></a>01103       <a class="code" href="namespacev8.html#a220aa1e29ecc75f460d8dbd765b66435">GCEpilogueCallback</a> callback, <a class="code" href="namespacev8.html#ac109d6f27e0c0f9ef4e98bcf7a806cf2">GCType</a> gc_type_filter);
<a name="l01104"></a>01104   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a07716035f23b9ae781e4afa0b221e224">RemoveGCPrologueCallback</a>(<a class="code" href="namespacev8.html#a220aa1e29ecc75f460d8dbd765b66435">GCEpilogueCallback</a> callback);
<a name="l01105"></a>01105 
<a name="l01106"></a>01106   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a34600426f3152e95153bd3fbafb87c66">AddGCEpilogueCallback</a>(
<a name="l01107"></a>01107       <a class="code" href="namespacev8.html#a220aa1e29ecc75f460d8dbd765b66435">GCEpilogueCallback</a> callback, <a class="code" href="namespacev8.html#ac109d6f27e0c0f9ef4e98bcf7a806cf2">GCType</a> gc_type_filter);
<a name="l01108"></a>01108   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a00824f2aa3a8af1eb6dbe7d88892e7f4">RemoveGCEpilogueCallback</a>(<a class="code" href="namespacev8.html#a220aa1e29ecc75f460d8dbd765b66435">GCEpilogueCallback</a> callback);
<a name="l01109"></a>01109 
<a name="l01110"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a2a712785f3388d69f82a57460b23c2d1">01110</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a2a712785f3388d69f82a57460b23c2d1">SetGlobalGCPrologueCallback</a>(<a class="code" href="namespacev8.html#a0559691fb5494dd5a54c5e4d3e3d1388">GCCallback</a> callback) {
<a name="l01111"></a>01111     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>((callback == <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>) ^ (global_gc_prologue_callback_ == <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>));
<a name="l01112"></a>01112     global_gc_prologue_callback_ = callback;
<a name="l01113"></a>01113   }
<a name="l01114"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ab49100c1f12e358ce936d7ce071ba98a">01114</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ab49100c1f12e358ce936d7ce071ba98a">SetGlobalGCEpilogueCallback</a>(<a class="code" href="namespacev8.html#a0559691fb5494dd5a54c5e4d3e3d1388">GCCallback</a> callback) {
<a name="l01115"></a>01115     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>((callback == <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>) ^ (global_gc_epilogue_callback_ == <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>));
<a name="l01116"></a>01116     global_gc_epilogue_callback_ = callback;
<a name="l01117"></a>01117   }
<a name="l01118"></a>01118 
<a name="l01119"></a>01119   <span class="comment">// Heap root getters.  We have versions with and without type::cast() here.</span>
<a name="l01120"></a>01120   <span class="comment">// You can&#39;t use type::cast during GC because the assert fails.</span>
<a name="l01121"></a>01121   <span class="comment">// TODO(1490): Try removing the unchecked accessors, now that GC marking does</span>
<a name="l01122"></a>01122   <span class="comment">// not corrupt the map.</span>
<a name="l01123"></a>01123 <span class="preprocessor">#define ROOT_ACCESSOR(type, name, camel_name)                                  \</span>
<a name="l01124"></a>01124 <span class="preprocessor">  type* name() {                                                               \</span>
<a name="l01125"></a>01125 <span class="preprocessor">    return type::cast(roots_[k##camel_name##RootIndex]);                       \</span>
<a name="l01126"></a>01126 <span class="preprocessor">  }                                                                            \</span>
<a name="l01127"></a>01127 <span class="preprocessor">  type* raw_unchecked_##name() {                                               \</span>
<a name="l01128"></a>01128 <span class="preprocessor">    return reinterpret_cast&lt;type*&gt;(roots_[k##camel_name##RootIndex]);          \</span>
<a name="l01129"></a>01129 <span class="preprocessor">  }</span>
<a name="l01130"></a>01130 <span class="preprocessor"></span>  <a class="code" href="heap_8h.html#a6f2cf89f87e025582097c2febe7ca152">ROOT_LIST</a>(<a class="code" href="factory_8h.html#aff3bfca7c03595f1ad4582783ef7ebd4">ROOT_ACCESSOR</a>)
<a name="l01131"></a>01131 <span class="preprocessor">#undef ROOT_ACCESSOR</span>
<a name="l01132"></a>01132 <span class="preprocessor"></span>
<a name="l01133"></a>01133 <span class="comment">// Utility type maps</span>
<a name="l01134"></a><a class="code" href="heap_8h.html#a6efe63992da48156ea15ec82330a9653">01134</a> <span class="preprocessor">#define STRUCT_MAP_ACCESSOR(NAME, Name, name)                                  \</span>
<a name="l01135"></a>01135 <span class="preprocessor">    Map* name##_map() {                                                        \</span>
<a name="l01136"></a>01136 <span class="preprocessor">      return Map::cast(roots_[k##Name##MapRootIndex]);                         \</span>
<a name="l01137"></a>01137 <span class="preprocessor">    }</span>
<a name="l01138"></a>01138 <span class="preprocessor"></span>  <a class="code" href="objects_8h.html#a3b5399155f391d070485d8310f9d2e95">STRUCT_LIST</a>(<a class="code" href="heap_8h.html#a6efe63992da48156ea15ec82330a9653">STRUCT_MAP_ACCESSOR</a>)
<a name="l01139"></a>01139 <span class="preprocessor">#undef STRUCT_MAP_ACCESSOR</span>
<a name="l01140"></a>01140 <span class="preprocessor"></span>
<a name="l01141"></a><a class="code" href="heap_8h.html#a1dff87d3e939d223b7c8889b98bf6851">01141</a> <span class="preprocessor">#define SYMBOL_ACCESSOR(name, str) String* name() {                            \</span>
<a name="l01142"></a>01142 <span class="preprocessor">    return String::cast(roots_[k##name##RootIndex]);                           \</span>
<a name="l01143"></a>01143 <span class="preprocessor">  }</span>
<a name="l01144"></a>01144 <span class="preprocessor"></span>  <a class="code" href="heap_8h.html#a5fc83e0f16e7ddf38e053f8537c39727">SYMBOL_LIST</a>(<a class="code" href="heap_8h.html#a1dff87d3e939d223b7c8889b98bf6851">SYMBOL_ACCESSOR</a>)
<a name="l01145"></a>01145 <span class="preprocessor">#undef SYMBOL_ACCESSOR</span>
<a name="l01146"></a>01146 <span class="preprocessor"></span>
<a name="l01147"></a>01147   <span class="comment">// The hidden_symbol is special because it is the empty string, but does</span>
<a name="l01148"></a>01148   <span class="comment">// not match the empty string.</span>
<a name="l01149"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a148dff93aadbd7da05a1480888e1cdd6">01149</a>   <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a148dff93aadbd7da05a1480888e1cdd6">hidden_symbol</a>() { <span class="keywordflow">return</span> hidden_symbol_; }
<a name="l01150"></a>01150 
<a name="l01151"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ad31be645bb06a80d1df844bdaca8f341">01151</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad31be645bb06a80d1df844bdaca8f341">set_global_contexts_list</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <span class="keywordtype">object</span>) {
<a name="l01152"></a>01152     global_contexts_list_ = object;
<a name="l01153"></a>01153   }
<a name="l01154"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a2a79ec25cbb04375765f1f673d9a76d4">01154</a>   <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a2a79ec25cbb04375765f1f673d9a76d4">global_contexts_list</a>() { <span class="keywordflow">return</span> global_contexts_list_; }
<a name="l01155"></a>01155 
<a name="l01156"></a>01156   <span class="comment">// Number of mark-sweeps.</span>
<a name="l01157"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a27ad8dd48471052e4aed86d492dce60a">01157</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a27ad8dd48471052e4aed86d492dce60a">ms_count</a>() { <span class="keywordflow">return</span> ms_count_; }
<a name="l01158"></a>01158 
<a name="l01159"></a>01159   <span class="comment">// Iterates over all roots in the heap.</span>
<a name="l01160"></a>01160   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a0c0159dc65d663c4c79b02183a8835dc">IterateRoots</a>(ObjectVisitor* v, <a class="code" href="namespacev8_1_1internal.html#a2b671904b8f0256e109c272a136d2a21">VisitMode</a> mode);
<a name="l01161"></a>01161   <span class="comment">// Iterates over all strong roots in the heap.</span>
<a name="l01162"></a>01162   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aafc6ce4d8872af22f6e4e1a7c89bb4c9">IterateStrongRoots</a>(ObjectVisitor* v, <a class="code" href="namespacev8_1_1internal.html#a2b671904b8f0256e109c272a136d2a21">VisitMode</a> mode);
<a name="l01163"></a>01163   <span class="comment">// Iterates over all the other roots in the heap.</span>
<a name="l01164"></a>01164   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a8bc600aa3fb757754e444ce111eae01d">IterateWeakRoots</a>(ObjectVisitor* v, <a class="code" href="namespacev8_1_1internal.html#a2b671904b8f0256e109c272a136d2a21">VisitMode</a> mode);
<a name="l01165"></a>01165 
<a name="l01166"></a>01166   <span class="comment">// Iterate pointers to from semispace of new space found in memory interval</span>
<a name="l01167"></a>01167   <span class="comment">// from start to end.</span>
<a name="l01168"></a>01168   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ab0816e579321d82ce0fea12403577611">IterateAndMarkPointersToFromSpace</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> <a class="code" href="namespacell__prof.html#a5b7aee10eba26bc62f35b1049906c277">start</a>,
<a name="l01169"></a>01169                                          <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> end,
<a name="l01170"></a>01170                                          <a class="code" href="namespacev8_1_1internal.html#a250a51ba018c5d93a2963ce0bedd4482">ObjectSlotCallback</a> callback);
<a name="l01171"></a>01171 
<a name="l01172"></a>01172   <span class="comment">// Returns whether the object resides in new space.</span>
<a name="l01173"></a>01173   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a5df71fbdc66bbad55e982a8949493b40">InNewSpace</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <span class="keywordtype">object</span>);
<a name="l01174"></a>01174   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a5df71fbdc66bbad55e982a8949493b40">InNewSpace</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> addr);
<a name="l01175"></a>01175   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a1d3ce2faa5353c3e99831ec98f66c692">InNewSpacePage</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> addr);
<a name="l01176"></a>01176   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a9f817ee001688038f88a45fa679b1b0a">InFromSpace</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <span class="keywordtype">object</span>);
<a name="l01177"></a>01177   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ae7f2e59a03a9b8435a7e3eb830d2880b">InToSpace</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <span class="keywordtype">object</span>);
<a name="l01178"></a>01178 
<a name="l01179"></a>01179   <span class="comment">// Checks whether an address/object in the heap (including auxiliary</span>
<a name="l01180"></a>01180   <span class="comment">// area and unused area).</span>
<a name="l01181"></a>01181   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a062947194d43e2f8853c72029d153515">Contains</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> addr);
<a name="l01182"></a>01182   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a062947194d43e2f8853c72029d153515">Contains</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* value);
<a name="l01183"></a>01183 
<a name="l01184"></a>01184   <span class="comment">// Checks whether an address/object in a space.</span>
<a name="l01185"></a>01185   <span class="comment">// Currently used by tests, serialization and heap verification only.</span>
<a name="l01186"></a>01186   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#afb534071006b8115662970ab91d73209">InSpace</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> addr, <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> space);
<a name="l01187"></a>01187   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#afb534071006b8115662970ab91d73209">InSpace</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* value, <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> space);
<a name="l01188"></a>01188 
<a name="l01189"></a>01189   <span class="comment">// Finds out which space an object should get promoted to based on its type.</span>
<a name="l01190"></a>01190   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_old_space.html">OldSpace</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a116ec06c36633d03c55e00649f98a18d">TargetSpace</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* <span class="keywordtype">object</span>);
<a name="l01191"></a>01191   <span class="keyword">inline</span> <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> <a class="code" href="classv8_1_1internal_1_1_heap.html#aafc0018ff36bef7b2d295eecc4190b59">TargetSpaceId</a>(<a class="code" href="namespacev8_1_1internal.html#a62f89b8df648b3e45bce097100c2ab9b">InstanceType</a> <a class="code" href="namespacev8_1_1internal.html#af325044478c719d86be7dc7a017f250a">type</a>);
<a name="l01192"></a>01192 
<a name="l01193"></a>01193   <span class="comment">// Sets the stub_cache_ (only used when expanding the dictionary).</span>
<a name="l01194"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a66e16d1df23988395555dbc680b7f897">01194</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a66e16d1df23988395555dbc680b7f897">public_set_code_stubs</a>(<a class="code" href="classv8_1_1internal_1_1_unseeded_number_dictionary.html">UnseededNumberDictionary</a>* value) {
<a name="l01195"></a>01195     roots_[kCodeStubsRootIndex] = value;
<a name="l01196"></a>01196   }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198   <span class="comment">// Support for computing object sizes for old objects during GCs. Returns</span>
<a name="l01199"></a>01199   <span class="comment">// a function that is guaranteed to be safe for computing object sizes in</span>
<a name="l01200"></a>01200   <span class="comment">// the current GC phase.</span>
<a name="l01201"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a682e01c9d0f48723eee2861d5ea1d71d">01201</a>   <a class="code" href="namespacev8_1_1internal.html#a4664a14735f154f774c9130702904468">HeapObjectCallback</a> <a class="code" href="classv8_1_1internal_1_1_heap.html#a682e01c9d0f48723eee2861d5ea1d71d">GcSafeSizeOfOldObjectFunction</a>() {
<a name="l01202"></a>01202     <span class="keywordflow">return</span> gc_safe_size_of_old_object_;
<a name="l01203"></a>01203   }
<a name="l01204"></a>01204 
<a name="l01205"></a>01205   <span class="comment">// Sets the non_monomorphic_cache_ (only used when expanding the dictionary).</span>
<a name="l01206"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a4e5e9d95f1602becd3a358486b027ca9">01206</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a4e5e9d95f1602becd3a358486b027ca9">public_set_non_monomorphic_cache</a>(<a class="code" href="classv8_1_1internal_1_1_unseeded_number_dictionary.html">UnseededNumberDictionary</a>* value) {
<a name="l01207"></a>01207     roots_[kNonMonomorphicCacheRootIndex] = value;
<a name="l01208"></a>01208   }
<a name="l01209"></a>01209 
<a name="l01210"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aee351372b7d75b8debf22f52a4d0e6fc">01210</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aee351372b7d75b8debf22f52a4d0e6fc">public_set_empty_script</a>(<a class="code" href="classv8_1_1internal_1_1_script.html">Script</a>* script) {
<a name="l01211"></a>01211     roots_[kEmptyScriptRootIndex] = script;
<a name="l01212"></a>01212   }
<a name="l01213"></a>01213 
<a name="l01214"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a4ed7b33486eda837161cce7fa2e48caa">01214</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a4ed7b33486eda837161cce7fa2e48caa">public_set_store_buffer_top</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a>* top) {
<a name="l01215"></a>01215     roots_[kStoreBufferTopRootIndex] = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classv8_1_1internal_1_1_smi.html">Smi</a>*<span class="keyword">&gt;</span>(top);
<a name="l01216"></a>01216   }
<a name="l01217"></a>01217 
<a name="l01218"></a>01218   <span class="comment">// Update the next script id.</span>
<a name="l01219"></a>01219   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#acec085e26690e35f73ea74f19f6c44b2">SetLastScriptId</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* last_script_id);
<a name="l01220"></a>01220 
<a name="l01221"></a>01221   <span class="comment">// Generated code can embed this address to get access to the roots.</span>
<a name="l01222"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a72711cd12c0d359ed1f17cd63435b7a5">01222</a>   <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>** <a class="code" href="classv8_1_1internal_1_1_heap.html#a72711cd12c0d359ed1f17cd63435b7a5">roots_array_start</a>() { <span class="keywordflow">return</span> roots_; }
<a name="l01223"></a>01223 
<a name="l01224"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a0f3b4a2969d0d3b408ebe19f0e6226d9">01224</a>   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a0f3b4a2969d0d3b408ebe19f0e6226d9">store_buffer_top_address</a>() {
<a name="l01225"></a>01225     <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a>*<span class="keyword">&gt;</span>(&amp;roots_[kStoreBufferTopRootIndex]);
<a name="l01226"></a>01226   }
<a name="l01227"></a>01227 
<a name="l01228"></a>01228   <span class="comment">// Get address of global contexts list for serialization support.</span>
<a name="l01229"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aa2f7b996e9c4dbad250db18422d2babb">01229</a>   <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>** <a class="code" href="classv8_1_1internal_1_1_heap.html#aa2f7b996e9c4dbad250db18422d2babb">global_contexts_list_address</a>() {
<a name="l01230"></a>01230     <span class="keywordflow">return</span> &amp;global_contexts_list_;
<a name="l01231"></a>01231   }
<a name="l01232"></a>01232 
<a name="l01233"></a>01233 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01234"></a>01234 <span class="preprocessor"></span>  <span class="keywordtype">void</span> <a class="code" href="lineprocessor_8cc.html#ae894408d53a5dd2fec4c3e7ea09d5d4b">Print</a>();
<a name="l01235"></a>01235   <span class="keywordtype">void</span> PrintHandles();
<a name="l01236"></a>01236 
<a name="l01237"></a>01237   <span class="comment">// Verify the heap is in its normal state before or after a GC.</span>
<a name="l01238"></a>01238   <span class="keywordtype">void</span> Verify();
<a name="l01239"></a>01239 
<a name="l01240"></a>01240   <span class="comment">// Verify that AccessorPairs are not shared, i.e. make sure that they have</span>
<a name="l01241"></a>01241   <span class="comment">// exactly one pointer to them.</span>
<a name="l01242"></a>01242   <span class="keywordtype">void</span> VerifyNoAccessorPairSharing();
<a name="l01243"></a>01243 
<a name="l01244"></a>01244   <span class="keywordtype">void</span> OldPointerSpaceCheckStoreBuffer();
<a name="l01245"></a>01245   <span class="keywordtype">void</span> MapSpaceCheckStoreBuffer();
<a name="l01246"></a>01246   <span class="keywordtype">void</span> LargeObjectSpaceCheckStoreBuffer();
<a name="l01247"></a>01247 
<a name="l01248"></a>01248   <span class="comment">// Report heap statistics.</span>
<a name="l01249"></a>01249   <span class="keywordtype">void</span> ReportHeapStatistics(<span class="keyword">const</span> <span class="keywordtype">char</span>* title);
<a name="l01250"></a>01250   <span class="keywordtype">void</span> ReportCodeStatistics(<span class="keyword">const</span> <span class="keywordtype">char</span>* title);
<a name="l01251"></a>01251 
<a name="l01252"></a>01252   <span class="comment">// Fill in bogus values in from space</span>
<a name="l01253"></a>01253   <span class="keywordtype">void</span> ZapFromSpace();
<a name="l01254"></a>01254 <span class="preprocessor">#endif</span>
<a name="l01255"></a>01255 <span class="preprocessor"></span>
<a name="l01256"></a>01256   <span class="comment">// Print short heap statistics.</span>
<a name="l01257"></a>01257   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#abc8708f833d8dee1ed93051d3fb4690e">PrintShortHeapStatistics</a>();
<a name="l01258"></a>01258 
<a name="l01259"></a>01259   <span class="comment">// Makes a new symbol object</span>
<a name="l01260"></a>01260   <span class="comment">// Returns Failure::RetryAfterGC(requested_bytes, space) if the allocation</span>
<a name="l01261"></a>01261   <span class="comment">// failed.</span>
<a name="l01262"></a>01262   <span class="comment">// Please note this function does not perform a garbage collection.</span>
<a name="l01263"></a>01263   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a57d592c077f931d4f31dda4a591604d8">CreateSymbol</a>(
<a name="l01264"></a>01264       <span class="keyword">const</span> <span class="keywordtype">char</span>* str, <span class="keywordtype">int</span> length, <span class="keywordtype">int</span> hash);
<a name="l01265"></a>01265   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a57d592c077f931d4f31dda4a591604d8">CreateSymbol</a>(<a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* str);
<a name="l01266"></a>01266 
<a name="l01267"></a>01267   <span class="comment">// Write barrier support for address[offset] = o.</span>
<a name="l01268"></a>01268   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a7ef55e5867208ff4a3a7104261e05497">RecordWrite</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> address, <span class="keywordtype">int</span> offset);
<a name="l01269"></a>01269 
<a name="l01270"></a>01270   <span class="comment">// Write barrier support for address[start : start + len[ = o.</span>
<a name="l01271"></a>01271   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a9476bffa0b661cf34ef0ceb42470be19">RecordWrites</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> address, <span class="keywordtype">int</span> <a class="code" href="namespacell__prof.html#a5b7aee10eba26bc62f35b1049906c277">start</a>, <span class="keywordtype">int</span> len);
<a name="l01272"></a>01272 
<a name="l01273"></a>01273   <span class="comment">// Given an address occupied by a live code object, return that object.</span>
<a name="l01274"></a>01274   <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab2f4a28180811dcfbfe32c80c96bb19e">FindCodeObject</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> a);
<a name="l01275"></a>01275 
<a name="l01276"></a>01276   <span class="comment">// Invoke Shrink on shrinkable spaces.</span>
<a name="l01277"></a>01277   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a259be849abf49f4713304d096e615085">Shrink</a>();
<a name="l01278"></a>01278 
<a name="l01279"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aee3f8b2c700602c6e8546212a2ac0f65a7905fa4947d6e8f861baa5718d79c1ac">01279</a>   <span class="keyword">enum</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aee3f8b2c700602c6e8546212a2ac0f65">HeapState</a> { <a class="code" href="classv8_1_1internal_1_1_heap.html#aee3f8b2c700602c6e8546212a2ac0f65a3d9a5665b3549e9c13e86d836d6fe98f">NOT_IN_GC</a>, <a class="code" href="classv8_1_1internal_1_1_heap.html#aee3f8b2c700602c6e8546212a2ac0f65a7905fa4947d6e8f861baa5718d79c1ac">SCAVENGE</a>, <a class="code" href="classv8_1_1internal_1_1_heap.html#aee3f8b2c700602c6e8546212a2ac0f65a5ec79940bd3c314a7e20c8c9fcf69b61">MARK_COMPACT</a> };
<a name="l01280"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a0d9f57dc1f21bd86c17a7abf1766ccd4">01280</a>   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aee3f8b2c700602c6e8546212a2ac0f65">HeapState</a> <a class="code" href="classv8_1_1internal_1_1_heap.html#a0d9f57dc1f21bd86c17a7abf1766ccd4">gc_state</a>() { <span class="keywordflow">return</span> gc_state_; }
<a name="l01281"></a>01281 
<a name="l01282"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aa6bdb0010eb8a30010560de3fe7e18f8">01282</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aa6bdb0010eb8a30010560de3fe7e18f8">IsInGCPostProcessing</a>() { <span class="keywordflow">return</span> gc_post_processing_depth_ &gt; 0; }
<a name="l01283"></a>01283 
<a name="l01284"></a>01284 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01285"></a>01285 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> IsAllocationAllowed() { <span class="keywordflow">return</span> allocation_allowed_; }
<a name="l01286"></a>01286   <span class="keyword">inline</span> <span class="keywordtype">bool</span> allow_allocation(<span class="keywordtype">bool</span> enable);
<a name="l01287"></a>01287 
<a name="l01288"></a>01288   <span class="keywordtype">bool</span> disallow_allocation_failure() {
<a name="l01289"></a>01289     <span class="keywordflow">return</span> disallow_allocation_failure_;
<a name="l01290"></a>01290   }
<a name="l01291"></a>01291 
<a name="l01292"></a>01292   <span class="keywordtype">void</span> TracePathToObject(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* target);
<a name="l01293"></a>01293   <span class="keywordtype">void</span> TracePathToGlobal();
<a name="l01294"></a>01294 <span class="preprocessor">#endif</span>
<a name="l01295"></a>01295 <span class="preprocessor"></span>
<a name="l01296"></a>01296   <span class="comment">// Callback function passed to Heap::Iterate etc.  Copies an object if</span>
<a name="l01297"></a>01297   <span class="comment">// necessary, the object might be promoted to an old space.  The caller must</span>
<a name="l01298"></a>01298   <span class="comment">// ensure the precondition that the object is (a) a heap object and (b) in</span>
<a name="l01299"></a>01299   <span class="comment">// the heap&#39;s from space.</span>
<a name="l01300"></a>01300   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad734a8f367fc5074bef953982c2dccf3">ScavengePointer</a>(HeapObject** p);
<a name="l01301"></a>01301   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a120f05773313869c5d76d453d211b08a">ScavengeObject</a>(HeapObject** p, HeapObject* <span class="keywordtype">object</span>);
<a name="l01302"></a>01302 
<a name="l01303"></a>01303   <span class="comment">// Commits from space if it is uncommitted.</span>
<a name="l01304"></a>01304   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad0f0a8f9ba63986f40283c598729b41f">EnsureFromSpaceIsCommitted</a>();
<a name="l01305"></a>01305 
<a name="l01306"></a>01306   <span class="comment">// Support for partial snapshots.  After calling this we can allocate a</span>
<a name="l01307"></a>01307   <span class="comment">// certain number of bytes using only linear allocation (with a</span>
<a name="l01308"></a>01308   <span class="comment">// LinearAllocationScope and an AlwaysAllocateScope) without using freelists</span>
<a name="l01309"></a>01309   <span class="comment">// or causing a GC.  It returns true of space was reserved or false if a GC is</span>
<a name="l01310"></a>01310   <span class="comment">// needed.  For paged spaces the space requested must include the space wasted</span>
<a name="l01311"></a>01311   <span class="comment">// at the end of each page when allocating linearly.</span>
<a name="l01312"></a>01312   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a73f63c5ca9be6e610d590745e51560bd">ReserveSpace</a>(
<a name="l01313"></a>01313     <span class="keywordtype">int</span> new_space_size,
<a name="l01314"></a>01314     <span class="keywordtype">int</span> pointer_space_size,
<a name="l01315"></a>01315     <span class="keywordtype">int</span> data_space_size,
<a name="l01316"></a>01316     <span class="keywordtype">int</span> code_space_size,
<a name="l01317"></a>01317     <span class="keywordtype">int</span> map_space_size,
<a name="l01318"></a>01318     <span class="keywordtype">int</span> cell_space_size,
<a name="l01319"></a>01319     <span class="keywordtype">int</span> large_object_size);
<a name="l01320"></a>01320 
<a name="l01321"></a>01321   <span class="comment">//</span>
<a name="l01322"></a>01322   <span class="comment">// Support for the API.</span>
<a name="l01323"></a>01323   <span class="comment">//</span>
<a name="l01324"></a>01324 
<a name="l01325"></a>01325   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a3287f2542ec74217bfdf25be5b33cc4b">CreateApiObjects</a>();
<a name="l01326"></a>01326 
<a name="l01327"></a>01327   <span class="comment">// Attempt to find the number in a small cache.  If we finds it, return</span>
<a name="l01328"></a>01328   <span class="comment">// the string representation of the number.  Otherwise return undefined.</span>
<a name="l01329"></a>01329   <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a345e63277c87c29bbbca0de2fbce1404">GetNumberStringCache</a>(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* number);
<a name="l01330"></a>01330 
<a name="l01331"></a>01331   <span class="comment">// Update the cache with a new number-string pair.</span>
<a name="l01332"></a>01332   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ae2065e63355ade7fab763ef37fb9a51e">SetNumberStringCache</a>(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* number, String* str);
<a name="l01333"></a>01333 
<a name="l01334"></a>01334   <span class="comment">// Adjusts the amount of registered external memory.</span>
<a name="l01335"></a>01335   <span class="comment">// Returns the adjusted value.</span>
<a name="l01336"></a>01336   <span class="keyword">inline</span> intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#ab95265bad31172e1056d3e8d0c7635e3">AdjustAmountOfExternalAllocatedMemory</a>(
<a name="l01337"></a>01337       intptr_t change_in_bytes);
<a name="l01338"></a>01338 
<a name="l01339"></a>01339   <span class="comment">// Allocate uninitialized fixed array.</span>
<a name="l01340"></a>01340   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3ef21802c3665e41051a32791c15fccf">AllocateRawFixedArray</a>(<span class="keywordtype">int</span> length);
<a name="l01341"></a>01341   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a3ef21802c3665e41051a32791c15fccf">AllocateRawFixedArray</a>(<span class="keywordtype">int</span> length,
<a name="l01342"></a>01342                                                      <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure);
<a name="l01343"></a>01343 
<a name="l01344"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aa699db2fbfaf6f6e633801039e818ad6">01344</a>   <span class="keyword">inline</span> intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#aa699db2fbfaf6f6e633801039e818ad6">PromotedTotalSize</a>() {
<a name="l01345"></a>01345     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad29b367679b9fb247b28b044f98cac26">PromotedSpaceSize</a>() + PromotedExternalMemorySize();
<a name="l01346"></a>01346   }
<a name="l01347"></a>01347 
<a name="l01348"></a>01348   <span class="comment">// True if we have reached the allocation limit in the old generation that</span>
<a name="l01349"></a>01349   <span class="comment">// should force the next GC (caused normally) to be a full one.</span>
<a name="l01350"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a077340d0fd4bfae93ce20d67510b79b7">01350</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a077340d0fd4bfae93ce20d67510b79b7">OldGenerationPromotionLimitReached</a>() {
<a name="l01351"></a>01351     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aa699db2fbfaf6f6e633801039e818ad6">PromotedTotalSize</a>() &gt; old_gen_promotion_limit_;
<a name="l01352"></a>01352   }
<a name="l01353"></a>01353 
<a name="l01354"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a6a8ee5e12c66403def218da520794671">01354</a>   <span class="keyword">inline</span> intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a6a8ee5e12c66403def218da520794671">OldGenerationSpaceAvailable</a>() {
<a name="l01355"></a>01355     <span class="keywordflow">return</span> old_gen_allocation_limit_ - <a class="code" href="classv8_1_1internal_1_1_heap.html#aa699db2fbfaf6f6e633801039e818ad6">PromotedTotalSize</a>();
<a name="l01356"></a>01356   }
<a name="l01357"></a>01357 
<a name="l01358"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#afa84064b02d58280346cd64dd72572a3">01358</a>   <span class="keyword">inline</span> intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#afa84064b02d58280346cd64dd72572a3">OldGenerationCapacityAvailable</a>() {
<a name="l01359"></a>01359     <span class="keywordflow">return</span> max_old_generation_size_ - <a class="code" href="classv8_1_1internal_1_1_heap.html#aa699db2fbfaf6f6e633801039e818ad6">PromotedTotalSize</a>();
<a name="l01360"></a>01360   }
<a name="l01361"></a>01361 
<a name="l01362"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ae0650a83b63a0e8c06b8cbef61236603">01362</a>   <span class="keyword">static</span> <span class="keyword">const</span> intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#ae0650a83b63a0e8c06b8cbef61236603">kMinimumPromotionLimit</a> = 5 * <a class="code" href="classv8_1_1internal_1_1_page.html#a573b8add96a07f20176e2bab44f48c20">Page::kPageSize</a>;
<a name="l01363"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a83a0066f90505cd17a3dce0111ba19d3">01363</a>   <span class="keyword">static</span> <span class="keyword">const</span> intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a83a0066f90505cd17a3dce0111ba19d3">kMinimumAllocationLimit</a> =
<a name="l01364"></a>01364       8 * (<a class="code" href="classv8_1_1internal_1_1_page.html#a573b8add96a07f20176e2bab44f48c20">Page::kPageSize</a> &gt; <a class="code" href="namespacev8_1_1internal.html#ac9348d43b27afd1b556903717cbe0b84">MB</a> ? <a class="code" href="classv8_1_1internal_1_1_page.html#a573b8add96a07f20176e2bab44f48c20">Page::kPageSize</a> : <a class="code" href="namespacev8_1_1internal.html#ac9348d43b27afd1b556903717cbe0b84">MB</a>);
<a name="l01365"></a>01365 
<a name="l01366"></a>01366   <span class="comment">// When we sweep lazily we initially guess that there is no garbage on the</span>
<a name="l01367"></a>01367   <span class="comment">// heap and set the limits for the next GC accordingly.  As we sweep we find</span>
<a name="l01368"></a>01368   <span class="comment">// out that some of the pages contained garbage and we have to adjust</span>
<a name="l01369"></a>01369   <span class="comment">// downwards the size of the heap.  This means the limits that control the</span>
<a name="l01370"></a>01370   <span class="comment">// timing of the next GC also need to be adjusted downwards.</span>
<a name="l01371"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aef4f0b80b9a49473fcfe05031c663421">01371</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aef4f0b80b9a49473fcfe05031c663421">LowerOldGenLimits</a>(intptr_t adjustment) {
<a name="l01372"></a>01372     size_of_old_gen_at_last_old_space_gc_ -= adjustment;
<a name="l01373"></a>01373     old_gen_promotion_limit_ =
<a name="l01374"></a>01374         <a class="code" href="classv8_1_1internal_1_1_heap.html#a5e3a005b6d58753446930285820d38ed">OldGenPromotionLimit</a>(size_of_old_gen_at_last_old_space_gc_);
<a name="l01375"></a>01375     old_gen_allocation_limit_ =
<a name="l01376"></a>01376         <a class="code" href="classv8_1_1internal_1_1_heap.html#af34bd1807b72b544f9b6e4f071489e3c">OldGenAllocationLimit</a>(size_of_old_gen_at_last_old_space_gc_);
<a name="l01377"></a>01377   }
<a name="l01378"></a>01378 
<a name="l01379"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a5e3a005b6d58753446930285820d38ed">01379</a>   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a5e3a005b6d58753446930285820d38ed">OldGenPromotionLimit</a>(intptr_t old_gen_size) {
<a name="l01380"></a>01380     <span class="keyword">const</span> <span class="keywordtype">int</span> divisor = FLAG_stress_compaction ? 10 : 3;
<a name="l01381"></a>01381     intptr_t limit =
<a name="l01382"></a>01382         <a class="code" href="namespacev8_1_1internal.html#ac1ca15b56c9c6bbf29ee4aa156dbc05a">Max</a>(old_gen_size + old_gen_size / divisor, <a class="code" href="classv8_1_1internal_1_1_heap.html#ae0650a83b63a0e8c06b8cbef61236603">kMinimumPromotionLimit</a>);
<a name="l01383"></a>01383     limit += new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#a31fc242c1d16db736c1d274b811e1433">Capacity</a>();
<a name="l01384"></a>01384     limit *= old_gen_limit_factor_;
<a name="l01385"></a>01385     intptr_t halfway_to_the_max = (old_gen_size + max_old_generation_size_) / 2;
<a name="l01386"></a>01386     <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#a4789b60113833ac293f9d1aa9a6372e8">Min</a>(limit, halfway_to_the_max);
<a name="l01387"></a>01387   }
<a name="l01388"></a>01388 
<a name="l01389"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#af34bd1807b72b544f9b6e4f071489e3c">01389</a>   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#af34bd1807b72b544f9b6e4f071489e3c">OldGenAllocationLimit</a>(intptr_t old_gen_size) {
<a name="l01390"></a>01390     <span class="keyword">const</span> <span class="keywordtype">int</span> divisor = FLAG_stress_compaction ? 8 : 2;
<a name="l01391"></a>01391     intptr_t limit =
<a name="l01392"></a>01392         <a class="code" href="namespacev8_1_1internal.html#ac1ca15b56c9c6bbf29ee4aa156dbc05a">Max</a>(old_gen_size + old_gen_size / divisor, <a class="code" href="classv8_1_1internal_1_1_heap.html#a83a0066f90505cd17a3dce0111ba19d3">kMinimumAllocationLimit</a>);
<a name="l01393"></a>01393     limit += new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#a31fc242c1d16db736c1d274b811e1433">Capacity</a>();
<a name="l01394"></a>01394     limit *= old_gen_limit_factor_;
<a name="l01395"></a>01395     intptr_t halfway_to_the_max = (old_gen_size + max_old_generation_size_) / 2;
<a name="l01396"></a>01396     <span class="keywordflow">return</span> <a class="code" href="namespacev8_1_1internal.html#a4789b60113833ac293f9d1aa9a6372e8">Min</a>(limit, halfway_to_the_max);
<a name="l01397"></a>01397   }
<a name="l01398"></a>01398 
<a name="l01399"></a>01399   <span class="comment">// Implements the corresponding V8 API function.</span>
<a name="l01400"></a>01400   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a2d568617ff726f2e28b2149f082b859c">IdleNotification</a>(<span class="keywordtype">int</span> hint);
<a name="l01401"></a>01401 
<a name="l01402"></a>01402   <span class="comment">// Declare all the root indices.</span>
<a name="l01403"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dce">01403</a>   <span class="keyword">enum</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dce">RootListIndex</a> {
<a name="l01404"></a><a class="code" href="heap_8h.html#a67a69dfbb4e0bd883cc64d77a76d3ed5">01404</a> <span class="preprocessor">#define ROOT_INDEX_DECLARATION(type, name, camel_name) k##camel_name##RootIndex,</span>
<a name="l01405"></a>01405 <span class="preprocessor"></span>    <a class="code" href="heap_8h.html#a9f01550232518f85dca2f152bbc3677d">STRONG_ROOT_LIST</a>(<a class="code" href="heap_8h.html#a67a69dfbb4e0bd883cc64d77a76d3ed5">ROOT_INDEX_DECLARATION</a>)
<a name="l01406"></a>01406 <span class="preprocessor">#undef ROOT_INDEX_DECLARATION</span>
<a name="l01407"></a>01407 <span class="preprocessor"></span>
<a name="l01408"></a>01408 <span class="comment">// Utility type maps</span>
<a name="l01409"></a><a class="code" href="heap_8h.html#add2d7316cfbce7d3d3a2408f249ff60b">01409</a> <span class="preprocessor">#define DECLARE_STRUCT_MAP(NAME, Name, name) k##Name##MapRootIndex,</span>
<a name="l01410"></a>01410 <span class="preprocessor"></span>  <a class="code" href="objects_8h.html#a3b5399155f391d070485d8310f9d2e95">STRUCT_LIST</a>(<a class="code" href="heap_8h.html#add2d7316cfbce7d3d3a2408f249ff60b">DECLARE_STRUCT_MAP</a>)
<a name="l01411"></a>01411 <span class="preprocessor">#undef DECLARE_STRUCT_MAP</span>
<a name="l01412"></a>01412 <span class="preprocessor"></span>
<a name="l01413"></a><a class="code" href="heap_8h.html#a1b81a97e28a04ffa4dc48db789c2905d">01413</a> <span class="preprocessor">#define SYMBOL_INDEX_DECLARATION(name, str) k##name##RootIndex,</span>
<a name="l01414"></a>01414 <span class="preprocessor"></span>    <a class="code" href="heap_8h.html#a5fc83e0f16e7ddf38e053f8537c39727">SYMBOL_LIST</a>(<a class="code" href="heap_8h.html#a1b81a97e28a04ffa4dc48db789c2905d">SYMBOL_INDEX_DECLARATION</a>)
<a name="l01415"></a>01415 <span class="preprocessor">#undef SYMBOL_DECLARATION</span>
<a name="l01416"></a>01416 <span class="preprocessor"></span>
<a name="l01417"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dceac0933552da3247cf5199a4e0183f4816">01417</a>     <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dceac0933552da3247cf5199a4e0183f4816">kSymbolTableRootIndex</a>,
<a name="l01418"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dcead1221b878d4c94f53424dbe31b0ca2e9">01418</a>     <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dcead1221b878d4c94f53424dbe31b0ca2e9">kStrongRootListLength</a> = <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dceac0933552da3247cf5199a4e0183f4816">kSymbolTableRootIndex</a>,
<a name="l01419"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dcea35860978d61c32441aa6049275039be4">01419</a>     <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dcea35860978d61c32441aa6049275039be4">kRootListLength</a>
<a name="l01420"></a>01420   };
<a name="l01421"></a>01421 
<a name="l01422"></a>01422   <a class="code" href="classv8_1_1internal_1_1_heap.html#a70e7fdc5acf1146dd8085de5506f5caf">STATIC_CHECK</a>(kUndefinedValueRootIndex == <a class="code" href="classv8_1_1internal_1_1_internals.html#a7281ff0eafed559e64613465b1a03296">Internals::kUndefinedValueRootIndex</a>);
<a name="l01423"></a>01423   <a class="code" href="classv8_1_1internal_1_1_heap.html#a70e7fdc5acf1146dd8085de5506f5caf">STATIC_CHECK</a>(kNullValueRootIndex == <a class="code" href="classv8_1_1internal_1_1_internals.html#ab311cf753ec5c968052bd83ef21e83f8">Internals::kNullValueRootIndex</a>);
<a name="l01424"></a>01424   <a class="code" href="classv8_1_1internal_1_1_heap.html#a70e7fdc5acf1146dd8085de5506f5caf">STATIC_CHECK</a>(kTrueValueRootIndex == <a class="code" href="classv8_1_1internal_1_1_internals.html#a93abd58b178eca469bade28e68b5c59e">Internals::kTrueValueRootIndex</a>);
<a name="l01425"></a>01425   <a class="code" href="classv8_1_1internal_1_1_heap.html#a70e7fdc5acf1146dd8085de5506f5caf">STATIC_CHECK</a>(kFalseValueRootIndex == <a class="code" href="classv8_1_1internal_1_1_internals.html#a90b6837aa368bbe4ffd914e6f753b167">Internals::kFalseValueRootIndex</a>);
<a name="l01426"></a>01426 
<a name="l01427"></a>01427   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab3a10d4f01efb8e29f7677a26a7826ec">NumberToString</a>(
<a name="l01428"></a>01428       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* number, <span class="keywordtype">bool</span> check_number_string_cache = <span class="keyword">true</span>);
<a name="l01429"></a>01429   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_heap.html#a2a62ce43799f9be12e2855dada0b4966">Uint32ToString</a>(
<a name="l01430"></a>01430       uint32_t value, <span class="keywordtype">bool</span> check_number_string_cache = <span class="keyword">true</span>);
<a name="l01431"></a>01431 
<a name="l01432"></a>01432   <a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a7f149e7e2d4e45179df8bdbc2fcc5dc9">MapForExternalArrayType</a>(<a class="code" href="namespacev8.html#aabbbc5430374565be119ff192a40544e">ExternalArrayType</a> array_type);
<a name="l01433"></a>01433   <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dce">RootListIndex</a> <a class="code" href="classv8_1_1internal_1_1_heap.html#a29079a3d4039ae19e1bc78ca77adbf9b">RootIndexForExternalArrayType</a>(
<a name="l01434"></a>01434       <a class="code" href="namespacev8.html#aabbbc5430374565be119ff192a40544e">ExternalArrayType</a> array_type);
<a name="l01435"></a>01435 
<a name="l01436"></a>01436   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aade3e6bd0abbe091c12e9c9ac35ee6af">RecordStats</a>(<a class="code" href="classv8_1_1internal_1_1_heap_stats.html">HeapStats</a>* stats, <span class="keywordtype">bool</span> take_snapshot = <span class="keyword">false</span>);
<a name="l01437"></a>01437 
<a name="l01438"></a>01438   <span class="comment">// Copy block of memory from src to dst. Size of block should be aligned</span>
<a name="l01439"></a>01439   <span class="comment">// by pointer size.</span>
<a name="l01440"></a>01440   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac3641a0b7518d1536161ebcb69bc4be9">CopyBlock</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> dst, <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> src, <span class="keywordtype">int</span> byte_size);
<a name="l01441"></a>01441 
<a name="l01442"></a>01442   <span class="comment">// Optimized version of memmove for blocks with pointer size aligned sizes and</span>
<a name="l01443"></a>01443   <span class="comment">// pointer size aligned addresses.</span>
<a name="l01444"></a>01444   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a7d91e280a448d5cdfe24d752aa98d53c">MoveBlock</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> dst, <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> src, <span class="keywordtype">int</span> byte_size);
<a name="l01445"></a>01445 
<a name="l01446"></a>01446   <span class="comment">// Check new space expansion criteria and expand semispaces if it was hit.</span>
<a name="l01447"></a>01447   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a432276c83ffc010c9d21b3ae4ab8ec1b">CheckNewSpaceExpansionCriteria</a>();
<a name="l01448"></a>01448 
<a name="l01449"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ac9b91940d070af80eb1fac069ead4e16">01449</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac9b91940d070af80eb1fac069ead4e16">IncrementYoungSurvivorsCounter</a>(<span class="keywordtype">int</span> survived) {
<a name="l01450"></a>01450     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(survived &gt;= 0);
<a name="l01451"></a>01451     young_survivors_after_last_gc_ = survived;
<a name="l01452"></a>01452     survived_since_last_expansion_ += survived;
<a name="l01453"></a>01453   }
<a name="l01454"></a>01454 
<a name="l01455"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aa4f3a3053197e3961e910f9c4d75f11f">01455</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aa4f3a3053197e3961e910f9c4d75f11f">NextGCIsLikelyToBeFull</a>() {
<a name="l01456"></a>01456     <span class="keywordflow">if</span> (FLAG_gc_global) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01457"></a>01457 
<a name="l01458"></a>01458     intptr_t total_promoted = <a class="code" href="classv8_1_1internal_1_1_heap.html#aa699db2fbfaf6f6e633801039e818ad6">PromotedTotalSize</a>();
<a name="l01459"></a>01459 
<a name="l01460"></a>01460     intptr_t adjusted_promotion_limit =
<a name="l01461"></a>01461         old_gen_promotion_limit_ - new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#a31fc242c1d16db736c1d274b811e1433">Capacity</a>();
<a name="l01462"></a>01462 
<a name="l01463"></a>01463     <span class="keywordflow">if</span> (total_promoted &gt;= adjusted_promotion_limit) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01464"></a>01464 
<a name="l01465"></a>01465     intptr_t adjusted_allocation_limit =
<a name="l01466"></a>01466         old_gen_allocation_limit_ - new_space_.<a class="code" href="classv8_1_1internal_1_1_new_space.html#a31fc242c1d16db736c1d274b811e1433">Capacity</a>() / 5;
<a name="l01467"></a>01467 
<a name="l01468"></a>01468     <span class="keywordflow">if</span> (<a class="code" href="classv8_1_1internal_1_1_heap.html#ad29b367679b9fb247b28b044f98cac26">PromotedSpaceSize</a>() &gt;= adjusted_allocation_limit) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01469"></a>01469 
<a name="l01470"></a>01470     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01471"></a>01471   }
<a name="l01472"></a>01472 
<a name="l01473"></a>01473 
<a name="l01474"></a>01474   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a9478f5c950fce134ad9a3e8dc2dad254">UpdateNewSpaceReferencesInExternalStringTable</a>(
<a name="l01475"></a>01475       <a class="code" href="namespacev8_1_1internal.html#aa7a678fdf86beb6a8ac5f27b9d3525c0">ExternalStringTableUpdaterCallback</a> updater_func);
<a name="l01476"></a>01476 
<a name="l01477"></a>01477   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad5389324ddf98758e5034523b9861a7e">UpdateReferencesInExternalStringTable</a>(
<a name="l01478"></a>01478       <a class="code" href="namespacev8_1_1internal.html#aa7a678fdf86beb6a8ac5f27b9d3525c0">ExternalStringTableUpdaterCallback</a> updater_func);
<a name="l01479"></a>01479 
<a name="l01480"></a>01480   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a56ea5c06a53ede8e32ba29cf7e4f6db6">ProcessWeakReferences</a>(<a class="code" href="classv8_1_1internal_1_1_weak_object_retainer.html">WeakObjectRetainer</a>* retainer);
<a name="l01481"></a>01481 
<a name="l01482"></a>01482   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a1114f7d55a1658f321e1aaebc34ee3f4">VisitExternalResources</a>(<a class="code" href="classv8_1_1_external_resource_visitor.html">v8::ExternalResourceVisitor</a>* visitor);
<a name="l01483"></a>01483 
<a name="l01484"></a>01484   <span class="comment">// Helper function that governs the promotion policy from new space to</span>
<a name="l01485"></a>01485   <span class="comment">// old.  If the object&#39;s old address lies below the new space&#39;s age</span>
<a name="l01486"></a>01486   <span class="comment">// mark or if we&#39;ve already filled the bottom 1/16th of the to space,</span>
<a name="l01487"></a>01487   <span class="comment">// we try to promote this object.</span>
<a name="l01488"></a>01488   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac220b3da119fd1783a1636f86bc12ab6">ShouldBePromoted</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> old_address, <span class="keywordtype">int</span> object_size);
<a name="l01489"></a>01489 
<a name="l01490"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ac4044c043bd2fc6f4c93beb01f108fb0">01490</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac4044c043bd2fc6f4c93beb01f108fb0">MaxObjectSizeInNewSpace</a>() { <span class="keywordflow">return</span> kMaxObjectSizeInNewSpace; }
<a name="l01491"></a>01491 
<a name="l01492"></a>01492   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a87499b420ab30506065ee720a9abf137">ClearJSFunctionResultCaches</a>();
<a name="l01493"></a>01493 
<a name="l01494"></a>01494   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad1df96ba9d9708cfaf94aad453d84962">ClearNormalizedMapCaches</a>();
<a name="l01495"></a>01495 
<a name="l01496"></a>01496   <span class="comment">// Clears the cache of ICs related to this map.</span>
<a name="l01497"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#af52d397d57ff75e3cba5b54b03198e8b">01497</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#af52d397d57ff75e3cba5b54b03198e8b">ClearCacheOnMap</a>(<a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map) {
<a name="l01498"></a>01498     <span class="keywordflow">if</span> (FLAG_cleanup_code_caches_at_gc) {
<a name="l01499"></a>01499       map-&gt;<a class="code" href="classv8_1_1internal_1_1_map.html#ae056fb96f948796beaa380733e704d30">ClearCodeCache</a>(<span class="keyword">this</span>);
<a name="l01500"></a>01500     }
<a name="l01501"></a>01501   }
<a name="l01502"></a>01502 
<a name="l01503"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#abdd7e3821604a14452281640366cc9bb">01503</a>   <a class="code" href="classv8_1_1internal_1_1_heap.html#af0a250e40f134d7b35c7c22304f35304">GCTracer</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#abdd7e3821604a14452281640366cc9bb">tracer</a>() { <span class="keywordflow">return</span> tracer_; }
<a name="l01504"></a>01504 
<a name="l01505"></a>01505   <span class="comment">// Returns the size of objects residing in non new spaces.</span>
<a name="l01506"></a>01506   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#ad29b367679b9fb247b28b044f98cac26">PromotedSpaceSize</a>();
<a name="l01507"></a>01507   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#af0a1486941c5083a8c528ceb810dcb96">PromotedSpaceSizeOfObjects</a>();
<a name="l01508"></a>01508 
<a name="l01509"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#accfa8fe064d2e46d78418f902228e694">01509</a>   <span class="keywordtype">double</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#accfa8fe064d2e46d78418f902228e694">total_regexp_code_generated</a>() { <span class="keywordflow">return</span> total_regexp_code_generated_; }
<a name="l01510"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aa16d3a9f625d687d821cbe49eac2dabd">01510</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aa16d3a9f625d687d821cbe49eac2dabd">IncreaseTotalRegexpCodeGenerated</a>(<span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>) {
<a name="l01511"></a>01511     total_regexp_code_generated_ += <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>;
<a name="l01512"></a>01512   }
<a name="l01513"></a>01513 
<a name="l01514"></a>01514   <span class="comment">// Returns maximum GC pause.</span>
<a name="l01515"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ada8bfb5ab0c018a31ae522c95d1c4b5f">01515</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ada8bfb5ab0c018a31ae522c95d1c4b5f">get_max_gc_pause</a>() { <span class="keywordflow">return</span> max_gc_pause_; }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517   <span class="comment">// Returns maximum size of objects alive after GC.</span>
<a name="l01518"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ad541f7579dbffceb0e559825016eee34">01518</a>   intptr_t <a class="code" href="classv8_1_1internal_1_1_heap.html#ad541f7579dbffceb0e559825016eee34">get_max_alive_after_gc</a>() { <span class="keywordflow">return</span> max_alive_after_gc_; }
<a name="l01519"></a>01519 
<a name="l01520"></a>01520   <span class="comment">// Returns minimal interval between two subsequent collections.</span>
<a name="l01521"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a6cf03bd714d3a908224a5593aa1d4834">01521</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a6cf03bd714d3a908224a5593aa1d4834">get_min_in_mutator</a>() { <span class="keywordflow">return</span> min_in_mutator_; }
<a name="l01522"></a>01522 
<a name="l01523"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#af562806aafc1f078a8da45674d431c1a">01523</a>   <a class="code" href="classv8_1_1internal_1_1_mark_compact_collector.html">MarkCompactCollector</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#af562806aafc1f078a8da45674d431c1a">mark_compact_collector</a>() {
<a name="l01524"></a>01524     <span class="keywordflow">return</span> &amp;mark_compact_collector_;
<a name="l01525"></a>01525   }
<a name="l01526"></a>01526 
<a name="l01527"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a7a0c298ff01a173aa8df4326b75e5717">01527</a>   <a class="code" href="classv8_1_1internal_1_1_store_buffer.html">StoreBuffer</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a7a0c298ff01a173aa8df4326b75e5717">store_buffer</a>() {
<a name="l01528"></a>01528     <span class="keywordflow">return</span> &amp;store_buffer_;
<a name="l01529"></a>01529   }
<a name="l01530"></a>01530 
<a name="l01531"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a669c19d3eb9d048a04bcf2af372f01a9">01531</a>   <a class="code" href="classv8_1_1internal_1_1_marking.html">Marking</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a669c19d3eb9d048a04bcf2af372f01a9">marking</a>() {
<a name="l01532"></a>01532     <span class="keywordflow">return</span> &amp;marking_;
<a name="l01533"></a>01533   }
<a name="l01534"></a>01534 
<a name="l01535"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ab22cdb999c73da6215619ad67bbd13d4">01535</a>   <a class="code" href="classv8_1_1internal_1_1_incremental_marking.html">IncrementalMarking</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#ab22cdb999c73da6215619ad67bbd13d4">incremental_marking</a>() {
<a name="l01536"></a>01536     <span class="keywordflow">return</span> &amp;incremental_marking_;
<a name="l01537"></a>01537   }
<a name="l01538"></a>01538 
<a name="l01539"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a0cacadc940c886304912c8cf71c10ec4">01539</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a0cacadc940c886304912c8cf71c10ec4">IsSweepingComplete</a>() {
<a name="l01540"></a>01540     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aab6a41e438e2c1fd8c092f1fc6e74275">old_data_space</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1_paged_space.html#a7e2465ea2d61cf5d40d392344243578e">IsSweepingComplete</a>() &amp;&amp;
<a name="l01541"></a>01541            <a class="code" href="classv8_1_1internal_1_1_heap.html#a0fa4311d4e5b283b63602a4abb0d89bf">old_pointer_space</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1_paged_space.html#a7e2465ea2d61cf5d40d392344243578e">IsSweepingComplete</a>();
<a name="l01542"></a>01542   }
<a name="l01543"></a>01543 
<a name="l01544"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aeeee50ae13fd355533ab6e9cfd88e629">01544</a>   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#aeeee50ae13fd355533ab6e9cfd88e629">AdvanceSweepers</a>(<span class="keywordtype">int</span> step_size) {
<a name="l01545"></a>01545     <span class="keywordtype">bool</span> sweeping_complete = <a class="code" href="classv8_1_1internal_1_1_heap.html#aab6a41e438e2c1fd8c092f1fc6e74275">old_data_space</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1_paged_space.html#acb1caad21d50dbf579a069675a2cf1ba">AdvanceSweeper</a>(step_size);
<a name="l01546"></a>01546     sweeping_complete &amp;= <a class="code" href="classv8_1_1internal_1_1_heap.html#a0fa4311d4e5b283b63602a4abb0d89bf">old_pointer_space</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1_paged_space.html#acb1caad21d50dbf579a069675a2cf1ba">AdvanceSweeper</a>(step_size);
<a name="l01547"></a>01547     <span class="keywordflow">return</span> sweeping_complete;
<a name="l01548"></a>01548   }
<a name="l01549"></a>01549 
<a name="l01550"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a322a35014a4fa114ac830e469f395302">01550</a>   <a class="code" href="classv8_1_1internal_1_1_external_string_table.html">ExternalStringTable</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a322a35014a4fa114ac830e469f395302">external_string_table</a>() {
<a name="l01551"></a>01551     <span class="keywordflow">return</span> &amp;external_string_table_;
<a name="l01552"></a>01552   }
<a name="l01553"></a>01553 
<a name="l01554"></a>01554   <span class="comment">// Returns the current sweep generation.</span>
<a name="l01555"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ac48f4b129cccb1ead2e07cb923ffbeab">01555</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ac48f4b129cccb1ead2e07cb923ffbeab">sweep_generation</a>() {
<a name="l01556"></a>01556     <span class="keywordflow">return</span> sweep_generation_;
<a name="l01557"></a>01557   }
<a name="l01558"></a>01558 
<a name="l01559"></a>01559   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_isolate.html">Isolate</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#a7af0a9e8ba9409e89a980ec37a3a9f3d">isolate</a>();
<a name="l01560"></a>01560 
<a name="l01561"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a2fdc2f047cf44afaab55916f664a41f7">01561</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a2fdc2f047cf44afaab55916f664a41f7">CallGlobalGCPrologueCallback</a>() {
<a name="l01562"></a>01562     <span class="keywordflow">if</span> (global_gc_prologue_callback_ != <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>) global_gc_prologue_callback_();
<a name="l01563"></a>01563   }
<a name="l01564"></a>01564 
<a name="l01565"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a6c7fde7821c74cfd877502cbd0875d34">01565</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a6c7fde7821c74cfd877502cbd0875d34">CallGlobalGCEpilogueCallback</a>() {
<a name="l01566"></a>01566     <span class="keywordflow">if</span> (global_gc_epilogue_callback_ != <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>) global_gc_epilogue_callback_();
<a name="l01567"></a>01567   }
<a name="l01568"></a>01568 
<a name="l01569"></a>01569   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a1f66fc8db47e583220fa17450eeee1e6">OldGenerationAllocationLimitReached</a>();
<a name="l01570"></a>01570 
<a name="l01571"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a50d35ff5a866e046f5786679317a6ad8">01571</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a50d35ff5a866e046f5786679317a6ad8">DoScavengeObject</a>(<a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map, <a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>** slot, <a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* obj) {
<a name="l01572"></a>01572     scavenging_visitors_table_.<a class="code" href="classv8_1_1internal_1_1_visitor_dispatch_table.html#a34ddc529f94034a8614b0123ec3f0e6d">GetVisitor</a>(map)(map, slot, obj);
<a name="l01573"></a>01573   }
<a name="l01574"></a>01574 
<a name="l01575"></a>01575   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a4513266eaa5841d679c02de8ebd83ba1">QueueMemoryChunkForFree</a>(<a class="code" href="classv8_1_1internal_1_1_memory_chunk.html">MemoryChunk</a>* chunk);
<a name="l01576"></a>01576   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a3341621c86f97d7227f03f852d0495d7">FreeQueuedChunks</a>();
<a name="l01577"></a>01577 
<a name="l01578"></a>01578   <span class="comment">// Completely clear the Instanceof cache (to stop it keeping objects alive</span>
<a name="l01579"></a>01579   <span class="comment">// around a GC).</span>
<a name="l01580"></a>01580   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ad79abe29d925f2041fc4a6ca80cf7d0b">CompletelyClearInstanceofCache</a>();
<a name="l01581"></a>01581 
<a name="l01582"></a>01582   <span class="comment">// The roots that have an index less than this are always in old space.</span>
<a name="l01583"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a7d062ecab22270f09427f51c5cb35458">01583</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a7d062ecab22270f09427f51c5cb35458">kOldSpaceRoots</a> = 0x20;
<a name="l01584"></a>01584 
<a name="l01585"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a936f5a461f0a8a392322a989ffebac3f">01585</a>   uint32_t <a class="code" href="classv8_1_1internal_1_1_heap.html#a936f5a461f0a8a392322a989ffebac3f">HashSeed</a>() {
<a name="l01586"></a>01586     uint32_t <a class="code" href="test-strings_8cc.html#ae21f357c223957d36046a0d71cc6aed7">seed</a> = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(hash_seed()-&gt;value());
<a name="l01587"></a>01587     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(FLAG_randomize_hashes || seed == 0);
<a name="l01588"></a>01588     <span class="keywordflow">return</span> <a class="code" href="test-strings_8cc.html#ae21f357c223957d36046a0d71cc6aed7">seed</a>;
<a name="l01589"></a>01589   }
<a name="l01590"></a>01590 
<a name="l01591"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#af4aa1ac48e93ef0c43f074e36c0124a0">01591</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#af4aa1ac48e93ef0c43f074e36c0124a0">SetArgumentsAdaptorDeoptPCOffset</a>(<span class="keywordtype">int</span> pc_offset) {
<a name="l01592"></a>01592     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(arguments_adaptor_deopt_pc_offset() == <a class="code" href="classv8_1_1internal_1_1_smi.html#ab8a06699d9e96c9c50be9bf54c29ea86">Smi::FromInt</a>(0));
<a name="l01593"></a>01593     set_arguments_adaptor_deopt_pc_offset(<a class="code" href="classv8_1_1internal_1_1_smi.html#ab8a06699d9e96c9c50be9bf54c29ea86">Smi::FromInt</a>(pc_offset));
<a name="l01594"></a>01594   }
<a name="l01595"></a>01595 
<a name="l01596"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a7c85313d66eb4a834d55f4977613ef25">01596</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a7c85313d66eb4a834d55f4977613ef25">SetConstructStubDeoptPCOffset</a>(<span class="keywordtype">int</span> pc_offset) {
<a name="l01597"></a>01597     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(construct_stub_deopt_pc_offset() == <a class="code" href="classv8_1_1internal_1_1_smi.html#ab8a06699d9e96c9c50be9bf54c29ea86">Smi::FromInt</a>(0));
<a name="l01598"></a>01598     set_construct_stub_deopt_pc_offset(<a class="code" href="classv8_1_1internal_1_1_smi.html#ab8a06699d9e96c9c50be9bf54c29ea86">Smi::FromInt</a>(pc_offset));
<a name="l01599"></a>01599   }
<a name="l01600"></a>01600 
<a name="l01601"></a>01601   <span class="comment">// For post mortem debugging.</span>
<a name="l01602"></a>01602   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a58f38e94ccc5635ac625cb068959ca9e">RememberUnmappedPage</a>(<a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> page, <span class="keywordtype">bool</span> compacted);
<a name="l01603"></a>01603 
<a name="l01604"></a>01604   <span class="comment">// Global inline caching age: it is incremented on some GCs after context</span>
<a name="l01605"></a>01605   <span class="comment">// disposal. We use it to flush inline caches.</span>
<a name="l01606"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a225e87b536dd1c2985a6c63747e68d7a">01606</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a225e87b536dd1c2985a6c63747e68d7a">global_ic_age</a>() {
<a name="l01607"></a>01607     <span class="keywordflow">return</span> global_ic_age_;
<a name="l01608"></a>01608   }
<a name="l01609"></a>01609 
<a name="l01610"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a834c7def5163a4cecdd704dcfb0d858b">01610</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#a834c7def5163a4cecdd704dcfb0d858b">AgeInlineCaches</a>() {
<a name="l01611"></a>01611     ++global_ic_age_;
<a name="l01612"></a>01612   }
<a name="l01613"></a>01613 
<a name="l01614"></a>01614  <span class="keyword">private</span>:
<a name="l01615"></a>01615   <a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>();
<a name="l01616"></a>01616 
<a name="l01617"></a>01617   <span class="comment">// This can be calculated directly from a pointer to the heap; however, it is</span>
<a name="l01618"></a>01618   <span class="comment">// more expedient to get at the isolate directly from within Heap methods.</span>
<a name="l01619"></a>01619   <a class="code" href="classv8_1_1internal_1_1_isolate.html">Isolate</a>* isolate_;
<a name="l01620"></a>01620 
<a name="l01621"></a>01621   <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* roots_[<a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dcea35860978d61c32441aa6049275039be4">kRootListLength</a>];
<a name="l01622"></a>01622 
<a name="l01623"></a>01623   intptr_t code_range_size_;
<a name="l01624"></a>01624   <span class="keywordtype">int</span> reserved_semispace_size_;
<a name="l01625"></a>01625   <span class="keywordtype">int</span> max_semispace_size_;
<a name="l01626"></a>01626   <span class="keywordtype">int</span> initial_semispace_size_;
<a name="l01627"></a>01627   intptr_t max_old_generation_size_;
<a name="l01628"></a>01628   intptr_t max_executable_size_;
<a name="l01629"></a>01629 
<a name="l01630"></a>01630   <span class="comment">// For keeping track of how much data has survived</span>
<a name="l01631"></a>01631   <span class="comment">// scavenge since last new space expansion.</span>
<a name="l01632"></a>01632   <span class="keywordtype">int</span> survived_since_last_expansion_;
<a name="l01633"></a>01633 
<a name="l01634"></a>01634   <span class="comment">// For keeping track on when to flush RegExp code.</span>
<a name="l01635"></a>01635   <span class="keywordtype">int</span> sweep_generation_;
<a name="l01636"></a>01636 
<a name="l01637"></a>01637   <span class="keywordtype">int</span> always_allocate_scope_depth_;
<a name="l01638"></a>01638   <span class="keywordtype">int</span> linear_allocation_scope_depth_;
<a name="l01639"></a>01639 
<a name="l01640"></a>01640   <span class="comment">// For keeping track of context disposals.</span>
<a name="l01641"></a>01641   <span class="keywordtype">int</span> contexts_disposed_;
<a name="l01642"></a>01642 
<a name="l01643"></a>01643   <span class="keywordtype">int</span> global_ic_age_;
<a name="l01644"></a>01644 
<a name="l01645"></a>01645   <span class="keywordtype">int</span> scan_on_scavenge_pages_;
<a name="l01646"></a>01646 
<a name="l01647"></a>01647 <span class="preprocessor">#if defined(V8_TARGET_ARCH_X64)</span>
<a name="l01648"></a>01648 <span class="preprocessor"></span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kMaxObjectSizeInNewSpace = 1024*<a class="code" href="namespacev8_1_1internal.html#a14ca8228cc7692b63fc19c8687fe052f">KB</a>;
<a name="l01649"></a>01649 <span class="preprocessor">#else</span>
<a name="l01650"></a>01650 <span class="preprocessor"></span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kMaxObjectSizeInNewSpace = 512*<a class="code" href="namespacev8_1_1internal.html#a14ca8228cc7692b63fc19c8687fe052f">KB</a>;
<a name="l01651"></a>01651 <span class="preprocessor">#endif</span>
<a name="l01652"></a>01652 <span class="preprocessor"></span>
<a name="l01653"></a>01653   <a class="code" href="classv8_1_1internal_1_1_new_space.html">NewSpace</a> new_space_;
<a name="l01654"></a>01654   <a class="code" href="classv8_1_1internal_1_1_old_space.html">OldSpace</a>* old_pointer_space_;
<a name="l01655"></a>01655   <a class="code" href="classv8_1_1internal_1_1_old_space.html">OldSpace</a>* old_data_space_;
<a name="l01656"></a>01656   <a class="code" href="classv8_1_1internal_1_1_old_space.html">OldSpace</a>* code_space_;
<a name="l01657"></a>01657   <a class="code" href="classv8_1_1internal_1_1_map_space.html">MapSpace</a>* map_space_;
<a name="l01658"></a>01658   <a class="code" href="classv8_1_1internal_1_1_cell_space.html">CellSpace</a>* cell_space_;
<a name="l01659"></a>01659   <a class="code" href="classv8_1_1internal_1_1_large_object_space.html">LargeObjectSpace</a>* lo_space_;
<a name="l01660"></a>01660   <a class="code" href="classv8_1_1internal_1_1_heap.html#aee3f8b2c700602c6e8546212a2ac0f65">HeapState</a> gc_state_;
<a name="l01661"></a>01661   <span class="keywordtype">int</span> gc_post_processing_depth_;
<a name="l01662"></a>01662 
<a name="l01663"></a>01663   <span class="comment">// Returns the amount of external memory registered since last global gc.</span>
<a name="l01664"></a>01664   intptr_t PromotedExternalMemorySize();
<a name="l01665"></a>01665 
<a name="l01666"></a>01666   <span class="keywordtype">int</span> ms_count_;  <span class="comment">// how many mark-sweep collections happened</span>
<a name="l01667"></a>01667   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gc_count_;  <span class="comment">// how many gc happened</span>
<a name="l01668"></a>01668 
<a name="l01669"></a>01669   <span class="comment">// For post mortem debugging.</span>
<a name="l01670"></a>01670   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kRememberedUnmappedPages = 128;
<a name="l01671"></a>01671   <span class="keywordtype">int</span> remembered_unmapped_pages_index_;
<a name="l01672"></a>01672   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> remembered_unmapped_pages_[kRememberedUnmappedPages];
<a name="l01673"></a>01673 
<a name="l01674"></a>01674   <span class="comment">// Total length of the strings we failed to flatten since the last GC.</span>
<a name="l01675"></a>01675   <span class="keywordtype">int</span> unflattened_strings_length_;
<a name="l01676"></a>01676 
<a name="l01677"></a><a class="code" href="heap_8h.html#aff3bfca7c03595f1ad4582783ef7ebd4">01677</a> <span class="preprocessor">#define ROOT_ACCESSOR(type, name, camel_name)                                  \</span>
<a name="l01678"></a>01678 <span class="preprocessor">  inline void set_##name(type* value) {                                        \</span>
<a name="l01679"></a>01679 <span class="preprocessor">    </span><span class="comment">/* The deserializer makes use of the fact that these common roots are */</span>   \
<a name="l01680"></a>01680     <span class="comment">/* never in new space and never on a page that is being compacted.    */</span>   \
<a name="l01681"></a>01681     ASSERT(k##camel_name##RootIndex &gt;= kOldSpaceRoots || !InNewSpace(value));  \
<a name="l01682"></a>01682     roots_[k##camel_name##RootIndex] = value;                                  \
<a name="l01683"></a>01683   }
<a name="l01684"></a>01684   <a class="code" href="heap_8h.html#a6f2cf89f87e025582097c2febe7ca152">ROOT_LIST</a>(<a class="code" href="factory_8h.html#aff3bfca7c03595f1ad4582783ef7ebd4">ROOT_ACCESSOR</a>)
<a name="l01685"></a>01685 <span class="preprocessor">#undef ROOT_ACCESSOR</span>
<a name="l01686"></a>01686 <span class="preprocessor"></span>
<a name="l01687"></a>01687 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01688"></a>01688 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> allocation_allowed_;
<a name="l01689"></a>01689 
<a name="l01690"></a>01690   <span class="comment">// If the --gc-interval flag is set to a positive value, this</span>
<a name="l01691"></a>01691   <span class="comment">// variable holds the value indicating the number of allocations</span>
<a name="l01692"></a>01692   <span class="comment">// remain until the next failure and garbage collection.</span>
<a name="l01693"></a>01693   <span class="keywordtype">int</span> allocation_timeout_;
<a name="l01694"></a>01694 
<a name="l01695"></a>01695   <span class="comment">// Do we expect to be able to handle allocation failure at this</span>
<a name="l01696"></a>01696   <span class="comment">// time?</span>
<a name="l01697"></a>01697   <span class="keywordtype">bool</span> disallow_allocation_failure_;
<a name="l01698"></a>01698 
<a name="l01699"></a>01699   HeapDebugUtils* debug_utils_;
<a name="l01700"></a>01700 <span class="preprocessor">#endif  // DEBUG</span>
<a name="l01701"></a>01701 <span class="preprocessor"></span>
<a name="l01702"></a>01702   <span class="comment">// Indicates that the new space should be kept small due to high promotion</span>
<a name="l01703"></a>01703   <span class="comment">// rates caused by the mutator allocating a lot of long-lived objects.</span>
<a name="l01704"></a>01704   <span class="keywordtype">bool</span> new_space_high_promotion_mode_active_;
<a name="l01705"></a>01705 
<a name="l01706"></a>01706   <span class="comment">// Limit that triggers a global GC on the next (normally caused) GC.  This</span>
<a name="l01707"></a>01707   <span class="comment">// is checked when we have already decided to do a GC to help determine</span>
<a name="l01708"></a>01708   <span class="comment">// which collector to invoke.</span>
<a name="l01709"></a>01709   intptr_t old_gen_promotion_limit_;
<a name="l01710"></a>01710 
<a name="l01711"></a>01711   <span class="comment">// Limit that triggers a global GC as soon as is reasonable.  This is</span>
<a name="l01712"></a>01712   <span class="comment">// checked before expanding a paged space in the old generation and on</span>
<a name="l01713"></a>01713   <span class="comment">// every allocation in large object space.</span>
<a name="l01714"></a>01714   intptr_t old_gen_allocation_limit_;
<a name="l01715"></a>01715 
<a name="l01716"></a>01716   <span class="comment">// Sometimes the heuristics dictate that those limits are increased.  This</span>
<a name="l01717"></a>01717   <span class="comment">// variable records that fact.</span>
<a name="l01718"></a>01718   <span class="keywordtype">int</span> old_gen_limit_factor_;
<a name="l01719"></a>01719 
<a name="l01720"></a>01720   <span class="comment">// Used to adjust the limits that control the timing of the next GC.</span>
<a name="l01721"></a>01721   intptr_t size_of_old_gen_at_last_old_space_gc_;
<a name="l01722"></a>01722 
<a name="l01723"></a>01723   <span class="comment">// Limit on the amount of externally allocated memory allowed</span>
<a name="l01724"></a>01724   <span class="comment">// between global GCs. If reached a global GC is forced.</span>
<a name="l01725"></a>01725   intptr_t external_allocation_limit_;
<a name="l01726"></a>01726 
<a name="l01727"></a>01727   <span class="comment">// The amount of external memory registered through the API kept alive</span>
<a name="l01728"></a>01728   <span class="comment">// by global handles</span>
<a name="l01729"></a>01729   intptr_t amount_of_external_allocated_memory_;
<a name="l01730"></a>01730 
<a name="l01731"></a>01731   <span class="comment">// Caches the amount of external memory registered at the last global gc.</span>
<a name="l01732"></a>01732   intptr_t amount_of_external_allocated_memory_at_last_global_gc_;
<a name="l01733"></a>01733 
<a name="l01734"></a>01734   <span class="comment">// Indicates that an allocation has failed in the old generation since the</span>
<a name="l01735"></a>01735   <span class="comment">// last GC.</span>
<a name="l01736"></a>01736   <span class="keywordtype">int</span> old_gen_exhausted_;
<a name="l01737"></a>01737 
<a name="l01738"></a>01738   <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* global_contexts_list_;
<a name="l01739"></a>01739 
<a name="l01740"></a>01740   StoreBufferRebuilder store_buffer_rebuilder_;
<a name="l01741"></a>01741 
<a name="l01742"></a>01742   <span class="keyword">struct </span>StringTypeTable {
<a name="l01743"></a>01743     <a class="code" href="namespacev8_1_1internal.html#a62f89b8df648b3e45bce097100c2ab9b">InstanceType</a> <a class="code" href="namespacev8_1_1internal.html#af325044478c719d86be7dc7a017f250a">type</a>;
<a name="l01744"></a>01744     <span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>;
<a name="l01745"></a>01745     <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dce">RootListIndex</a> index;
<a name="l01746"></a>01746   };
<a name="l01747"></a>01747 
<a name="l01748"></a>01748   <span class="keyword">struct </span>ConstantSymbolTable {
<a name="l01749"></a>01749     <span class="keyword">const</span> <span class="keywordtype">char</span>* contents;
<a name="l01750"></a>01750     <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dce">RootListIndex</a> index;
<a name="l01751"></a>01751   };
<a name="l01752"></a>01752 
<a name="l01753"></a>01753   <span class="keyword">struct </span>StructTable {
<a name="l01754"></a>01754     <a class="code" href="namespacev8_1_1internal.html#a62f89b8df648b3e45bce097100c2ab9b">InstanceType</a> <a class="code" href="namespacev8_1_1internal.html#af325044478c719d86be7dc7a017f250a">type</a>;
<a name="l01755"></a>01755     <span class="keywordtype">int</span> <a class="code" href="namespacev8_1_1internal.html#abf135806b67fe9f9a823fbbbe25de86b">size</a>;
<a name="l01756"></a>01756     <a class="code" href="classv8_1_1internal_1_1_heap.html#a1200483a0a6174ca571af94ba5ad1dce">RootListIndex</a> index;
<a name="l01757"></a>01757   };
<a name="l01758"></a>01758 
<a name="l01759"></a>01759   <span class="keyword">static</span> <span class="keyword">const</span> StringTypeTable string_type_table[];
<a name="l01760"></a>01760   <span class="keyword">static</span> <span class="keyword">const</span> ConstantSymbolTable constant_symbol_table[];
<a name="l01761"></a>01761   <span class="keyword">static</span> <span class="keyword">const</span> StructTable struct_table[];
<a name="l01762"></a>01762 
<a name="l01763"></a>01763   <span class="comment">// The special hidden symbol which is an empty string, but does not match</span>
<a name="l01764"></a>01764   <span class="comment">// any string when looked up in properties.</span>
<a name="l01765"></a>01765   String* hidden_symbol_;
<a name="l01766"></a>01766 
<a name="l01767"></a>01767   <span class="comment">// GC callback function, called before and after mark-compact GC.</span>
<a name="l01768"></a>01768   <span class="comment">// Allocations in the callback function are disallowed.</span>
<a name="l01769"></a>01769   <span class="keyword">struct </span>GCPrologueCallbackPair {
<a name="l01770"></a>01770     GCPrologueCallbackPair(<a class="code" href="namespacev8.html#ab1b8c05dd6d75d0fbed8902b63580ed1">GCPrologueCallback</a> callback, <a class="code" href="namespacev8.html#ac109d6f27e0c0f9ef4e98bcf7a806cf2">GCType</a> gc_type)
<a name="l01771"></a>01771         : callback(callback), gc_type(gc_type) {
<a name="l01772"></a>01772     }
<a name="l01773"></a>01773     <span class="keywordtype">bool</span> operator==(<span class="keyword">const</span> GCPrologueCallbackPair&amp; pair)<span class="keyword"> const </span>{
<a name="l01774"></a>01774       <span class="keywordflow">return</span> pair.callback == callback;
<a name="l01775"></a>01775     }
<a name="l01776"></a>01776     <a class="code" href="namespacev8.html#ab1b8c05dd6d75d0fbed8902b63580ed1">GCPrologueCallback</a> callback;
<a name="l01777"></a>01777     <a class="code" href="namespacev8.html#ac109d6f27e0c0f9ef4e98bcf7a806cf2">GCType</a> gc_type;
<a name="l01778"></a>01778   };
<a name="l01779"></a>01779   List&lt;GCPrologueCallbackPair&gt; gc_prologue_callbacks_;
<a name="l01780"></a>01780 
<a name="l01781"></a>01781   <span class="keyword">struct </span>GCEpilogueCallbackPair {
<a name="l01782"></a>01782     GCEpilogueCallbackPair(<a class="code" href="namespacev8.html#a220aa1e29ecc75f460d8dbd765b66435">GCEpilogueCallback</a> callback, <a class="code" href="namespacev8.html#ac109d6f27e0c0f9ef4e98bcf7a806cf2">GCType</a> gc_type)
<a name="l01783"></a>01783         : callback(callback), gc_type(gc_type) {
<a name="l01784"></a>01784     }
<a name="l01785"></a>01785     <span class="keywordtype">bool</span> operator==(<span class="keyword">const</span> GCEpilogueCallbackPair&amp; pair)<span class="keyword"> const </span>{
<a name="l01786"></a>01786       <span class="keywordflow">return</span> pair.callback == callback;
<a name="l01787"></a>01787     }
<a name="l01788"></a>01788     <a class="code" href="namespacev8.html#a220aa1e29ecc75f460d8dbd765b66435">GCEpilogueCallback</a> callback;
<a name="l01789"></a>01789     <a class="code" href="namespacev8.html#ac109d6f27e0c0f9ef4e98bcf7a806cf2">GCType</a> gc_type;
<a name="l01790"></a>01790   };
<a name="l01791"></a>01791   List&lt;GCEpilogueCallbackPair&gt; gc_epilogue_callbacks_;
<a name="l01792"></a>01792 
<a name="l01793"></a>01793   <a class="code" href="namespacev8.html#a0559691fb5494dd5a54c5e4d3e3d1388">GCCallback</a> global_gc_prologue_callback_;
<a name="l01794"></a>01794   <a class="code" href="namespacev8.html#a0559691fb5494dd5a54c5e4d3e3d1388">GCCallback</a> global_gc_epilogue_callback_;
<a name="l01795"></a>01795 
<a name="l01796"></a>01796   <span class="comment">// Support for computing object sizes during GC.</span>
<a name="l01797"></a>01797   <a class="code" href="namespacev8_1_1internal.html#a4664a14735f154f774c9130702904468">HeapObjectCallback</a> gc_safe_size_of_old_object_;
<a name="l01798"></a>01798   <span class="keyword">static</span> <span class="keywordtype">int</span> GcSafeSizeOfOldObject(HeapObject* <span class="keywordtype">object</span>);
<a name="l01799"></a>01799 
<a name="l01800"></a>01800   <span class="comment">// Update the GC state. Called from the mark-compact collector.</span>
<a name="l01801"></a>01801   <span class="keywordtype">void</span> MarkMapPointersAsEncoded(<span class="keywordtype">bool</span> encoded) {
<a name="l01802"></a>01802     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(!encoded);
<a name="l01803"></a>01803     gc_safe_size_of_old_object_ = &amp;GcSafeSizeOfOldObject;
<a name="l01804"></a>01804   }
<a name="l01805"></a>01805 
<a name="l01806"></a>01806   <span class="comment">// Checks whether a global GC is necessary</span>
<a name="l01807"></a>01807   <a class="code" href="namespacev8_1_1internal.html#ad504e70236bfcc0478d67053d1ed9ac0">GarbageCollector</a> SelectGarbageCollector(<a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fef">AllocationSpace</a> space,
<a name="l01808"></a>01808                                           <span class="keyword">const</span> <span class="keywordtype">char</span>** reason);
<a name="l01809"></a>01809 
<a name="l01810"></a>01810   <span class="comment">// Performs garbage collection</span>
<a name="l01811"></a>01811   <span class="comment">// Returns whether there is a chance another major GC could</span>
<a name="l01812"></a>01812   <span class="comment">// collect more garbage.</span>
<a name="l01813"></a>01813   <span class="keywordtype">bool</span> PerformGarbageCollection(<a class="code" href="namespacev8_1_1internal.html#ad504e70236bfcc0478d67053d1ed9ac0">GarbageCollector</a> collector,
<a name="l01814"></a>01814                                 <a class="code" href="classv8_1_1internal_1_1_heap.html#af0a250e40f134d7b35c7c22304f35304">GCTracer</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#abdd7e3821604a14452281640366cc9bb">tracer</a>);
<a name="l01815"></a>01815 
<a name="l01816"></a>01816 
<a name="l01817"></a>01817   <span class="keyword">inline</span> <span class="keywordtype">void</span> UpdateOldSpaceLimits();
<a name="l01818"></a>01818 
<a name="l01819"></a>01819   <span class="comment">// Allocate an uninitialized object in map space.  The behavior is identical</span>
<a name="l01820"></a>01820   <span class="comment">// to Heap::AllocateRaw(size_in_bytes, MAP_SPACE), except that (a) it doesn&#39;t</span>
<a name="l01821"></a>01821   <span class="comment">// have to test the allocation space argument and (b) can reduce code size</span>
<a name="l01822"></a>01822   <span class="comment">// (since both AllocateRaw and AllocateRawMap are inlined).</span>
<a name="l01823"></a>01823   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* AllocateRawMap();
<a name="l01824"></a>01824 
<a name="l01825"></a>01825   <span class="comment">// Allocate an uninitialized object in the global property cell space.</span>
<a name="l01826"></a>01826   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* AllocateRawCell();
<a name="l01827"></a>01827 
<a name="l01828"></a>01828   <span class="comment">// Initializes a JSObject based on its map.</span>
<a name="l01829"></a>01829   <span class="keywordtype">void</span> InitializeJSObjectFromMap(JSObject* obj,
<a name="l01830"></a>01830                                  FixedArray* properties,
<a name="l01831"></a>01831                                  Map* map);
<a name="l01832"></a>01832 
<a name="l01833"></a>01833   <span class="keywordtype">bool</span> CreateInitialMaps();
<a name="l01834"></a>01834   <span class="keywordtype">bool</span> CreateInitialObjects();
<a name="l01835"></a>01835 
<a name="l01836"></a>01836   <span class="comment">// These five Create*EntryStub functions are here and forced to not be inlined</span>
<a name="l01837"></a>01837   <span class="comment">// because of a gcc-4.4 bug that assigns wrong vtable entries.</span>
<a name="l01838"></a>01838   NO_INLINE(<span class="keywordtype">void</span> CreateJSEntryStub());
<a name="l01839"></a>01839   NO_INLINE(<span class="keywordtype">void</span> CreateJSConstructEntryStub());
<a name="l01840"></a>01840 
<a name="l01841"></a>01841   <span class="keywordtype">void</span> CreateFixedStubs();
<a name="l01842"></a>01842 
<a name="l01843"></a>01843   MaybeObject* CreateOddball(<span class="keyword">const</span> <span class="keywordtype">char</span>* to_string,
<a name="l01844"></a>01844                              <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* to_number,
<a name="l01845"></a>01845                              <a class="code" href="namespacev8_1_1internal.html#af7faf565f54e78c34be0c228fae4af12">byte</a> kind);
<a name="l01846"></a>01846 
<a name="l01847"></a>01847   <span class="comment">// Allocate a JSArray with no elements</span>
<a name="l01848"></a>01848   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* AllocateJSArray(
<a name="l01849"></a>01849       <a class="code" href="namespacev8_1_1internal.html#a63689e64c196a95ef58c92ea3134ce31">ElementsKind</a> elements_kind,
<a name="l01850"></a>01850       <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8">PretenureFlag</a> pretenure = <a class="code" href="namespacev8_1_1internal.html#a4b432e00268a8cdaef5449ccbe9b38c8ad832954c9b9b14ec2859d74a80f4069a">NOT_TENURED</a>);
<a name="l01851"></a>01851 
<a name="l01852"></a>01852   <span class="comment">// Allocate empty fixed array.</span>
<a name="l01853"></a>01853   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* AllocateEmptyFixedArray();
<a name="l01854"></a>01854 
<a name="l01855"></a>01855   <span class="comment">// Allocate empty fixed double array.</span>
<a name="l01856"></a>01856   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* AllocateEmptyFixedDoubleArray();
<a name="l01857"></a>01857 
<a name="l01858"></a>01858   <span class="comment">// Performs a minor collection in new generation.</span>
<a name="l01859"></a>01859   <span class="keywordtype">void</span> Scavenge();
<a name="l01860"></a>01860 
<a name="l01861"></a>01861   <span class="keyword">static</span> String* UpdateNewSpaceReferenceInExternalStringTableEntry(
<a name="l01862"></a>01862       Heap* heap,
<a name="l01863"></a>01863       <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>** pointer);
<a name="l01864"></a>01864 
<a name="l01865"></a>01865   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> DoScavenge(ObjectVisitor* scavenge_visitor, <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> new_space_front);
<a name="l01866"></a>01866   <span class="keyword">static</span> <span class="keywordtype">void</span> ScavengeStoreBufferCallback(Heap* heap,
<a name="l01867"></a>01867                                           MemoryChunk* page,
<a name="l01868"></a>01868                                           <a class="code" href="namespacev8_1_1internal.html#a64d7c87386ac80c1e616cbfc6bb4446a">StoreBufferEvent</a> event);
<a name="l01869"></a>01869 
<a name="l01870"></a>01870   <span class="comment">// Performs a major collection in the whole heap.</span>
<a name="l01871"></a>01871   <span class="keywordtype">void</span> MarkCompact(<a class="code" href="classv8_1_1internal_1_1_heap.html#af0a250e40f134d7b35c7c22304f35304">GCTracer</a>* <a class="code" href="classv8_1_1internal_1_1_heap.html#abdd7e3821604a14452281640366cc9bb">tracer</a>);
<a name="l01872"></a>01872 
<a name="l01873"></a>01873   <span class="comment">// Code to be run before and after mark-compact.</span>
<a name="l01874"></a>01874   <span class="keywordtype">void</span> MarkCompactPrologue();
<a name="l01875"></a>01875 
<a name="l01876"></a>01876   <span class="comment">// Record statistics before and after garbage collection.</span>
<a name="l01877"></a>01877   <span class="keywordtype">void</span> ReportStatisticsBeforeGC();
<a name="l01878"></a>01878   <span class="keywordtype">void</span> ReportStatisticsAfterGC();
<a name="l01879"></a>01879 
<a name="l01880"></a>01880   <span class="comment">// Slow part of scavenge object.</span>
<a name="l01881"></a>01881   <span class="keyword">static</span> <span class="keywordtype">void</span> ScavengeObjectSlow(HeapObject** p, HeapObject* <span class="keywordtype">object</span>);
<a name="l01882"></a>01882 
<a name="l01883"></a>01883   <span class="comment">// Initializes a function with a shared part and prototype.</span>
<a name="l01884"></a>01884   <span class="comment">// Note: this code was factored out of AllocateFunction such that</span>
<a name="l01885"></a>01885   <span class="comment">// other parts of the VM could use it. Specifically, a function that creates</span>
<a name="l01886"></a>01886   <span class="comment">// instances of type JS_FUNCTION_TYPE benefit from the use of this function.</span>
<a name="l01887"></a>01887   <span class="comment">// Please note this does not perform a garbage collection.</span>
<a name="l01888"></a>01888   <span class="keyword">inline</span> <span class="keywordtype">void</span> InitializeFunction(
<a name="l01889"></a>01889       JSFunction* <span class="keyword">function</span>,
<a name="l01890"></a>01890       SharedFunctionInfo* shared,
<a name="l01891"></a>01891       <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* prototype);
<a name="l01892"></a>01892 
<a name="l01893"></a>01893   <span class="comment">// Total RegExp code ever generated</span>
<a name="l01894"></a>01894   <span class="keywordtype">double</span> total_regexp_code_generated_;
<a name="l01895"></a>01895 
<a name="l01896"></a>01896   <a class="code" href="classv8_1_1internal_1_1_heap.html#af0a250e40f134d7b35c7c22304f35304">GCTracer</a>* tracer_;
<a name="l01897"></a>01897 
<a name="l01898"></a>01898 
<a name="l01899"></a>01899   <span class="comment">// Allocates a small number to string cache.</span>
<a name="l01900"></a>01900   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> MaybeObject* AllocateInitialNumberStringCache();
<a name="l01901"></a>01901   <span class="comment">// Creates and installs the full-sized number string cache.</span>
<a name="l01902"></a>01902   <span class="keywordtype">void</span> AllocateFullSizeNumberStringCache();
<a name="l01903"></a>01903   <span class="comment">// Get the length of the number to string cache based on the max semispace</span>
<a name="l01904"></a>01904   <span class="comment">// size.</span>
<a name="l01905"></a>01905   <span class="keywordtype">int</span> FullSizeNumberStringCacheLength();
<a name="l01906"></a>01906   <span class="comment">// Flush the number to string cache.</span>
<a name="l01907"></a>01907   <span class="keywordtype">void</span> FlushNumberStringCache();
<a name="l01908"></a>01908 
<a name="l01909"></a>01909   <span class="keywordtype">void</span> UpdateSurvivalRateTrend(<span class="keywordtype">int</span> start_new_space_size);
<a name="l01910"></a>01910 
<a name="l01911"></a>01911   <span class="keyword">enum</span> SurvivalRateTrend { INCREASING, STABLE, DECREASING, FLUCTUATING };
<a name="l01912"></a>01912 
<a name="l01913"></a>01913   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kYoungSurvivalRateHighThreshold = 90;
<a name="l01914"></a>01914   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kYoungSurvivalRateLowThreshold = 10;
<a name="l01915"></a>01915   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kYoungSurvivalRateAllowedDeviation = 15;
<a name="l01916"></a>01916 
<a name="l01917"></a>01917   <span class="keywordtype">int</span> young_survivors_after_last_gc_;
<a name="l01918"></a>01918   <span class="keywordtype">int</span> high_survival_rate_period_length_;
<a name="l01919"></a>01919   <span class="keywordtype">int</span> low_survival_rate_period_length_;
<a name="l01920"></a>01920   <span class="keywordtype">double</span> survival_rate_;
<a name="l01921"></a>01921   SurvivalRateTrend previous_survival_rate_trend_;
<a name="l01922"></a>01922   SurvivalRateTrend survival_rate_trend_;
<a name="l01923"></a>01923 
<a name="l01924"></a>01924   <span class="keywordtype">void</span> set_survival_rate_trend(SurvivalRateTrend survival_rate_trend) {
<a name="l01925"></a>01925     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(survival_rate_trend != FLUCTUATING);
<a name="l01926"></a>01926     previous_survival_rate_trend_ = survival_rate_trend_;
<a name="l01927"></a>01927     survival_rate_trend_ = survival_rate_trend;
<a name="l01928"></a>01928   }
<a name="l01929"></a>01929 
<a name="l01930"></a>01930   SurvivalRateTrend survival_rate_trend() {
<a name="l01931"></a>01931     <span class="keywordflow">if</span> (survival_rate_trend_ == STABLE) {
<a name="l01932"></a>01932       <span class="keywordflow">return</span> STABLE;
<a name="l01933"></a>01933     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (previous_survival_rate_trend_ == STABLE) {
<a name="l01934"></a>01934       <span class="keywordflow">return</span> survival_rate_trend_;
<a name="l01935"></a>01935     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (survival_rate_trend_ != previous_survival_rate_trend_) {
<a name="l01936"></a>01936       <span class="keywordflow">return</span> FLUCTUATING;
<a name="l01937"></a>01937     } <span class="keywordflow">else</span> {
<a name="l01938"></a>01938       <span class="keywordflow">return</span> survival_rate_trend_;
<a name="l01939"></a>01939     }
<a name="l01940"></a>01940   }
<a name="l01941"></a>01941 
<a name="l01942"></a>01942   <span class="keywordtype">bool</span> IsStableOrIncreasingSurvivalTrend() {
<a name="l01943"></a>01943     <span class="keywordflow">switch</span> (survival_rate_trend()) {
<a name="l01944"></a>01944       <span class="keywordflow">case</span> STABLE:
<a name="l01945"></a>01945       <span class="keywordflow">case</span> INCREASING:
<a name="l01946"></a>01946         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01947"></a>01947       <span class="keywordflow">default</span>:
<a name="l01948"></a>01948         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01949"></a>01949     }
<a name="l01950"></a>01950   }
<a name="l01951"></a>01951 
<a name="l01952"></a>01952   <span class="keywordtype">bool</span> IsStableOrDecreasingSurvivalTrend() {
<a name="l01953"></a>01953     <span class="keywordflow">switch</span> (survival_rate_trend()) {
<a name="l01954"></a>01954       <span class="keywordflow">case</span> STABLE:
<a name="l01955"></a>01955       <span class="keywordflow">case</span> DECREASING:
<a name="l01956"></a>01956         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01957"></a>01957       <span class="keywordflow">default</span>:
<a name="l01958"></a>01958         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01959"></a>01959     }
<a name="l01960"></a>01960   }
<a name="l01961"></a>01961 
<a name="l01962"></a>01962   <span class="keywordtype">bool</span> IsIncreasingSurvivalTrend() {
<a name="l01963"></a>01963     <span class="keywordflow">return</span> survival_rate_trend() == INCREASING;
<a name="l01964"></a>01964   }
<a name="l01965"></a>01965 
<a name="l01966"></a>01966   <span class="keywordtype">bool</span> IsHighSurvivalRate() {
<a name="l01967"></a>01967     <span class="keywordflow">return</span> high_survival_rate_period_length_ &gt; 0;
<a name="l01968"></a>01968   }
<a name="l01969"></a>01969 
<a name="l01970"></a>01970   <span class="keywordtype">bool</span> IsLowSurvivalRate() {
<a name="l01971"></a>01971     <span class="keywordflow">return</span> low_survival_rate_period_length_ &gt; 0;
<a name="l01972"></a>01972   }
<a name="l01973"></a>01973 
<a name="l01974"></a>01974   <span class="keywordtype">void</span> SelectScavengingVisitorsTable();
<a name="l01975"></a>01975 
<a name="l01976"></a>01976   <span class="keywordtype">void</span> StartIdleRound() {
<a name="l01977"></a>01977     mark_sweeps_since_idle_round_started_ = 0;
<a name="l01978"></a>01978     ms_count_at_last_idle_notification_ = ms_count_;
<a name="l01979"></a>01979   }
<a name="l01980"></a>01980 
<a name="l01981"></a>01981   <span class="keywordtype">void</span> FinishIdleRound() {
<a name="l01982"></a>01982     mark_sweeps_since_idle_round_started_ = kMaxMarkSweepsInIdleRound;
<a name="l01983"></a>01983     scavenges_since_last_idle_round_ = 0;
<a name="l01984"></a>01984   }
<a name="l01985"></a>01985 
<a name="l01986"></a>01986   <span class="keywordtype">bool</span> EnoughGarbageSinceLastIdleRound() {
<a name="l01987"></a>01987     <span class="keywordflow">return</span> (scavenges_since_last_idle_round_ &gt;= kIdleScavengeThreshold);
<a name="l01988"></a>01988   }
<a name="l01989"></a>01989 
<a name="l01990"></a>01990   <span class="keywordtype">bool</span> WorthStartingGCWhenIdle() {
<a name="l01991"></a>01991     <span class="keywordflow">if</span> (contexts_disposed_ &gt; 0) {
<a name="l01992"></a>01992       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01993"></a>01993     }
<a name="l01994"></a>01994     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_heap.html#ab22cdb999c73da6215619ad67bbd13d4">incremental_marking</a>()-&gt;<a class="code" href="classv8_1_1internal_1_1_incremental_marking.html#a11542d65656a552ad2a7d10266b51a60">WorthActivating</a>();
<a name="l01995"></a>01995   }
<a name="l01996"></a>01996 
<a name="l01997"></a>01997   <span class="comment">// Estimates how many milliseconds a Mark-Sweep would take to complete.</span>
<a name="l01998"></a>01998   <span class="comment">// In idle notification handler we assume that this function will return:</span>
<a name="l01999"></a>01999   <span class="comment">// - a number less than 10 for small heaps, which are less than 8Mb.</span>
<a name="l02000"></a>02000   <span class="comment">// - a number greater than 10 for large heaps, which are greater than 32Mb.</span>
<a name="l02001"></a>02001   <span class="keywordtype">int</span> TimeMarkSweepWouldTakeInMs() {
<a name="l02002"></a>02002     <span class="comment">// Rough estimate of how many megabytes of heap can be processed in 1 ms.</span>
<a name="l02003"></a>02003     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kMbPerMs = 2;
<a name="l02004"></a>02004 
<a name="l02005"></a>02005     <span class="keywordtype">int</span> heap_size_mb = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classv8_1_1internal_1_1_heap.html#ae864c40e24bf7d6fcdbfbf97ac309d14">SizeOfObjects</a>() / <a class="code" href="namespacev8_1_1internal.html#ac9348d43b27afd1b556903717cbe0b84">MB</a>);
<a name="l02006"></a>02006     <span class="keywordflow">return</span> heap_size_mb / kMbPerMs;
<a name="l02007"></a>02007   }
<a name="l02008"></a>02008 
<a name="l02009"></a>02009   <span class="comment">// Returns true if no more GC work is left.</span>
<a name="l02010"></a>02010   <span class="keywordtype">bool</span> IdleGlobalGC();
<a name="l02011"></a>02011 
<a name="l02012"></a>02012   <span class="keywordtype">void</span> AdvanceIdleIncrementalMarking(intptr_t step_size);
<a name="l02013"></a>02013 
<a name="l02014"></a>02014 
<a name="l02015"></a>02015   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kInitialSymbolTableSize = 2048;
<a name="l02016"></a>02016   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kInitialEvalCacheSize = 64;
<a name="l02017"></a>02017   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kInitialNumberStringCacheSize = 256;
<a name="l02018"></a>02018 
<a name="l02019"></a>02019   <span class="comment">// Maximum GC pause.</span>
<a name="l02020"></a>02020   <span class="keywordtype">int</span> max_gc_pause_;
<a name="l02021"></a>02021 
<a name="l02022"></a>02022   <span class="comment">// Maximum size of objects alive after GC.</span>
<a name="l02023"></a>02023   intptr_t max_alive_after_gc_;
<a name="l02024"></a>02024 
<a name="l02025"></a>02025   <span class="comment">// Minimal interval between two subsequent collections.</span>
<a name="l02026"></a>02026   <span class="keywordtype">int</span> min_in_mutator_;
<a name="l02027"></a>02027 
<a name="l02028"></a>02028   <span class="comment">// Size of objects alive after last GC.</span>
<a name="l02029"></a>02029   intptr_t alive_after_last_gc_;
<a name="l02030"></a>02030 
<a name="l02031"></a>02031   <span class="keywordtype">double</span> last_gc_end_timestamp_;
<a name="l02032"></a>02032 
<a name="l02033"></a>02033   <a class="code" href="classv8_1_1internal_1_1_heap.html#ae585a96455613b2bc2ae3ea75a061d8b">MarkCompactCollector</a> mark_compact_collector_;
<a name="l02034"></a>02034 
<a name="l02035"></a>02035   StoreBuffer store_buffer_;
<a name="l02036"></a>02036 
<a name="l02037"></a>02037   Marking marking_;
<a name="l02038"></a>02038 
<a name="l02039"></a>02039   IncrementalMarking incremental_marking_;
<a name="l02040"></a>02040 
<a name="l02041"></a>02041   <span class="keywordtype">int</span> number_idle_notifications_;
<a name="l02042"></a>02042   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> last_idle_notification_gc_count_;
<a name="l02043"></a>02043   <span class="keywordtype">bool</span> last_idle_notification_gc_count_init_;
<a name="l02044"></a>02044 
<a name="l02045"></a>02045   <span class="keywordtype">int</span> mark_sweeps_since_idle_round_started_;
<a name="l02046"></a>02046   <span class="keywordtype">int</span> ms_count_at_last_idle_notification_;
<a name="l02047"></a>02047   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gc_count_at_last_idle_gc_;
<a name="l02048"></a>02048   <span class="keywordtype">int</span> scavenges_since_last_idle_round_;
<a name="l02049"></a>02049 
<a name="l02050"></a>02050   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kMaxMarkSweepsInIdleRound = 7;
<a name="l02051"></a>02051   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kIdleScavengeThreshold = 5;
<a name="l02052"></a>02052 
<a name="l02053"></a>02053   <span class="comment">// Shared state read by the scavenge collector and set by ScavengeObject.</span>
<a name="l02054"></a>02054   PromotionQueue promotion_queue_;
<a name="l02055"></a>02055 
<a name="l02056"></a>02056   <span class="comment">// Flag is set when the heap has been configured.  The heap can be repeatedly</span>
<a name="l02057"></a>02057   <span class="comment">// configured through the API until it is set up.</span>
<a name="l02058"></a>02058   <span class="keywordtype">bool</span> configured_;
<a name="l02059"></a>02059 
<a name="l02060"></a>02060   ExternalStringTable external_string_table_;
<a name="l02061"></a>02061 
<a name="l02062"></a>02062   VisitorDispatchTable&lt;ScavengingCallback&gt; scavenging_visitors_table_;
<a name="l02063"></a>02063 
<a name="l02064"></a>02064   MemoryChunk* chunks_queued_for_free_;
<a name="l02065"></a>02065 
<a name="l02066"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a328c093d609680cca505905c6d49901a">02066</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_factory.html">Factory</a>;
<a name="l02067"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#af0a250e40f134d7b35c7c22304f35304">02067</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_heap.html#af0a250e40f134d7b35c7c22304f35304">GCTracer</a>;
<a name="l02068"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ae6f90da640d56c7d01a27bbf2548b01a">02068</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_heap.html#ae6f90da640d56c7d01a27bbf2548b01a">DisallowAllocationFailure</a>;
<a name="l02069"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ac91b5d86c9421c14c5d1ac542e048fa7">02069</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_always_allocate_scope.html">AlwaysAllocateScope</a>;
<a name="l02070"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aff37ce474030f740784335939197ebae">02070</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_linear_allocation_scope.html">LinearAllocationScope</a>;
<a name="l02071"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a66d145c56e1747e0aecb5309042ab183">02071</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_page.html">Page</a>;
<a name="l02072"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#aba4f0964bdacf2bbf62cf876e5d28d0a">02072</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_isolate.html">Isolate</a>;
<a name="l02073"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ae585a96455613b2bc2ae3ea75a061d8b">02073</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_mark_compact_collector.html">MarkCompactCollector</a>;
<a name="l02074"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#ad42cef5e8ec0ae50c8206f6a850897b2">02074</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_static_marking_visitor.html">StaticMarkingVisitor</a>;
<a name="l02075"></a><a class="code" href="classv8_1_1internal_1_1_heap.html#a5a70c7bdb3b6dd9c6371f9f9a88b9194">02075</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_heap.html#a5a70c7bdb3b6dd9c6371f9f9a88b9194">MapCompact</a>;
<a name="l02076"></a>02076 
<a name="l02077"></a>02077   <a class="code" href="globals_8h.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(<a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>);
<a name="l02078"></a>02078 };
<a name="l02079"></a>02079 
<a name="l02080"></a>02080 
<a name="l02081"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html">02081</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_heap_stats.html">HeapStats</a> {
<a name="l02082"></a>02082  <span class="keyword">public</span>:
<a name="l02083"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a205765088d14ac30ada403e983dc12da">02083</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a205765088d14ac30ada403e983dc12da">kStartMarker</a> = 0xDECADE00;
<a name="l02084"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a615e1138a3309a8a1a875f9aa93bf0ee">02084</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a615e1138a3309a8a1a875f9aa93bf0ee">kEndMarker</a> = 0xDECADE01;
<a name="l02085"></a>02085 
<a name="l02086"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a1998bb2460c951bcf71995671078da17">02086</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a1998bb2460c951bcf71995671078da17">start_marker</a>;                    <span class="comment">//  0</span>
<a name="l02087"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ac399ed971be498880eec7386980b4881">02087</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ac399ed971be498880eec7386980b4881">new_space_size</a>;                  <span class="comment">//  1</span>
<a name="l02088"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ab41654f198741bd084ed450ac0dde603">02088</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ab41654f198741bd084ed450ac0dde603">new_space_capacity</a>;              <span class="comment">//  2</span>
<a name="l02089"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a59e873826d970c3d02bb86e73d829f15">02089</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a59e873826d970c3d02bb86e73d829f15">old_pointer_space_size</a>;          <span class="comment">//  3</span>
<a name="l02090"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#acc58355769672e2b06f037dbae5dac1e">02090</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#acc58355769672e2b06f037dbae5dac1e">old_pointer_space_capacity</a>;      <span class="comment">//  4</span>
<a name="l02091"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a4a2753119fe915c05f41a8d068366023">02091</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a4a2753119fe915c05f41a8d068366023">old_data_space_size</a>;             <span class="comment">//  5</span>
<a name="l02092"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#aa620ede3a1c08f2dad95d14c86b44169">02092</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#aa620ede3a1c08f2dad95d14c86b44169">old_data_space_capacity</a>;         <span class="comment">//  6</span>
<a name="l02093"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a01040c93d237d0e4ec78579df24c9f3b">02093</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a01040c93d237d0e4ec78579df24c9f3b">code_space_size</a>;                 <span class="comment">//  7</span>
<a name="l02094"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a2a5872a10dfc22ed0e56207f99e1a125">02094</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a2a5872a10dfc22ed0e56207f99e1a125">code_space_capacity</a>;             <span class="comment">//  8</span>
<a name="l02095"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a0c83704cc1b0539d1390e26e73cdd448">02095</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a0c83704cc1b0539d1390e26e73cdd448">map_space_size</a>;                  <span class="comment">//  9</span>
<a name="l02096"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a16a211a7f12d2754b070ae5f18afcadf">02096</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a16a211a7f12d2754b070ae5f18afcadf">map_space_capacity</a>;              <span class="comment">// 10</span>
<a name="l02097"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a517544c3a75d26bbd4ac0408fa51bb74">02097</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a517544c3a75d26bbd4ac0408fa51bb74">cell_space_size</a>;                 <span class="comment">// 11</span>
<a name="l02098"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#af670c4edb24da1166362bc3aed4b1d67">02098</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#af670c4edb24da1166362bc3aed4b1d67">cell_space_capacity</a>;             <span class="comment">// 12</span>
<a name="l02099"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a295e0bd7c3b0005e999740ffd37625fa">02099</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a295e0bd7c3b0005e999740ffd37625fa">lo_space_size</a>;                   <span class="comment">// 13</span>
<a name="l02100"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a6d116bd2ab98de420aadf7f86a4fe23b">02100</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a6d116bd2ab98de420aadf7f86a4fe23b">global_handle_count</a>;             <span class="comment">// 14</span>
<a name="l02101"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ac4332c539448bb848bd2f7f68e9b8749">02101</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ac4332c539448bb848bd2f7f68e9b8749">weak_global_handle_count</a>;        <span class="comment">// 15</span>
<a name="l02102"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a6ec4e17349e2fb55762e71fee71755d5">02102</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a6ec4e17349e2fb55762e71fee71755d5">pending_global_handle_count</a>;     <span class="comment">// 16</span>
<a name="l02103"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a1a13734a2f6efd3a3bfdeabc9fff4934">02103</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a1a13734a2f6efd3a3bfdeabc9fff4934">near_death_global_handle_count</a>;  <span class="comment">// 17</span>
<a name="l02104"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ac8b9c47969b4b88a610f9eb189d9a63d">02104</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#ac8b9c47969b4b88a610f9eb189d9a63d">free_global_handle_count</a>;        <span class="comment">// 18</span>
<a name="l02105"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a9676bf7565a25e1aa4f2a787add18d1d">02105</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a9676bf7565a25e1aa4f2a787add18d1d">memory_allocator_size</a>;           <span class="comment">// 19</span>
<a name="l02106"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a30176cd85df9e8c70ed6270bd1b8b17f">02106</a>   intptr_t* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a30176cd85df9e8c70ed6270bd1b8b17f">memory_allocator_capacity</a>;       <span class="comment">// 20</span>
<a name="l02107"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#aac8323f5e3e9275f6077cc7748adc26f">02107</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#aac8323f5e3e9275f6077cc7748adc26f">objects_per_type</a>;                <span class="comment">// 21</span>
<a name="l02108"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a43971e9e49e8aecc301d8b582e6de31a">02108</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a43971e9e49e8aecc301d8b582e6de31a">size_per_type</a>;                   <span class="comment">// 22</span>
<a name="l02109"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#aa6205c52d7b9a5b80a103034c6dd134f">02109</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#aa6205c52d7b9a5b80a103034c6dd134f">os_error</a>;                        <span class="comment">// 23</span>
<a name="l02110"></a><a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a4d8063449d0c06ead66d72eacf2cd483">02110</a>   <span class="keywordtype">int</span>* <a class="code" href="classv8_1_1internal_1_1_heap_stats.html#a4d8063449d0c06ead66d72eacf2cd483">end_marker</a>;                      <span class="comment">// 24</span>
<a name="l02111"></a>02111 };
<a name="l02112"></a>02112 
<a name="l02113"></a>02113 
<a name="l02114"></a><a class="code" href="classv8_1_1internal_1_1_always_allocate_scope.html">02114</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_always_allocate_scope.html">AlwaysAllocateScope</a> {
<a name="l02115"></a>02115  <span class="keyword">public</span>:
<a name="l02116"></a>02116   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_always_allocate_scope.html#a5b208fd2d79c58d3630f383069a83ddd">AlwaysAllocateScope</a>();
<a name="l02117"></a>02117   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_always_allocate_scope.html#a021c3797ce9583b7b6e2c8a1c22a3794">~AlwaysAllocateScope</a>();
<a name="l02118"></a>02118 };
<a name="l02119"></a>02119 
<a name="l02120"></a>02120 
<a name="l02121"></a><a class="code" href="classv8_1_1internal_1_1_linear_allocation_scope.html">02121</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_linear_allocation_scope.html">LinearAllocationScope</a> {
<a name="l02122"></a>02122  <span class="keyword">public</span>:
<a name="l02123"></a>02123   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_linear_allocation_scope.html#aa31e220607d2c0409528c59b69e7dbb6">LinearAllocationScope</a>();
<a name="l02124"></a>02124   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_linear_allocation_scope.html#a9712f82eaeef1841200524a73e05f13c">~LinearAllocationScope</a>();
<a name="l02125"></a>02125 };
<a name="l02126"></a>02126 
<a name="l02127"></a>02127 
<a name="l02128"></a>02128 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l02129"></a>02129 <span class="preprocessor"></span><span class="comment">// Visitor class to verify interior pointers in spaces that do not contain</span>
<a name="l02130"></a>02130 <span class="comment">// or care about intergenerational references. All heap object pointers have to</span>
<a name="l02131"></a>02131 <span class="comment">// point into the heap to a location that has a map pointer at its first word.</span>
<a name="l02132"></a>02132 <span class="comment">// Caveat: Heap::Contains is an approximation because it can return true for</span>
<a name="l02133"></a>02133 <span class="comment">// objects in a heap space but above the allocation pointer.</span>
<a name="l02134"></a>02134 <span class="keyword">class </span>VerifyPointersVisitor: <span class="keyword">public</span> ObjectVisitor {
<a name="l02135"></a>02135  <span class="keyword">public</span>:
<a name="l02136"></a>02136   <span class="keyword">inline</span> <span class="keywordtype">void</span> VisitPointers(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>** <a class="code" href="namespacell__prof.html#a5b7aee10eba26bc62f35b1049906c277">start</a>, <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>** end);
<a name="l02137"></a>02137 };
<a name="l02138"></a>02138 <span class="preprocessor">#endif</span>
<a name="l02139"></a>02139 <span class="preprocessor"></span>
<a name="l02140"></a>02140 
<a name="l02141"></a>02141 <span class="comment">// Space iterator for iterating over all spaces of the heap.</span>
<a name="l02142"></a>02142 <span class="comment">// Returns each space in turn, and null when it is done.</span>
<a name="l02143"></a>02143 <span class="keyword">class </span>AllSpaces <a class="code" href="allocation_8h.html#abab81306d90d0b82732d5bed93a0a588">BASE_EMBEDDED</a> {
<a name="l02144"></a>02144  <span class="keyword">public</span>:
<a name="l02145"></a>02145   Space* next();
<a name="l02146"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a0aa990b59fd8587c405df54937854f21">02146</a>   <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a0aa990b59fd8587c405df54937854f21">AllSpaces</a>() { counter_ = <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fefa8cf2a359e9089d57b840cc0dda2745ca">FIRST_SPACE</a>; }
<a name="l02147"></a>02147  <span class="keyword">private</span>:
<a name="l02148"></a>02148   <span class="keywordtype">int</span> counter_;
<a name="l02149"></a>02149 };
<a name="l02150"></a>02150 
<a name="l02151"></a>02151 
<a name="l02152"></a>02152 <span class="comment">// Space iterator for iterating over all old spaces of the heap: Old pointer</span>
<a name="l02153"></a>02153 <span class="comment">// space, old data space and code space.</span>
<a name="l02154"></a>02154 <span class="comment">// Returns each space in turn, and null when it is done.</span>
<a name="l02155"></a>02155 <span class="keyword">class </span>OldSpaces <a class="code" href="allocation_8h.html#abab81306d90d0b82732d5bed93a0a588">BASE_EMBEDDED</a> {
<a name="l02156"></a>02156  <span class="keyword">public</span>:
<a name="l02157"></a>02157   OldSpace* next();
<a name="l02158"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a55afb2485247e7ad6801854c3ae88e88">02158</a>   <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a55afb2485247e7ad6801854c3ae88e88">OldSpaces</a>() { counter_ = <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fefac6eda4effa28334846379882a6b424d1">OLD_POINTER_SPACE</a>; }
<a name="l02159"></a>02159  <span class="keyword">private</span>:
<a name="l02160"></a>02160   <span class="keywordtype">int</span> counter_;
<a name="l02161"></a>02161 };
<a name="l02162"></a>02162 
<a name="l02163"></a>02163 
<a name="l02164"></a>02164 <span class="comment">// Space iterator for iterating over all the paged spaces of the heap:</span>
<a name="l02165"></a>02165 <span class="comment">// Map space, old pointer space, old data space, code space and cell space.</span>
<a name="l02166"></a>02166 <span class="comment">// Returns each space in turn, and null when it is done.</span>
<a name="l02167"></a>02167 <span class="keyword">class </span>PagedSpaces <a class="code" href="allocation_8h.html#abab81306d90d0b82732d5bed93a0a588">BASE_EMBEDDED</a> {
<a name="l02168"></a>02168  <span class="keyword">public</span>:
<a name="l02169"></a>02169   PagedSpace* next();
<a name="l02170"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a6c935a55ce9ce65c76560d4b7f0ff8c9">02170</a>   <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a6c935a55ce9ce65c76560d4b7f0ff8c9">PagedSpaces</a>() { counter_ = <a class="code" href="namespacev8_1_1internal.html#aa131d4fd9972fd8dfbec01a9243d9fefac6eda4effa28334846379882a6b424d1">OLD_POINTER_SPACE</a>; }
<a name="l02171"></a>02171  <span class="keyword">private</span>:
<a name="l02172"></a>02172   <span class="keywordtype">int</span> counter_;
<a name="l02173"></a>02173 };
<a name="l02174"></a>02174 
<a name="l02175"></a>02175 
<a name="l02176"></a>02176 <span class="comment">// Space iterator for iterating over all spaces of the heap.</span>
<a name="l02177"></a>02177 <span class="comment">// For each space an object iterator is provided. The deallocation of the</span>
<a name="l02178"></a>02178 <span class="comment">// returned object iterators is handled by the space iterator.</span>
<a name="l02179"></a><a class="code" href="classv8_1_1internal_1_1_space_iterator.html">02179</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_space_iterator.html">SpaceIterator</a> : <span class="keyword">public</span> <a class="code" href="classv8_1_1internal_1_1_malloced.html">Malloced</a> {
<a name="l02180"></a>02180  <span class="keyword">public</span>:
<a name="l02181"></a>02181   <a class="code" href="classv8_1_1internal_1_1_space_iterator.html#ab06a29b9a6f8552b1ed26afabf6a6e4c">SpaceIterator</a>();
<a name="l02182"></a>02182   <span class="keyword">explicit</span> <a class="code" href="classv8_1_1internal_1_1_space_iterator.html#ab06a29b9a6f8552b1ed26afabf6a6e4c">SpaceIterator</a>(<a class="code" href="namespacev8_1_1internal.html#a4664a14735f154f774c9130702904468">HeapObjectCallback</a> size_func);
<a name="l02183"></a>02183   <span class="keyword">virtual</span> <a class="code" href="classv8_1_1internal_1_1_space_iterator.html#a28112781b029ee1e80ffbea5c4b5e6fb">~SpaceIterator</a>();
<a name="l02184"></a>02184 
<a name="l02185"></a>02185   <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_space_iterator.html#ad580ae3fee14e8352e6de8ab9b7425da">has_next</a>();
<a name="l02186"></a>02186   <a class="code" href="classv8_1_1internal_1_1_object_iterator.html">ObjectIterator</a>* <a class="code" href="classv8_1_1internal_1_1_space_iterator.html#a09b2c61000d188b65dc52b576cb63db7">next</a>();
<a name="l02187"></a>02187 
<a name="l02188"></a>02188  <span class="keyword">private</span>:
<a name="l02189"></a>02189   <a class="code" href="classv8_1_1internal_1_1_object_iterator.html">ObjectIterator</a>* CreateIterator();
<a name="l02190"></a>02190 
<a name="l02191"></a>02191   <span class="keywordtype">int</span> current_space_;  <span class="comment">// from enum AllocationSpace.</span>
<a name="l02192"></a>02192   <a class="code" href="classv8_1_1internal_1_1_object_iterator.html">ObjectIterator</a>* iterator_;  <span class="comment">// object iterator for the current space.</span>
<a name="l02193"></a>02193   <a class="code" href="namespacev8_1_1internal.html#a4664a14735f154f774c9130702904468">HeapObjectCallback</a> size_func_;
<a name="l02194"></a>02194 };
<a name="l02195"></a>02195 
<a name="l02196"></a>02196 
<a name="l02197"></a>02197 <span class="comment">// A HeapIterator provides iteration over the whole heap. It</span>
<a name="l02198"></a>02198 <span class="comment">// aggregates the specific iterators for the different spaces as</span>
<a name="l02199"></a>02199 <span class="comment">// these can only iterate over one space only.</span>
<a name="l02200"></a>02200 <span class="comment">//</span>
<a name="l02201"></a>02201 <span class="comment">// HeapIterator can skip free list nodes (that is, de-allocated heap</span>
<a name="l02202"></a>02202 <span class="comment">// objects that still remain in the heap). As implementation of free</span>
<a name="l02203"></a>02203 <span class="comment">// nodes filtering uses GC marks, it can&#39;t be used during MS/MC GC</span>
<a name="l02204"></a>02204 <span class="comment">// phases. Also, it is forbidden to interrupt iteration in this mode,</span>
<a name="l02205"></a>02205 <span class="comment">// as this will leave heap objects marked (and thus, unusable).</span>
<a name="l02206"></a>02206 <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_heap_objects_filter.html">HeapObjectsFilter</a>;
<a name="l02207"></a>02207 
<a name="l02208"></a>02208 <span class="keyword">class </span>HeapIterator <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html">BASE_EMBEDDED</a> {
<a name="l02209"></a>02209  <span class="keyword">public</span>:
<a name="l02210"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#aae6ffde1429354610bcff351a7a0afb4">02210</a>   <span class="keyword">enum</span> <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#aae6ffde1429354610bcff351a7a0afb4">HeapObjectsFiltering</a> {
<a name="l02211"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#aae6ffde1429354610bcff351a7a0afb4a491a28e2989db85ba169eff6f438d415">02211</a>     <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#aae6ffde1429354610bcff351a7a0afb4a491a28e2989db85ba169eff6f438d415">kNoFiltering</a>,
<a name="l02212"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#aae6ffde1429354610bcff351a7a0afb4a4c08d4183068d02019bdc54dd25a6b29">02212</a>     kFilterUnreachable
<a name="l02213"></a>02213   };
<a name="l02214"></a>02214 
<a name="l02215"></a>02215   HeapIterator();
<a name="l02216"></a>02216   <span class="keyword">explicit</span> HeapIterator(HeapObjectsFiltering filtering);
<a name="l02217"></a>02217   ~HeapIterator();
<a name="l02218"></a>02218 
<a name="l02219"></a>02219   <a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* next();
<a name="l02220"></a>02220   <span class="keywordtype">void</span> reset();
<a name="l02221"></a>02221 
<a name="l02222"></a>02222  <span class="keyword">private</span>:
<a name="l02223"></a>02223   <span class="comment">// Perform the initialization.</span>
<a name="l02224"></a>02224   <span class="keywordtype">void</span> Init();
<a name="l02225"></a>02225   <span class="comment">// Perform all necessary shutdown (destruction) work.</span>
<a name="l02226"></a>02226   <span class="keywordtype">void</span> Shutdown();
<a name="l02227"></a>02227   <a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* NextObject();
<a name="l02228"></a>02228 
<a name="l02229"></a>02229   HeapObjectsFiltering filtering_;
<a name="l02230"></a>02230   <a class="code" href="classv8_1_1internal_1_1_heap_objects_filter.html">HeapObjectsFilter</a>* filter_;
<a name="l02231"></a>02231   <span class="comment">// Space iterator for iterating all the spaces.</span>
<a name="l02232"></a>02232   <a class="code" href="classv8_1_1internal_1_1_space_iterator.html">SpaceIterator</a>* space_iterator_;
<a name="l02233"></a>02233   <span class="comment">// Object iterator for the space currently being iterated.</span>
<a name="l02234"></a>02234   <a class="code" href="classv8_1_1internal_1_1_object_iterator.html">ObjectIterator</a>* object_iterator_;
<a name="l02235"></a>02235 };
<a name="l02236"></a>02236 
<a name="l02237"></a>02237 
<a name="l02238"></a>02238 <span class="comment">// Cache for mapping (map, property name) into field offset.</span>
<a name="l02239"></a>02239 <span class="comment">// Cleared at startup and prior to mark sweep collection.</span>
<a name="l02240"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html">02240</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html">KeyedLookupCache</a> {
<a name="l02241"></a>02241  <span class="keyword">public</span>:
<a name="l02242"></a>02242   <span class="comment">// Lookup field offset for (map, name). If absent, -1 is returned.</span>
<a name="l02243"></a>02243   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a1aa82356552a36178f21cb8d39503fc9">Lookup</a>(<a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>);
<a name="l02244"></a>02244 
<a name="l02245"></a>02245   <span class="comment">// Update an element in the cache.</span>
<a name="l02246"></a>02246   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a0cb41d55968cd900d037b4f3574427c6">Update</a>(<a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* map, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* name, <span class="keywordtype">int</span> field_offset);
<a name="l02247"></a>02247 
<a name="l02248"></a>02248   <span class="comment">// Clear the cache.</span>
<a name="l02249"></a>02249   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a184b47e6d6636f89403e34e339885264">Clear</a>();
<a name="l02250"></a>02250 
<a name="l02251"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a0921540bfdcf49a134a3d044b0814f4e">02251</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a0921540bfdcf49a134a3d044b0814f4e">kLength</a> = 256;
<a name="l02252"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a519bc8beaec79dca651742fc7251f06f">02252</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a519bc8beaec79dca651742fc7251f06f">kCapacityMask</a> = <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a0921540bfdcf49a134a3d044b0814f4e">kLength</a> - 1;
<a name="l02253"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a61dff332772e195884cf9193815b910d">02253</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a61dff332772e195884cf9193815b910d">kMapHashShift</a> = 5;
<a name="l02254"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a18e9484fd2dc636aaaaad3ba36c11e90">02254</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a18e9484fd2dc636aaaaad3ba36c11e90">kHashMask</a> = -4;  <span class="comment">// Zero the last two bits.</span>
<a name="l02255"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a77d60d2504047311092aa0acf5ace640">02255</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a77d60d2504047311092aa0acf5ace640">kEntriesPerBucket</a> = 4;
<a name="l02256"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a7d515a4270f99864f9f73543ea201aee">02256</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a7d515a4270f99864f9f73543ea201aee">kNotFound</a> = -1;
<a name="l02257"></a>02257 
<a name="l02258"></a>02258   <span class="comment">// kEntriesPerBucket should be a power of 2.</span>
<a name="l02259"></a>02259   <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#ad8ed15b794045bc9bcfd8fda6e1a1ee3">STATIC_ASSERT</a>((<a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a77d60d2504047311092aa0acf5ace640">kEntriesPerBucket</a> &amp; (<a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a77d60d2504047311092aa0acf5ace640">kEntriesPerBucket</a> - 1)) == 0);
<a name="l02260"></a>02260   <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#ad8ed15b794045bc9bcfd8fda6e1a1ee3">STATIC_ASSERT</a>(<a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a77d60d2504047311092aa0acf5ace640">kEntriesPerBucket</a> == -<a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a18e9484fd2dc636aaaaad3ba36c11e90">kHashMask</a>);
<a name="l02261"></a>02261 
<a name="l02262"></a>02262  <span class="keyword">private</span>:
<a name="l02263"></a>02263   <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html">KeyedLookupCache</a>() {
<a name="l02264"></a>02264     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a0921540bfdcf49a134a3d044b0814f4e">kLength</a>; ++i) {
<a name="l02265"></a>02265       keys_[i].map = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>;
<a name="l02266"></a>02266       keys_[i].name = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>;
<a name="l02267"></a>02267       field_offsets_[i] = <a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a7d515a4270f99864f9f73543ea201aee">kNotFound</a>;
<a name="l02268"></a>02268     }
<a name="l02269"></a>02269   }
<a name="l02270"></a>02270 
<a name="l02271"></a>02271   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> Hash(Map* map, <a class="code" href="classv8_1_1_string.html">String</a>* name);
<a name="l02272"></a>02272 
<a name="l02273"></a>02273   <span class="comment">// Get the address of the keys and field_offsets arrays.  Used in</span>
<a name="l02274"></a>02274   <span class="comment">// generated code to perform cache lookups.</span>
<a name="l02275"></a>02275   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> keys_address() {
<a name="l02276"></a>02276     <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a><span class="keyword">&gt;</span>(&amp;keys_);
<a name="l02277"></a>02277   }
<a name="l02278"></a>02278 
<a name="l02279"></a>02279   <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> field_offsets_address() {
<a name="l02280"></a>02280     <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a><span class="keyword">&gt;</span>(&amp;field_offsets_);
<a name="l02281"></a>02281   }
<a name="l02282"></a>02282 
<a name="l02283"></a>02283   <span class="keyword">struct </span>Key {
<a name="l02284"></a>02284     Map* map;
<a name="l02285"></a>02285     String* <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>;
<a name="l02286"></a>02286   };
<a name="l02287"></a>02287 
<a name="l02288"></a>02288   Key keys_[<a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a0921540bfdcf49a134a3d044b0814f4e">kLength</a>];
<a name="l02289"></a>02289   <span class="keywordtype">int</span> field_offsets_[<a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a0921540bfdcf49a134a3d044b0814f4e">kLength</a>];
<a name="l02290"></a>02290 
<a name="l02291"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a6cad52a007e84a78f169131b667e2d49">02291</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#a6cad52a007e84a78f169131b667e2d49">ExternalReference</a>;
<a name="l02292"></a><a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html#aba4f0964bdacf2bbf62cf876e5d28d0a">02292</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_isolate.html">Isolate</a>;
<a name="l02293"></a>02293   <a class="code" href="globals_8h.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(<a class="code" href="classv8_1_1internal_1_1_keyed_lookup_cache.html">KeyedLookupCache</a>);
<a name="l02294"></a>02294 };
<a name="l02295"></a>02295 
<a name="l02296"></a>02296 
<a name="l02297"></a>02297 <span class="comment">// Cache for mapping (array, property name) into descriptor index.</span>
<a name="l02298"></a>02298 <span class="comment">// The cache contains both positive and negative results.</span>
<a name="l02299"></a>02299 <span class="comment">// Descriptor index equals kNotFound means the property is absent.</span>
<a name="l02300"></a>02300 <span class="comment">// Cleared at startup and prior to any gc.</span>
<a name="l02301"></a><a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html">02301</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html">DescriptorLookupCache</a> {
<a name="l02302"></a>02302  <span class="keyword">public</span>:
<a name="l02303"></a>02303   <span class="comment">// Lookup descriptor index for (map, name).</span>
<a name="l02304"></a>02304   <span class="comment">// If absent, kAbsent is returned.</span>
<a name="l02305"></a><a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a4c67783e91f5ce892ea3c847e58be5a0">02305</a>   <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a4c67783e91f5ce892ea3c847e58be5a0">Lookup</a>(<a class="code" href="classv8_1_1internal_1_1_descriptor_array.html">DescriptorArray</a>* array, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* name) {
<a name="l02306"></a>02306     <span class="keywordflow">if</span> (!StringShape(name).IsSymbol()) <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a5c88488d5dfd0cb4d26b07dc96ceaf60">kAbsent</a>;
<a name="l02307"></a>02307     <span class="keywordtype">int</span> index = Hash(array, name);
<a name="l02308"></a>02308     Key&amp; key = keys_[index];
<a name="l02309"></a>02309     <span class="keywordflow">if</span> ((key.array == array) &amp;&amp; (key.name == name)) <span class="keywordflow">return</span> results_[index];
<a name="l02310"></a>02310     <span class="keywordflow">return</span> <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a5c88488d5dfd0cb4d26b07dc96ceaf60">kAbsent</a>;
<a name="l02311"></a>02311   }
<a name="l02312"></a>02312 
<a name="l02313"></a>02313   <span class="comment">// Update an element in the cache.</span>
<a name="l02314"></a><a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a88ede6391cadf3075d743e86094c90e6">02314</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a88ede6391cadf3075d743e86094c90e6">Update</a>(<a class="code" href="classv8_1_1internal_1_1_descriptor_array.html">DescriptorArray</a>* array, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* name, <span class="keywordtype">int</span> result) {
<a name="l02315"></a>02315     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(result != <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a5c88488d5dfd0cb4d26b07dc96ceaf60">kAbsent</a>);
<a name="l02316"></a>02316     <span class="keywordflow">if</span> (StringShape(name).IsSymbol()) {
<a name="l02317"></a>02317       <span class="keywordtype">int</span> index = Hash(array, name);
<a name="l02318"></a>02318       Key&amp; key = keys_[index];
<a name="l02319"></a>02319       key.array = array;
<a name="l02320"></a>02320       key.name = <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>;
<a name="l02321"></a>02321       results_[index] = result;
<a name="l02322"></a>02322     }
<a name="l02323"></a>02323   }
<a name="l02324"></a>02324 
<a name="l02325"></a>02325   <span class="comment">// Clear the cache.</span>
<a name="l02326"></a>02326   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a00f0f0d03b3c4698ae2b5b4ce23d92d4">Clear</a>();
<a name="l02327"></a>02327 
<a name="l02328"></a><a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a5c88488d5dfd0cb4d26b07dc96ceaf60">02328</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a5c88488d5dfd0cb4d26b07dc96ceaf60">kAbsent</a> = -2;
<a name="l02329"></a>02329 
<a name="l02330"></a>02330  <span class="keyword">private</span>:
<a name="l02331"></a>02331   <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html">DescriptorLookupCache</a>() {
<a name="l02332"></a>02332     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kLength; ++i) {
<a name="l02333"></a>02333       keys_[i].array = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>;
<a name="l02334"></a>02334       keys_[i].name = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>;
<a name="l02335"></a>02335       results_[i] = <a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#a5c88488d5dfd0cb4d26b07dc96ceaf60">kAbsent</a>;
<a name="l02336"></a>02336     }
<a name="l02337"></a>02337   }
<a name="l02338"></a>02338 
<a name="l02339"></a>02339   <span class="keyword">static</span> <span class="keywordtype">int</span> Hash(<a class="code" href="classv8_1_1internal_1_1_descriptor_array.html">DescriptorArray</a>* array, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* name) {
<a name="l02340"></a>02340     <span class="comment">// Uses only lower 32 bits if pointers are larger.</span>
<a name="l02341"></a>02341     uint32_t array_hash =
<a name="l02342"></a>02342         <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(<span class="keyword">reinterpret_cast&lt;</span>uintptr_t<span class="keyword">&gt;</span>(array)) &gt;&gt; 2;
<a name="l02343"></a>02343     uint32_t name_hash =
<a name="l02344"></a>02344         <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(<span class="keyword">reinterpret_cast&lt;</span>uintptr_t<span class="keyword">&gt;</span>(<a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>)) &gt;&gt; 2;
<a name="l02345"></a>02345     <span class="keywordflow">return</span> (array_hash ^ name_hash) % kLength;
<a name="l02346"></a>02346   }
<a name="l02347"></a>02347 
<a name="l02348"></a>02348   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kLength = 64;
<a name="l02349"></a>02349   <span class="keyword">struct </span>Key {
<a name="l02350"></a>02350     DescriptorArray* array;
<a name="l02351"></a>02351     <a class="code" href="classv8_1_1_string.html">String</a>* <a class="code" href="namespacev8_1_1internal.html#a81b49fe6af51fab72b8b2ee86f70d4dd">name</a>;
<a name="l02352"></a>02352   };
<a name="l02353"></a>02353 
<a name="l02354"></a>02354   Key keys_[kLength];
<a name="l02355"></a>02355   <span class="keywordtype">int</span> results_[kLength];
<a name="l02356"></a>02356 
<a name="l02357"></a><a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html#aba4f0964bdacf2bbf62cf876e5d28d0a">02357</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_isolate.html">Isolate</a>;
<a name="l02358"></a>02358   <a class="code" href="globals_8h.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(<a class="code" href="classv8_1_1internal_1_1_descriptor_lookup_cache.html">DescriptorLookupCache</a>);
<a name="l02359"></a>02359 };
<a name="l02360"></a>02360 
<a name="l02361"></a>02361 
<a name="l02362"></a>02362 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l02363"></a>02363 <span class="preprocessor"></span><span class="keyword">class </span>DisallowAllocationFailure {
<a name="l02364"></a>02364  <span class="keyword">public</span>:
<a name="l02365"></a>02365   <span class="keyword">inline</span> DisallowAllocationFailure();
<a name="l02366"></a>02366   <span class="keyword">inline</span> ~DisallowAllocationFailure();
<a name="l02367"></a>02367 
<a name="l02368"></a>02368  <span class="keyword">private</span>:
<a name="l02369"></a>02369   <span class="keywordtype">bool</span> old_state_;
<a name="l02370"></a>02370 };
<a name="l02371"></a>02371 <span class="preprocessor">#endif</span>
<a name="l02372"></a>02372 <span class="preprocessor"></span>
<a name="l02373"></a>02373 
<a name="l02374"></a>02374 <span class="comment">// A helper class to document/test C++ scopes where we do not</span>
<a name="l02375"></a>02375 <span class="comment">// expect a GC. Usage:</span>
<a name="l02376"></a>02376 <span class="comment">//</span>
<a name="l02377"></a>02377 <span class="comment">// /* Allocation not allowed: we cannot handle a GC in this scope. */</span>
<a name="l02378"></a>02378 <span class="comment">// { AssertNoAllocation nogc;</span>
<a name="l02379"></a>02379 <span class="comment">//   ...</span>
<a name="l02380"></a>02380 <span class="comment">// }</span>
<a name="l02381"></a><a class="code" href="classv8_1_1internal_1_1_assert_no_allocation.html">02381</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_assert_no_allocation.html">AssertNoAllocation</a> {
<a name="l02382"></a>02382  <span class="keyword">public</span>:
<a name="l02383"></a>02383   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_assert_no_allocation.html#a744f423af8c9a0d0d5628a2cfa77bf2c">AssertNoAllocation</a>();
<a name="l02384"></a>02384   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_assert_no_allocation.html#a34a1fb0ff81352e092954f3e7e94248b">~AssertNoAllocation</a>();
<a name="l02385"></a>02385 
<a name="l02386"></a>02386 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l02387"></a>02387 <span class="preprocessor"></span> <span class="keyword">private</span>:
<a name="l02388"></a>02388   <span class="keywordtype">bool</span> old_state_;
<a name="l02389"></a>02389 <span class="preprocessor">#endif</span>
<a name="l02390"></a>02390 <span class="preprocessor"></span>};
<a name="l02391"></a>02391 
<a name="l02392"></a>02392 
<a name="l02393"></a><a class="code" href="classv8_1_1internal_1_1_disable_assert_no_allocation.html">02393</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_disable_assert_no_allocation.html">DisableAssertNoAllocation</a> {
<a name="l02394"></a>02394  <span class="keyword">public</span>:
<a name="l02395"></a>02395   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_disable_assert_no_allocation.html#a5a30725562226cc9fb75ccb823f2e300">DisableAssertNoAllocation</a>();
<a name="l02396"></a>02396   <span class="keyword">inline</span> <a class="code" href="classv8_1_1internal_1_1_disable_assert_no_allocation.html#a54dbc8e3627aedebbc7ff59822f39daf">~DisableAssertNoAllocation</a>();
<a name="l02397"></a>02397 
<a name="l02398"></a>02398 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l02399"></a>02399 <span class="preprocessor"></span> <span class="keyword">private</span>:
<a name="l02400"></a>02400   <span class="keywordtype">bool</span> old_state_;
<a name="l02401"></a>02401 <span class="preprocessor">#endif</span>
<a name="l02402"></a>02402 <span class="preprocessor"></span>};
<a name="l02403"></a>02403 
<a name="l02404"></a>02404 <span class="comment">// GCTracer collects and prints ONE line after each garbage collector</span>
<a name="l02405"></a>02405 <span class="comment">// invocation IFF --trace_gc is used.</span>
<a name="l02406"></a>02406 
<a name="l02407"></a>02407 <span class="keyword">class </span>GCTracer <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html">BASE_EMBEDDED</a> {
<a name="l02408"></a>02408  <span class="keyword">public</span>:
<a name="l02409"></a>02409   <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_scope.html">Scope</a> <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html">BASE_EMBEDDED</a> {
<a name="l02410"></a>02410    <span class="keyword">public</span>:
<a name="l02411"></a>02411     <span class="keyword">enum</span> ScopeId {
<a name="l02412"></a>02412       EXTERNAL,
<a name="l02413"></a>02413       MC_MARK,
<a name="l02414"></a>02414       MC_SWEEP,
<a name="l02415"></a>02415       MC_SWEEP_NEWSPACE,
<a name="l02416"></a>02416       MC_EVACUATE_PAGES,
<a name="l02417"></a>02417       MC_UPDATE_NEW_TO_NEW_POINTERS,
<a name="l02418"></a>02418       MC_UPDATE_ROOT_TO_NEW_POINTERS,
<a name="l02419"></a>02419       MC_UPDATE_OLD_TO_NEW_POINTERS,
<a name="l02420"></a>02420       MC_UPDATE_POINTERS_TO_EVACUATED,
<a name="l02421"></a>02421       MC_UPDATE_POINTERS_BETWEEN_EVACUATED,
<a name="l02422"></a>02422       MC_UPDATE_MISC_POINTERS,
<a name="l02423"></a>02423       MC_FLUSH_CODE,
<a name="l02424"></a>02424       kNumberOfScopes
<a name="l02425"></a>02425     };
<a name="l02426"></a>02426 
<a name="l02427"></a>02427     Scope(GCTracer* tracer, ScopeId scope)
<a name="l02428"></a>02428         : tracer_(tracer),
<a name="l02429"></a>02429         scope_(scope) {
<a name="l02430"></a>02430       start_time_ = <a class="code" href="classv8_1_1internal_1_1_o_s.html#acb5f52447f399aabeb84b3ab5006ba5a">OS::TimeCurrentMillis</a>();
<a name="l02431"></a>02431     }
<a name="l02432"></a>02432 
<a name="l02433"></a>02433     ~Scope() {
<a name="l02434"></a>02434       <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(scope_ &lt; kNumberOfScopes);  <span class="comment">// scope_ is unsigned.</span>
<a name="l02435"></a>02435       tracer_-&gt;scopes_[scope_] += <a class="code" href="classv8_1_1internal_1_1_o_s.html#acb5f52447f399aabeb84b3ab5006ba5a">OS::TimeCurrentMillis</a>() - start_time_;
<a name="l02436"></a>02436     }
<a name="l02437"></a>02437 
<a name="l02438"></a>02438    <span class="keyword">private</span>:
<a name="l02439"></a>02439     GCTracer* tracer_;
<a name="l02440"></a>02440     ScopeId scope_;
<a name="l02441"></a>02441     <span class="keywordtype">double</span> start_time_;
<a name="l02442"></a>02442   };
<a name="l02443"></a>02443 
<a name="l02444"></a>02444   <span class="keyword">explicit</span> GCTracer(Heap* heap,
<a name="l02445"></a>02445                     <span class="keyword">const</span> <span class="keywordtype">char</span>* gc_reason,
<a name="l02446"></a>02446                     <span class="keyword">const</span> <span class="keywordtype">char</span>* collector_reason);
<a name="l02447"></a>02447   ~GCTracer();
<a name="l02448"></a>02448 
<a name="l02449"></a>02449   <span class="comment">// Sets the collector.</span>
<a name="l02450"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a797a8ce404069e503fa85f1066496d90">02450</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a797a8ce404069e503fa85f1066496d90">set_collector</a>(<a class="code" href="namespacev8_1_1internal.html#ad504e70236bfcc0478d67053d1ed9ac0">GarbageCollector</a> collector) { collector_ = collector; }
<a name="l02451"></a>02451 
<a name="l02452"></a>02452   <span class="comment">// Sets the GC count.</span>
<a name="l02453"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a56cc0137dc33e348d4dab992f962bce5">02453</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a56cc0137dc33e348d4dab992f962bce5">set_gc_count</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count) { gc_count_ = count; }
<a name="l02454"></a>02454 
<a name="l02455"></a>02455   <span class="comment">// Sets the full GC count.</span>
<a name="l02456"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a8c162a2cdb3e9cf1fd009008eed8c296">02456</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#a8c162a2cdb3e9cf1fd009008eed8c296">set_full_gc_count</a>(<span class="keywordtype">int</span> count) { full_gc_count_ = count; }
<a name="l02457"></a>02457 
<a name="l02458"></a><a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#ae86a80f977b30a76e072798e590f125a">02458</a>   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_b_a_s_e___e_m_b_e_d_d_e_d.html#ae86a80f977b30a76e072798e590f125a">increment_promoted_objects_size</a>(<span class="keywordtype">int</span> object_size) {
<a name="l02459"></a>02459     promoted_objects_size_ += object_size;
<a name="l02460"></a>02460   }
<a name="l02461"></a>02461 
<a name="l02462"></a>02462  <span class="keyword">private</span>:
<a name="l02463"></a>02463   <span class="comment">// Returns a string matching the collector.</span>
<a name="l02464"></a>02464   <span class="keyword">const</span> <span class="keywordtype">char</span>* CollectorString();
<a name="l02465"></a>02465 
<a name="l02466"></a>02466   <span class="comment">// Returns size of object in heap (in MB).</span>
<a name="l02467"></a>02467   <span class="keyword">inline</span> <span class="keywordtype">double</span> SizeOfHeapObjects();
<a name="l02468"></a>02468 
<a name="l02469"></a>02469   <span class="comment">// Timestamp set in the constructor.</span>
<a name="l02470"></a>02470   <span class="keywordtype">double</span> start_time_;
<a name="l02471"></a>02471 
<a name="l02472"></a>02472   <span class="comment">// Size of objects in heap set in constructor.</span>
<a name="l02473"></a>02473   intptr_t start_object_size_;
<a name="l02474"></a>02474 
<a name="l02475"></a>02475   <span class="comment">// Size of memory allocated from OS set in constructor.</span>
<a name="l02476"></a>02476   intptr_t start_memory_size_;
<a name="l02477"></a>02477 
<a name="l02478"></a>02478   <span class="comment">// Type of collector.</span>
<a name="l02479"></a>02479   <a class="code" href="namespacev8_1_1internal.html#ad504e70236bfcc0478d67053d1ed9ac0">GarbageCollector</a> collector_;
<a name="l02480"></a>02480 
<a name="l02481"></a>02481   <span class="comment">// A count (including this one, e.g. the first collection is 1) of the</span>
<a name="l02482"></a>02482   <span class="comment">// number of garbage collections.</span>
<a name="l02483"></a>02483   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gc_count_;
<a name="l02484"></a>02484 
<a name="l02485"></a>02485   <span class="comment">// A count (including this one) of the number of full garbage collections.</span>
<a name="l02486"></a>02486   <span class="keywordtype">int</span> full_gc_count_;
<a name="l02487"></a>02487 
<a name="l02488"></a>02488   <span class="comment">// Amounts of time spent in different scopes during GC.</span>
<a name="l02489"></a>02489   <span class="keywordtype">double</span> scopes_[Scope::kNumberOfScopes];
<a name="l02490"></a>02490 
<a name="l02491"></a>02491   <span class="comment">// Total amount of space either wasted or contained in one of free lists</span>
<a name="l02492"></a>02492   <span class="comment">// before the current GC.</span>
<a name="l02493"></a>02493   intptr_t in_free_list_or_wasted_before_gc_;
<a name="l02494"></a>02494 
<a name="l02495"></a>02495   <span class="comment">// Difference between space used in the heap at the beginning of the current</span>
<a name="l02496"></a>02496   <span class="comment">// collection and the end of the previous collection.</span>
<a name="l02497"></a>02497   intptr_t allocated_since_last_gc_;
<a name="l02498"></a>02498 
<a name="l02499"></a>02499   <span class="comment">// Amount of time spent in mutator that is time elapsed between end of the</span>
<a name="l02500"></a>02500   <span class="comment">// previous collection and the beginning of the current one.</span>
<a name="l02501"></a>02501   <span class="keywordtype">double</span> spent_in_mutator_;
<a name="l02502"></a>02502 
<a name="l02503"></a>02503   <span class="comment">// Size of objects promoted during the current collection.</span>
<a name="l02504"></a>02504   intptr_t promoted_objects_size_;
<a name="l02505"></a>02505 
<a name="l02506"></a>02506   <span class="comment">// Incremental marking steps counters.</span>
<a name="l02507"></a>02507   <span class="keywordtype">int</span> steps_count_;
<a name="l02508"></a>02508   <span class="keywordtype">double</span> steps_took_;
<a name="l02509"></a>02509   <span class="keywordtype">double</span> longest_step_;
<a name="l02510"></a>02510   <span class="keywordtype">int</span> steps_count_since_last_gc_;
<a name="l02511"></a>02511   <span class="keywordtype">double</span> steps_took_since_last_gc_;
<a name="l02512"></a>02512 
<a name="l02513"></a>02513   <a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>* heap_;
<a name="l02514"></a>02514 
<a name="l02515"></a>02515   <span class="keyword">const</span> <span class="keywordtype">char</span>* gc_reason_;
<a name="l02516"></a>02516   <span class="keyword">const</span> <span class="keywordtype">char</span>* collector_reason_;
<a name="l02517"></a>02517 };
<a name="l02518"></a>02518 
<a name="l02519"></a>02519 
<a name="l02520"></a><a class="code" href="classv8_1_1internal_1_1_string_split_cache.html">02520</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_string_split_cache.html">StringSplitCache</a> {
<a name="l02521"></a>02521  <span class="keyword">public</span>:
<a name="l02522"></a>02522   <span class="keyword">static</span> <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <a class="code" href="classv8_1_1internal_1_1_string_split_cache.html#a9beaebc24bb80658e0d11397a0959b8d">Lookup</a>(<a class="code" href="classv8_1_1internal_1_1_fixed_array.html">FixedArray</a>* cache, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <span class="keywordtype">string</span>, <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* pattern);
<a name="l02523"></a>02523   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_string_split_cache.html#a41330f46feb64f795af246a4df6a6c23">Enter</a>(<a class="code" href="classv8_1_1internal_1_1_heap.html">Heap</a>* heap,
<a name="l02524"></a>02524                     <a class="code" href="classv8_1_1internal_1_1_fixed_array.html">FixedArray</a>* cache,
<a name="l02525"></a>02525                     <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* <span class="keywordtype">string</span>,
<a name="l02526"></a>02526                     <a class="code" href="classv8_1_1internal_1_1_string.html">String</a>* pattern,
<a name="l02527"></a>02527                     <a class="code" href="classv8_1_1internal_1_1_fixed_array.html">FixedArray</a>* array);
<a name="l02528"></a>02528   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_string_split_cache.html#a9154de2ba332206d5cd659955027d4ad">Clear</a>(<a class="code" href="classv8_1_1internal_1_1_fixed_array.html">FixedArray</a>* cache);
<a name="l02529"></a><a class="code" href="classv8_1_1internal_1_1_string_split_cache.html#aa0f9ff451d33e016ce7a5639f504e698">02529</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_string_split_cache.html#aa0f9ff451d33e016ce7a5639f504e698">kStringSplitCacheSize</a> = 0x100;
<a name="l02530"></a>02530 
<a name="l02531"></a>02531  <span class="keyword">private</span>:
<a name="l02532"></a>02532   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kArrayEntriesPerCacheEntry = 4;
<a name="l02533"></a>02533   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kStringOffset = 0;
<a name="l02534"></a>02534   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kPatternOffset = 1;
<a name="l02535"></a>02535   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kArrayOffset = 2;
<a name="l02536"></a>02536 
<a name="l02537"></a>02537   <span class="keyword">static</span> MaybeObject* WrapFixedArrayInJSArray(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* fixed_array);
<a name="l02538"></a>02538 };
<a name="l02539"></a>02539 
<a name="l02540"></a>02540 
<a name="l02541"></a><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html">02541</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html">TranscendentalCache</a> {
<a name="l02542"></a>02542  <span class="keyword">public</span>:
<a name="l02543"></a><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705">02543</a>   <span class="keyword">enum</span> <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705">Type</a> {<a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a1508f58b39ab19f1e4f1c3c0c6660863">ACOS</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a82af95dc1684e4d030c67624d71360da">ASIN</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705ad0b1fa3334ccc56ea2c80603995a7001">ATAN</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a665bf82968f69d1d363b7efcb4048777">COS</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a9450baa0fcafd6b75504253e3c694639">EXP</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a5b104f08f0721a53d58bac59bc573874">LOG</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705af2022ac622e85b458626c235fc69d0d7">SIN</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a86360c509ec8906d0df45d8375b21b93">TAN</a>, <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a42af1177a4e8ade0b3eed81f350844f0">kNumberOfCaches</a>};
<a name="l02544"></a><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#ac06bfc2a2f3a0c54631a4a47445ae78b">02544</a>   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#ac06bfc2a2f3a0c54631a4a47445ae78b">kTranscendentalTypeBits</a> = 3;
<a name="l02545"></a>02545   <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a536b879d9490cae210f4deed1f8680e6">STATIC_ASSERT</a>((1 &lt;&lt; <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#ac06bfc2a2f3a0c54631a4a47445ae78b">kTranscendentalTypeBits</a>) &gt;= <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a42af1177a4e8ade0b3eed81f350844f0">kNumberOfCaches</a>);
<a name="l02546"></a>02546 
<a name="l02547"></a>02547   <span class="comment">// Returns a heap number with f(input), where f is a math function specified</span>
<a name="l02548"></a>02548   <span class="comment">// by the &#39;type&#39; argument.</span>
<a name="l02549"></a>02549   <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#ac95c8d00661f67dece8ed2f43986a2e1">Get</a>(<a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705">Type</a> <a class="code" href="namespacev8_1_1internal.html#af325044478c719d86be7dc7a017f250a">type</a>, <span class="keywordtype">double</span> input);
<a name="l02550"></a>02550 
<a name="l02551"></a>02551   <span class="comment">// The cache contains raw Object pointers.  This method disposes of</span>
<a name="l02552"></a>02552   <span class="comment">// them before a garbage collection.</span>
<a name="l02553"></a>02553   <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a5f20d7ade3c51ac795848c1b0c434498">Clear</a>();
<a name="l02554"></a>02554 
<a name="l02555"></a>02555  <span class="keyword">private</span>:
<a name="l02556"></a>02556   <span class="keyword">class </span>SubCache {
<a name="l02557"></a>02557     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kCacheSize = 512;
<a name="l02558"></a>02558 
<a name="l02559"></a>02559     <span class="keyword">explicit</span> SubCache(<a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705">Type</a> t);
<a name="l02560"></a>02560 
<a name="l02561"></a>02561     <a class="code" href="globals_8h.html#afefbce768b9d0df9c9ebc30dd6d13fed">MUST_USE_RESULT</a> <span class="keyword">inline</span> MaybeObject* <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#ac95c8d00661f67dece8ed2f43986a2e1">Get</a>(<span class="keywordtype">double</span> input);
<a name="l02562"></a>02562 
<a name="l02563"></a>02563     <span class="keyword">inline</span> <span class="keywordtype">double</span> Calculate(<span class="keywordtype">double</span> input);
<a name="l02564"></a>02564 
<a name="l02565"></a>02565     <span class="keyword">struct </span>Element {
<a name="l02566"></a>02566       uint32_t in[2];
<a name="l02567"></a>02567       <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* output;
<a name="l02568"></a>02568     };
<a name="l02569"></a>02569 
<a name="l02570"></a>02570     <span class="keyword">union </span>Converter {
<a name="l02571"></a>02571       <span class="keywordtype">double</span> dbl;
<a name="l02572"></a>02572       uint32_t integers[2];
<a name="l02573"></a>02573     };
<a name="l02574"></a>02574 
<a name="l02575"></a>02575     <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">int</span> Hash(<span class="keyword">const</span> Converter&amp; c) {
<a name="l02576"></a>02576       uint32_t hash = (c.integers[0] ^ c.integers[1]);
<a name="l02577"></a>02577       hash ^= <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceunibrow.html#a60d2324d08aaa746bbaaa291aca51448">int32_t</a><span class="keyword">&gt;</span>(hash) &gt;&gt; 16;
<a name="l02578"></a>02578       hash ^= <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceunibrow.html#a60d2324d08aaa746bbaaa291aca51448">int32_t</a><span class="keyword">&gt;</span>(hash) &gt;&gt; 8;
<a name="l02579"></a>02579       <span class="keywordflow">return</span> (hash &amp; (kCacheSize - 1));
<a name="l02580"></a>02580     }
<a name="l02581"></a>02581 
<a name="l02582"></a>02582     Element elements_[kCacheSize];
<a name="l02583"></a>02583     <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705">Type</a> <a class="code" href="namespacev8_1_1internal.html#af6a7fd6561b7b6a736ce8e1e3ab4bd45">type_</a>;
<a name="l02584"></a>02584     <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#aba4f0964bdacf2bbf62cf876e5d28d0a">Isolate</a>* isolate_;
<a name="l02585"></a>02585 
<a name="l02586"></a>02586     <span class="comment">// Allow access to the caches_ array as an ExternalReference.</span>
<a name="l02587"></a>02587     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a6cad52a007e84a78f169131b667e2d49">ExternalReference</a>;
<a name="l02588"></a>02588     <span class="comment">// Inline implementation of the cache.</span>
<a name="l02589"></a>02589     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a1163760e00590c8fd37a1218889915aa">TranscendentalCacheStub</a>;
<a name="l02590"></a>02590     <span class="comment">// For evaluating value.</span>
<a name="l02591"></a>02591     <span class="keyword">friend</span> <span class="keyword">class </span>TranscendentalCache;
<a name="l02592"></a>02592 
<a name="l02593"></a>02593     <a class="code" href="globals_8h.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(SubCache);
<a name="l02594"></a>02594   };
<a name="l02595"></a>02595 
<a name="l02596"></a>02596   TranscendentalCache() {
<a name="l02597"></a>02597     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a42af1177a4e8ade0b3eed81f350844f0">kNumberOfCaches</a>; ++i) caches_[i] = <a class="code" href="namespacev8_1_1internal.html#a5c7edd76ae40d6f54c6a23a039b15551">NULL</a>;
<a name="l02598"></a>02598   }
<a name="l02599"></a>02599 
<a name="l02600"></a>02600   <span class="comment">// Used to create an external reference.</span>
<a name="l02601"></a>02601   <span class="keyword">inline</span> <a class="code" href="namespacev8_1_1internal.html#a91038d135bfd26927f854d52e3e54379">Address</a> cache_array_address();
<a name="l02602"></a>02602 
<a name="l02603"></a>02603   <span class="comment">// Instantiation</span>
<a name="l02604"></a><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#aba4f0964bdacf2bbf62cf876e5d28d0a">02604</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_isolate.html">Isolate</a>;
<a name="l02605"></a>02605   <span class="comment">// Inline implementation of the caching.</span>
<a name="l02606"></a><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a1163760e00590c8fd37a1218889915aa">02606</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_transcendental_cache_stub.html">TranscendentalCacheStub</a>;
<a name="l02607"></a>02607   <span class="comment">// Allow access to the caches_ array as an ExternalReference.</span>
<a name="l02608"></a><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a6cad52a007e84a78f169131b667e2d49">02608</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a6cad52a007e84a78f169131b667e2d49">ExternalReference</a>;
<a name="l02609"></a>02609 
<a name="l02610"></a>02610   SubCache* caches_[<a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html#a58c263035e476390e335e8ed6ba3d705a42af1177a4e8ade0b3eed81f350844f0">kNumberOfCaches</a>];
<a name="l02611"></a>02611   <a class="code" href="globals_8h.html#af8df3547bfde53a5acb93e2607b0034a">DISALLOW_COPY_AND_ASSIGN</a>(<a class="code" href="classv8_1_1internal_1_1_transcendental_cache.html">TranscendentalCache</a>);
<a name="l02612"></a>02612 };
<a name="l02613"></a>02613 
<a name="l02614"></a>02614 
<a name="l02615"></a>02615 <span class="comment">// Abstract base class for checking whether a weak object should be retained.</span>
<a name="l02616"></a><a class="code" href="classv8_1_1internal_1_1_weak_object_retainer.html">02616</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_weak_object_retainer.html">WeakObjectRetainer</a> {
<a name="l02617"></a>02617  <span class="keyword">public</span>:
<a name="l02618"></a><a class="code" href="classv8_1_1internal_1_1_weak_object_retainer.html#a6b90144cded7913eb80f1690d01941ca">02618</a>   <span class="keyword">virtual</span> <a class="code" href="classv8_1_1internal_1_1_weak_object_retainer.html#a6b90144cded7913eb80f1690d01941ca">~WeakObjectRetainer</a>() {}
<a name="l02619"></a>02619 
<a name="l02620"></a>02620   <span class="comment">// Return whether this object should be retained. If NULL is returned the</span>
<a name="l02621"></a>02621   <span class="comment">// object has no references. Otherwise the address of the retained object</span>
<a name="l02622"></a>02622   <span class="comment">// should be returned as in some GC situations the object has been moved.</span>
<a name="l02623"></a>02623   <span class="keyword">virtual</span> <a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <a class="code" href="classv8_1_1internal_1_1_weak_object_retainer.html#a603b5e5e9baf52030a4baa4ef249fe81">RetainAs</a>(<a class="code" href="classv8_1_1internal_1_1_object.html">Object</a>* <span class="keywordtype">object</span>) = 0;
<a name="l02624"></a>02624 };
<a name="l02625"></a>02625 
<a name="l02626"></a>02626 
<a name="l02627"></a>02627 <span class="comment">// Intrusive object marking uses least significant bit of</span>
<a name="l02628"></a>02628 <span class="comment">// heap object&#39;s map word to mark objects.</span>
<a name="l02629"></a>02629 <span class="comment">// Normally all map words have least significant bit set</span>
<a name="l02630"></a>02630 <span class="comment">// because they contain tagged map pointer.</span>
<a name="l02631"></a>02631 <span class="comment">// If the bit is not set object is marked.</span>
<a name="l02632"></a>02632 <span class="comment">// All objects should be unmarked before resuming</span>
<a name="l02633"></a>02633 <span class="comment">// JavaScript execution.</span>
<a name="l02634"></a><a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html">02634</a> <span class="keyword">class </span><a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html">IntrusiveMarking</a> {
<a name="l02635"></a>02635  <span class="keyword">public</span>:
<a name="l02636"></a><a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#ac4812fd07621bcbba1ae24c322db87c6">02636</a>   <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#ac4812fd07621bcbba1ae24c322db87c6">IsMarked</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* <span class="keywordtype">object</span>) {
<a name="l02637"></a>02637     <span class="keywordflow">return</span> (object-&gt;<a class="code" href="classv8_1_1internal_1_1_heap_object.html#af851d5f6aeb9e49cc45d071652bbcd66">map_word</a>().ToRawValue() &amp; kNotMarkedBit) == 0;
<a name="l02638"></a>02638   }
<a name="l02639"></a>02639 
<a name="l02640"></a><a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#a84bc3589a776360f018ae69367508769">02640</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#a84bc3589a776360f018ae69367508769">ClearMark</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* <span class="keywordtype">object</span>) {
<a name="l02641"></a>02641     uintptr_t map_word = <span class="keywordtype">object</span>-&gt;map_word().ToRawValue();
<a name="l02642"></a>02642     <span class="keywordtype">object</span>-&gt;set_map_word(MapWord::FromRawValue(map_word | kNotMarkedBit));
<a name="l02643"></a>02643     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(!<a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#ac4812fd07621bcbba1ae24c322db87c6">IsMarked</a>(<span class="keywordtype">object</span>));
<a name="l02644"></a>02644   }
<a name="l02645"></a>02645 
<a name="l02646"></a><a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#adbcec6edb7517b9e7e746b6fdcf89d9f">02646</a>   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#adbcec6edb7517b9e7e746b6fdcf89d9f">SetMark</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* <span class="keywordtype">object</span>) {
<a name="l02647"></a>02647     uintptr_t map_word = <span class="keywordtype">object</span>-&gt;map_word().ToRawValue();
<a name="l02648"></a>02648     <span class="keywordtype">object</span>-&gt;set_map_word(MapWord::FromRawValue(map_word &amp; ~kNotMarkedBit));
<a name="l02649"></a>02649     <a class="code" href="checks_8h.html#ac22830a985e1daed0c9eadba8c6f606e">ASSERT</a>(<a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#ac4812fd07621bcbba1ae24c322db87c6">IsMarked</a>(<span class="keywordtype">object</span>));
<a name="l02650"></a>02650   }
<a name="l02651"></a>02651 
<a name="l02652"></a><a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#af0fcee6998c2f89590a65e02f3a4940c">02652</a>   <span class="keyword">static</span> <a class="code" href="classv8_1_1internal_1_1_map.html">Map</a>* <a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#af0fcee6998c2f89590a65e02f3a4940c">MapOfMarkedObject</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* <span class="keywordtype">object</span>) {
<a name="l02653"></a>02653     uintptr_t map_word = <span class="keywordtype">object</span>-&gt;<a class="code" href="classv8_1_1internal_1_1_heap_object.html#af851d5f6aeb9e49cc45d071652bbcd66">map_word</a>().ToRawValue();
<a name="l02654"></a>02654     <span class="keywordflow">return</span> MapWord::FromRawValue(map_word | kNotMarkedBit).ToMap();
<a name="l02655"></a>02655   }
<a name="l02656"></a>02656 
<a name="l02657"></a><a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#a9daee26c04a188a1085d60657baf9672">02657</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#a9daee26c04a188a1085d60657baf9672">SizeOfMarkedObject</a>(<a class="code" href="classv8_1_1internal_1_1_heap_object.html">HeapObject</a>* <span class="keywordtype">object</span>) {
<a name="l02658"></a>02658     <span class="keywordflow">return</span> <span class="keywordtype">object</span>-&gt;SizeFromMap(<a class="code" href="classv8_1_1internal_1_1_intrusive_marking.html#af0fcee6998c2f89590a65e02f3a4940c">MapOfMarkedObject</a>(<span class="keywordtype">object</span>));
<a name="l02659"></a>02659   }
<a name="l02660"></a>02660 
<a name="l02661"></a>02661  <span class="keyword">private</span>:
<a name="l02662"></a>02662   <span class="keyword">static</span> <span class="keyword">const</span> uintptr_t kNotMarkedBit = 0x1;
<a name="l02663"></a>02663   STATIC_ASSERT((<a class="code" href="namespacev8_1_1internal.html#aa2507eb9d594b9767347031fb02d0b20">kHeapObjectTag</a> &amp; kNotMarkedBit) != 0);
<a name="l02664"></a>02664 };
<a name="l02665"></a>02665 
<a name="l02666"></a>02666 
<a name="l02667"></a>02667 <span class="preprocessor">#if defined(DEBUG) || defined(LIVE_OBJECT_LIST)</span>
<a name="l02668"></a>02668 <span class="preprocessor"></span><span class="comment">// Helper class for tracing paths to a search target Object from all roots.</span>
<a name="l02669"></a>02669 <span class="comment">// The TracePathFrom() method can be used to trace paths from a specific</span>
<a name="l02670"></a>02670 <span class="comment">// object to the search target object.</span>
<a name="l02671"></a>02671 <span class="keyword">class </span>PathTracer : <span class="keyword">public</span> ObjectVisitor {
<a name="l02672"></a>02672  <span class="keyword">public</span>:
<a name="l02673"></a>02673   <span class="keyword">enum</span> WhatToFind {
<a name="l02674"></a>02674     FIND_ALL,   <span class="comment">// Will find all matches.</span>
<a name="l02675"></a>02675     FIND_FIRST  <span class="comment">// Will stop the search after first match.</span>
<a name="l02676"></a>02676   };
<a name="l02677"></a>02677 
<a name="l02678"></a>02678   <span class="comment">// For the WhatToFind arg, if FIND_FIRST is specified, tracing will stop</span>
<a name="l02679"></a>02679   <span class="comment">// after the first match.  If FIND_ALL is specified, then tracing will be</span>
<a name="l02680"></a>02680   <span class="comment">// done for all matches.</span>
<a name="l02681"></a>02681   PathTracer(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* search_target,
<a name="l02682"></a>02682              WhatToFind what_to_find,
<a name="l02683"></a>02683              <a class="code" href="namespacev8_1_1internal.html#a2b671904b8f0256e109c272a136d2a21">VisitMode</a> visit_mode)
<a name="l02684"></a>02684       : search_target_(search_target),
<a name="l02685"></a>02685         found_target_(<a class="code" href="namespacev8_1_1internal.html#a95f596a3bb6a493b8b63c451e07f7bb6">false</a>),
<a name="l02686"></a>02686         found_target_in_trace_(<a class="code" href="namespacev8_1_1internal.html#a95f596a3bb6a493b8b63c451e07f7bb6">false</a>),
<a name="l02687"></a>02687         what_to_find_(what_to_find),
<a name="l02688"></a>02688         visit_mode_(visit_mode),
<a name="l02689"></a>02689         object_stack_(20),
<a name="l02690"></a>02690         no_alloc() {}
<a name="l02691"></a>02691 
<a name="l02692"></a>02692   <span class="keyword">virtual</span> <span class="keywordtype">void</span> VisitPointers(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>** <a class="code" href="namespacell__prof.html#a5b7aee10eba26bc62f35b1049906c277">start</a>, <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>** end);
<a name="l02693"></a>02693 
<a name="l02694"></a>02694   <span class="keywordtype">void</span> <a class="code" href="namespacev8_1_1internal.html#aedbe4c9957c254b67bd760a57181a1b6">Reset</a>();
<a name="l02695"></a>02695   <span class="keywordtype">void</span> TracePathFrom(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>** root);
<a name="l02696"></a>02696 
<a name="l02697"></a>02697   <span class="keywordtype">bool</span> found()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> found_target_; }
<a name="l02698"></a>02698 
<a name="l02699"></a>02699   <span class="keyword">static</span> <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* <span class="keyword">const</span> kAnyGlobalObject;
<a name="l02700"></a>02700 
<a name="l02701"></a>02701  <span class="keyword">protected</span>:
<a name="l02702"></a>02702   <span class="keyword">class </span>MarkVisitor;
<a name="l02703"></a>02703   <span class="keyword">class </span>UnmarkVisitor;
<a name="l02704"></a>02704 
<a name="l02705"></a>02705   <span class="keywordtype">void</span> MarkRecursively(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>** p, MarkVisitor* mark_visitor);
<a name="l02706"></a>02706   <span class="keywordtype">void</span> UnmarkRecursively(<a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>** p, UnmarkVisitor* unmark_visitor);
<a name="l02707"></a>02707   <span class="keyword">virtual</span> <span class="keywordtype">void</span> ProcessResults();
<a name="l02708"></a>02708 
<a name="l02709"></a>02709   <span class="comment">// Tags 0, 1, and 3 are used. Use 2 for marking visited HeapObject.</span>
<a name="l02710"></a>02710   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kMarkTag = 2;
<a name="l02711"></a>02711 
<a name="l02712"></a>02712   <a class="code" href="namespacev8_1_1internal.html#a7986609369321bb6f6ecb264c345b5c7">Object</a>* search_target_;
<a name="l02713"></a>02713   <span class="keywordtype">bool</span> found_target_;
<a name="l02714"></a>02714   <span class="keywordtype">bool</span> found_target_in_trace_;
<a name="l02715"></a>02715   WhatToFind what_to_find_;
<a name="l02716"></a>02716   <a class="code" href="namespacev8_1_1internal.html#a2b671904b8f0256e109c272a136d2a21">VisitMode</a> visit_mode_;
<a name="l02717"></a>02717   List&lt;Object*&gt; object_stack_;
<a name="l02718"></a>02718 
<a name="l02719"></a>02719   AssertNoAllocation no_alloc;  <span class="comment">// i.e. no gc allowed.</span>
<a name="l02720"></a>02720 
<a name="l02721"></a>02721  <span class="keyword">private</span>:
<a name="l02722"></a>02722   <a class="code" href="globals_8h.html#acfd97435e2829938f396946b00559b71">DISALLOW_IMPLICIT_CONSTRUCTORS</a>(PathTracer);
<a name="l02723"></a>02723 };
<a name="l02724"></a>02724 <span class="preprocessor">#endif  // DEBUG || LIVE_OBJECT_LIST</span>
<a name="l02725"></a>02725 <span class="preprocessor"></span>
<a name="l02726"></a>02726 } }  <span class="comment">// namespace v8::internal</span>
<a name="l02727"></a>02727 
<a name="l02728"></a>02728 <span class="preprocessor">#endif  // V8_HEAP_H_</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="heap_8h.html">heap.h</a>      </li>

    <li class="footer">Generated on Tue Apr 24 2012 13:06:09 for V8 API Reference Guide by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
